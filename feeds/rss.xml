<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Brucezz's Corner</title><link>http://brucezz.github.io/</link><description>/* Stay hungry, Stay foolish. */</description><atom:link href="http://brucezz.itscoder.com//feeds/rss.xml" rel="self"></atom:link><lastBuildDate>Thu, 17 Nov 2016 00:00:00 +0800</lastBuildDate><item><title>Atom-Helper å°è„šæœ¬</title><link>http://brucezz.github.io/articles/2016/11/17/atom-helper-script/</link><description>&lt;p&gt;è¿™å‡ å¤©åœ¨å°è¯•ç”¨æ–°çš„æ–‡æœ¬ç¼–è¾‘å™¨ Atomï¼Œä¸Šæ‰‹ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è£…æ’ä»¶å’¯ã€‚Atom å’Œ Sublime ä¸€æ ·ï¼Œç¤¾åŒºæä¾›äº†å„ç§å„æ ·çš„æ’ä»¶ï¼Œæ¥æä¾›é…·ç‚«çš„åŠŸèƒ½ã€‚ æˆ‘åœ¨ Atom ç½‘ç«™ä¸Šæœç´¢å¾ˆå¤šæ’ä»¶ç„¶åçœ‹çœ‹ä»‹ç»ä¸‹è½½ä½“éªŒï¼Œé…ç½®äº†ä¸€ä¸ªç®€å•çš„ Python å¼€å‘ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™å°±æƒ³å†™ä¸ªå°è„šæœ¬ç©ç©äº†ï¼Œå¤§æ¦‚åŠŸèƒ½å°±æ˜¯æ ¹æ®å…³é”®å­—æœç´¢ Atom çš„æ’ä»¶æˆ–è€…ä¸»é¢˜ï¼Œç„¶åæ’åºå±•ç¤ºå‰ N ä¸ªé¡¹ç›®ï¼Œå½“ç„¶ç›´æ¥é€šè¿‡å‘½ä»¤è¡Œæ”¹å˜å‚æ•°å°±æ›´å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;Atom æ’ä»¶åœ°å€ï¼š&lt;a href="https://atom.io/packages"&gt;Packages&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Atom ä¸»é¢˜åœ°å€ï¼š&lt;a href="https://atom.io/themes"&gt;Themes&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;åˆ†æé—®é¢˜&lt;/h1&gt;
&lt;p&gt;æ•´ä¸ªè„šæœ¬æµç¨‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ ¹æ®å…³é”®å­—å‘å‡ºç¬¬ä¸€ä¸ªæœç´¢è¯·æ±‚&lt;/li&gt;
&lt;li&gt;è§£æå‡ºé¡µé¢ä¸­çš„æ’ä»¶æ•°æ®&lt;/li&gt;
&lt;li&gt;æ‰¾åˆ°ã€Œä¸‹ä¸€é¡µã€çš„é“¾æ¥ï¼Œè¯·æ±‚ä¸‹ä¸€é¡µ&lt;/li&gt;
&lt;li&gt;å¾ªç¯ 2-3ï¼Œç›´åˆ°æœ€åä¸€é¡µï¼Œå³ã€Œä¸‹ä¸€é¡µã€çš„é“¾æ¥ä¸å­˜åœ¨&lt;/li&gt;
&lt;li&gt;å¯¹è·å–åˆ°çš„æ’ä»¶è¿›è¡Œæ’åºï¼Œç„¶åè¾“å‡º topN&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…ˆæ‰‹åŠ¨æœç´¢ä¸€ä¸ªå…³é”®å­—ï¼Œç”¨ Chrome å¼€å‘è€…å·¥å…·æŸ¥çœ‹ä¸€ä¸‹è¯·æ±‚å†…å®¹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="Search" src="http://ww4.sinaimg.cn/large/006y8mN6gw1f9v6ufxhuij30m80csdgm.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ GET è¯·æ±‚ï¼Œç›´æ¥æŠŠå…³é”®å­—ä½œä¸ºå‚æ•°æ·»åŠ åœ¨ url åé¢å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æŸ¥çœ‹ä¸€ä¸‹é¡µé¢çš„ HTML å…ƒç´ ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="HTML" src="http://ww3.sinaimg.cn/large/006y8mN6gw1f9vct78948j30go0f8gmt.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥æ ¹æ® &lt;code&gt;class="grid-cell"&lt;/code&gt; è¿™ä¸€å±æ€§ï¼ŒæŠŠæ¯ä¸€ä¸ªæ’ä»¶ä½œä¸ºæ•´ä½“æå–å‡ºæ¥ï¼Œç„¶åå†è¯¦ç»†åœ°è§£æå‡ºå…·ä½“çš„å­—æ®µã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ‰¾ä¸€ä¸‹ ã€Œä¸‹ä¸€é¡µã€çš„é“¾æ¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="Next" src="http://ww3.sinaimg.cn/large/006y8mN6gw1f9vcuu27iuj30m801s74c.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Next empty" src="http://ww3.sinaimg.cn/large/006y8mN6gw1f9vcvvflcaj30m801kdfs.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¹ŸéªŒè¯äº†å‰é¢çš„æƒ³æ³•ï¼Œæœ€åä¸€é¡µçš„æ—¶å€™ï¼Œã€Œä¸‹ä¸€é¡µã€çš„é“¾æ¥ä¸å­˜åœ¨ï¼Œè¿™æ ·å°±èƒ½æ­£ç¡®åœ°ç»“æŸå¾ªç¯è¯·æ±‚äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åå°±æ˜¯è·å–ä¸€ä¸‹ topN çš„æ•°æ®ï¼Œç„¶åè¾“å‡ºå‡ºæ¥äº†ã€‚&lt;/p&gt;
&lt;h1&gt;è·å–æ•°æ®&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆæ ¹æ®å‰é¢åˆ†æçš„ç»“æœï¼Œå…ˆå†™ä¸€ä¸ªå¤§æ¦‚çš„ç±»ç»“æ„ï¼Œæœ‰å‡ ä¸ªæ–¹æ³•éœ€è¦å®ç°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AtomHelper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;extract_item&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Extract item from cells.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Do search!&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;topN&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Get topN items.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è§£æå­—æ®µ&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªæ­¥éª¤ç›´æ¥ä½¿ç”¨ lxml çš„ xpath è¿›è¡Œè§£æå°±å¥½äº†ï¼Œç†Ÿæ‚‰ xpath çš„è¯å¾ˆç®€å•ï¼Œæœ€åæŠŠå­—æ®µç»„è£…æˆä¸€ä¸ªå­—å…¸ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;extract_item&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Extract item from cells.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="c1"&gt;# Extract title, url, desc, download ...&lt;/span&gt;
    &lt;span class="c1"&gt;# ...&lt;/span&gt;

    &lt;span class="n"&gt;star&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xpath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.//a[@class=&amp;quot;social-count&amp;quot;]/text()&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;desc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;download&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;number_format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;download&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;star&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;number_format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;star&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;code&gt;xpath&lt;/code&gt; æ–¹æ³•è¿”å›çš„é€šå¸¸éƒ½æ˜¯ &lt;code&gt;list&lt;/code&gt; å¯¹è±¡ï¼Œé€šå¸¸éƒ½åªéœ€è¦ç¬¬ä¸€é¡¹ã€‚æ‰€ä»¥è¿™é‡Œå†™äº†ä¸€ä¸ªæ–¹æ³•æ¥ä»åºåˆ—ä¸­æå–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæä¾›é»˜è®¤å€¼é¿å…æ¯æ¬¡åˆ¤ç©ºã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Extract first item in sequence, or default value.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦å¤–ç½‘ç«™ä¸Šçš„æ•°å­—æ˜¯æ ¼å¼åŒ–åçš„ï¼Œå³ &lt;code&gt;2,333&lt;/code&gt; çš„å½¢å¼ï¼Œéœ€è¦è½¬æ¢æˆæ­£å¸¸çš„æ•°å­—ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;number_format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_str&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Convert number string like &amp;#39;2,333&amp;#39; to integer.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;num_str&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;num_str&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å¾ªç¯è¯·æ±‚é¡µé¢&lt;/h2&gt;
&lt;p&gt;è¿™ä¸€éƒ¨åˆ†å°±æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œä¸æ–­åœ°è¯·æ±‚ã€Œä¸‹ä¸€é¡µã€çš„åœ°å€ï¼ŒåŒæ—¶è§£æé¡µé¢ä¸­çš„æ•°æ®å’Œä¸‹ä¸€ä¸ªé“¾æ¥ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Do search!&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="n"&gt;next_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;search_url&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;next_url&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;etree&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTML&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# Extract cells, next_url&lt;/span&gt;
        &lt;span class="c1"&gt;# ...&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extract_item&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è·å– topN&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªç”¨ä¸€ä¸‹å†…ç½®å‡½æ•° &lt;code&gt;sorted&lt;/code&gt; å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;topN&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;download&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)[:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åæŠŠå…·ä½“å®ç°çš„ä»£ç ç»„è£…èµ·æ¥ï¼Œæ·»åŠ ä¸€äº›å¿…è¦çš„è¾“å‡ºæç¤ºï¼Œä¸»ä½“åŠŸèƒ½å°±å®Œæˆäº†ã€‚&lt;/p&gt;
&lt;h1&gt;æ·»åŠ å‘½ä»¤è¡Œå‚æ•°&lt;/h1&gt;
&lt;p&gt;è„šæœ¬å¯ä»¥æœç´¢ã€Œæ’ä»¶ã€æˆ–è€…ã€Œä¸»é¢˜ã€ï¼Œè¿™ä¸ªéœ€è¦æšä¸¾å‚æ•°æ¥æ§åˆ¶ï¼›è¾“å‡ºå¤šå°‘ä¸ªç»“æœï¼Œä¹Ÿæ˜¯éœ€è¦ä¸€ä¸ªå‚æ•°ï¼›æ˜¯æŒ‰ä¸‹è½½é‡æ’åºè¿˜æ˜¯æ˜Ÿæ˜Ÿæ•°é‡æ’åºï¼Œè¿˜éœ€è¦ä¸€ä¸ªæšä¸¾å‚æ•°ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;argparse&lt;/code&gt; æ¨¡å—ä½¿å¾—ç¼–å†™ç”¨æˆ·å‹å¥½çš„å‘½ä»¤è¡Œæ¥å£éå¸¸å®¹æ˜“ã€‚ç¨‹åºåªéœ€å®šä¹‰å¥½å®ƒè¦æ±‚çš„å‚æ•°ï¼Œç„¶å &lt;code&gt;argparse&lt;/code&gt; å°†è´Ÿè´£å¦‚ä½•ä» &lt;code&gt;sys.argv&lt;/code&gt; ä¸­è§£æå‡ºè¿™äº›å‚æ•°ã€‚&lt;code&gt;argparse&lt;/code&gt; æ¨¡å—è¿˜ä¼šè‡ªåŠ¨ç”Ÿæˆå¸®åŠ©å’Œä½¿ç”¨ä¿¡æ¯å¹¶ä¸”å½“ç”¨æˆ·èµ‹ç»™ç¨‹åºéæ³•çš„å‚æ•°æ—¶äº§ç”Ÿé”™è¯¯ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;argparse&lt;/code&gt; è¿™ä¸ªåº“ç®€å•æ˜“ç”¨ï¼Œæ–‡æ¡£å†™å¾—å¾ˆè¯¦ç»†ï¼Œè¿˜æœ‰å„ç§ç¤ºä¾‹ã€‚&lt;a href="http://python.usyiyi.cn/python_278/library/argparse.html"&gt;æˆ³è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;process_arg&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;parser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;argparse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ArgumentParser&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Atom helper to search packages or themes.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;epilog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Have fun :)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;keyword&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;nargs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The keyword to search.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Show top N items.(default 5)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-t&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;--type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;choices&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;packages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;themes&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                        &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;packages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The type to search.(default packages)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-s&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;--sort&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;choices&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;download&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;star&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                        &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;download&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Sort items by.(default download)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-v&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;--verbose&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;action&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;store_true&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Show debug messages.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;vars&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse_args&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;keyword&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;keyword&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œä¸»è¦çš„å‡ ä¸ªå‚æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="args" src="http://ww1.sinaimg.cn/large/006y8mN6gw1f9vcnvzmjrj30go09z3zg.jpg" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-t&lt;/code&gt; æŒ‡å®šæœç´¢ç±»å‹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-s&lt;/code&gt; æŒ‡å®šæ’åºè§„åˆ™&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-n&lt;/code&gt; æŒ‡å®šè¾“å‡ºå¤šå°‘ä¸ªæ•°æ®&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-v&lt;/code&gt; æ˜¾ç¤º debug ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-g&lt;/code&gt; æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;æœ€ç»ˆç»“æœ&lt;/h1&gt;
&lt;p&gt;&lt;img alt="final" src="http://ww1.sinaimg.cn/large/006y8mN6gw1f9vcmj4wt9j30m80bv0tv.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;èŠ±æ—¶é—´å†™å®Œè¿™ä¸ªè„šæœ¬ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ğŸ˜‚ï¼Œè¿˜ä¸å¦‚è‡ªå·±å»ç½‘ç«™ä¸Šæœæœå‘¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ç¬¬ä¸€æ¬¡å†™å‘½ä»¤è¡Œå‚æ•°ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºå¥½ç©çš„ï¼Œç†Ÿæ‚‰äº†ä¸‹ &lt;code&gt;argparse&lt;/code&gt; æ¨¡å—ï¼Œä»¥åç”¨ Python å†™å°å·¥å…·æ›´æ–¹ä¾¿äº†ã€‚&lt;/p&gt;
&lt;p&gt;å®Œæ•´è„šæœ¬åœ°å€: &lt;a href="https://github.com/brucezz/SomeScripts/blob/master/atom_helper.py"&gt;atom_helper.py&lt;/a&gt;, æ¬¢è¿æ‹ç –è¯„è®ºã€‚&lt;/p&gt;
&lt;h1&gt;Reference&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://python.usyiyi.cn/python_278/library/argparse.html"&gt;argparse å®˜ç½‘æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blog.xiayf.cn/2013/03/30/argparse/"&gt;argparse - å‘½ä»¤è¡Œé€‰é¡¹ä¸å‚æ•°è§£æï¼ˆè¯‘ï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Thu, 17 Nov 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-11-17:articles/2016/11/17/atom-helper-script/</guid></item><item><title>åœ¨ Android ä¸­ä½¿ç”¨ Java8 çš„ç‰¹æ€§</title><link>http://brucezz.github.io/articles/2016/10/05/use_java8_in_android/</link><description>&lt;p&gt;æ ¹æ® &lt;a href="https://developer.android.com/guide/platform/j8-jack.html?hl=zh-cn"&gt;Android å®˜ç½‘&lt;/a&gt;çš„è¯´æ˜ï¼Œåœ¨å¼€å‘é¢å‘ Android N çš„åº”ç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Java8 è¯­è¨€åŠŸèƒ½ã€‚ç›®å‰ Android åªæ”¯æŒä¸€éƒ¨åˆ† Java8 çš„ç‰¹æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html"&gt;Lambda è¡¨è¾¾å¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.oracle.com/javase/tutorial/java/javaOO/methodreferences.html"&gt;æ–¹æ³•å¼•ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html"&gt;é»˜è®¤å’Œé™æ€æ¥å£æ–¹æ³•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.oracle.com/javase/tutorial/java/annotations/repeating.html"&gt;é‡å¤æ³¨è§£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä¸­ï¼Œåªæœ‰å‰ä¸¤è€…å¯ä»¥å…¼å®¹ API 23 ä»¥ä¸‹çš„ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h2&gt;Lambda è¡¨è¾¾å¼&lt;/h2&gt;
&lt;p&gt;ä»ä¸€ä¸ªå®é™…ä¾‹å­æ¥å¼•å…¥ lambda çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ç»„ Person å¯¹è±¡ï¼ˆå…·ä½“å®ç°ä¸å¤æ‚ï¼Œå‚è€ƒ&lt;a href="https://docs.oracle.com/javase/tutorial/java/javaOO/examples/Person.java"&gt;è¿™é‡Œ&lt;/a&gt;ï¼‰ï¼Œéœ€è¦é€šè¿‡å¹´é¾„å¤§å°æ¥è¿‡æ»¤å‡ºæ»¡è¶³è¦æ±‚çš„å¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡Œè¾“å‡ºæ“ä½œï¼Œå®ç°å¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;printPersonsOlderThan&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;age&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;age&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printPerson&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœæˆ‘çš„è¿‡æ»¤æ¡ä»¶å˜æ›´äº†ï¼Œå°±å¿…é¡»ä¿®æ”¹è¿™ä¸ªæ–¹æ³•çš„ä»£ç ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨æ ¹æ®å¹´é¾„ä¸Šä¸‹é™è¿›è¡Œè¿‡æ»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;printPersonsWithinAgeRange&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printPerson&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œè¿‡æ»¤æ¡ä»¶ç»å¸¸å˜æ›´çš„è¯ï¼Œéœ€è¦é¢‘ç¹ä¿®æ”¹è¿™ä¸ªæ–¹æ³•ã€‚æ ¹æ®é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œå°è£…å˜åŒ–ï¼ŒæŠŠç»å¸¸æ”¹å˜çš„é€»è¾‘å°è£…èµ·æ¥ï¼Œæœ‰å¤–éƒ¨æ¥å†³å®šã€‚è¿™é‡Œæˆ‘æŠŠè¿‡æ»¤æ¡ä»¶å°è£…åˆ° &lt;code&gt;CheckPerson&lt;/code&gt; æ¥å£é‡Œï¼Œæ ¹æ®ä¸åŒçš„è¿‡æ»¤æ¡ä»¶å»å®ç°è¿™ä¸ªæ¥å£å³å¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@FunctionalInterface&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;CheckPerson&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;printPersons&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CheckPerson&lt;/span&gt; &lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;test&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printPerson&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// å®é™…ä½¿ç”¨&lt;/span&gt;

&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;createRoster&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="c1"&gt;// åˆ¶é€ ä¸€äº›æ•°æ®&lt;/span&gt;

&lt;span class="n"&gt;printPersons&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CheckPerson&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;CheckPerson&lt;/code&gt; æ¥å£æ˜¯ä¸€ä¸ª&lt;strong&gt;å‡½æ•°å¼æ¥å£&lt;/strong&gt;(functional interface)ï¼Œå³&lt;strong&gt;ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•&lt;/strong&gt;çš„æ¥å£ã€‚ å› æ­¤å®ç°è¿™ä¸ªæ¥å£çš„æ—¶å€™å¯ä»¥å¿½ç•¥æ‰æ–¹æ³•åç§°ï¼Œä½¿ç”¨ Lambda è¡¨è¾¾å¼æ¥æ›¿ä»£åŒ¿åç±»ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;printPersons&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;
&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶å®åœ¨ Java8 çš„åŒ…ä¸­ï¼Œå·²ç»å†…ç½®äº†ä¸€äº›æ ‡å‡†çš„å‡½æ•°å¼æ¥å£ã€‚æ¯”å¦‚ &lt;code&gt;CheckPerson&lt;/code&gt; æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åè¾“å‡ºä¸€ä¸ª boolean å€¼ã€‚å¯ä»¥ä½¿ç”¨ &lt;code&gt;java.util.function.Predicate&amp;lt;T&amp;gt;&lt;/code&gt; æ¥æ›¿ä»£ï¼Œå®ƒç›¸å½“äº RxJava ä¸­çš„ &lt;code&gt;Func1&amp;lt;T, Boolean&amp;gt;&lt;/code&gt;ï¼Œæ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;printPersonsWithPredicate&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Predicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;test&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printPerson&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// ä½¿ç”¨èµ·æ¥å¹¶æ²¡æœ‰ä»€ä¹ˆå·®åˆ«&lt;/span&gt;
&lt;span class="n"&gt;printPersonsWithPredicate&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;
&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ˜¯ï¼Œæˆ‘å¹¶ä¸æ»¡è¶³äºä»…ä»…æŠŠè¿‡æ»¤æ¡ä»¶å°è£…èµ·æ¥ï¼Œè¿˜æƒ³æŠŠè¿‡æ»¤ä¹‹åå¯¹ Person å¯¹è±¡çš„æ“ä½œä¹Ÿå°è£…èµ·æ¥ï¼Œä¾¿äºä¿®æ”¹ã€‚å¯ä»¥ç”¨å¦å¤–ä¸€ä¸ªæ ‡å‡†çš„å‡½æ•°å¼æ¥å£ &lt;code&gt;java.util.function.Consumer&amp;lt;T&amp;gt;&lt;/code&gt;ï¼Œå®ƒç›¸å½“äº RxJava ä¸­çš„ &lt;code&gt;Action1&amp;lt;T&amp;gt;&lt;/code&gt;ï¼Œæ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å› voidã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;processPersons&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Predicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Consumer&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;person&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;test&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;accept&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// å…·ä½“ä½¿ç”¨&lt;/span&gt;
&lt;span class="n"&gt;processPersons&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printPerson&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœæˆ‘çš„å¤„ç†è¿‡ç¨‹ä¸­æœ‰æ•°æ®è½¬æ¢çš„è¿‡ç¨‹ï¼Œå¯ä»¥ç”¨ &lt;code&gt;java.util.function.Function&amp;lt;T, F&amp;gt;&lt;/code&gt; å°†å…¶å°è£…èµ·æ¥ï¼Œè¿™ä¸ªæ¥å£ç›¸å½“äº RxJava ä¸­çš„ &lt;code&gt;Func1&amp;lt;T, F&amp;gt;&lt;/code&gt;ï¼Œæ¥æ”¶ä¸€ä¸ªç±»å‹çš„å¯¹è±¡ï¼Œè¿”å›å¦å¤–ä¸ªç±»å‹çš„å¯¹è±¡ï¼Œè¾¾åˆ°æ•°æ®è½¬æ¢çš„ç›®çš„ã€‚æ¯”å¦‚ä¾‹å­ä¸­ï¼ŒæŠŠ Person è½¬æ¢æˆ String å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;processPersonsWithFunction&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Predicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Consumer&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;person&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;test&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;apply&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;accept&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// å®é™…ä½¿ç”¨&lt;/span&gt;
&lt;span class="n"&gt;processPersonsWithFunction&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getEmailAddress&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="c1"&gt;// è·å– Person å¯¹è±¡çš„ email å­—ç¬¦ä¸²&lt;/span&gt;
        &lt;span class="n"&gt;email&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æœ€åå¯ä»¥æŠŠæ•°æ®æºä¹Ÿå°è£…æˆä¸€ä¸ª &lt;code&gt;java.lang.Iterable&amp;lt;T&amp;gt;&lt;/code&gt; å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;processElements&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;Iterable&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Predicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Consumer&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;test&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;Y&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;apply&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;accept&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// å®é™…ä½¿ç”¨&lt;/span&gt;
&lt;span class="n"&gt;Iterable&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;Predicate&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tester&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;Function&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mapper&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getEmailAddress&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="n"&gt;Consumer&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;email&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;processElements&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tester&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ Java8 ä¸­ä¹Ÿå¯ä»¥æŠŠ Collections å¯¹è±¡å¿«é€Ÿè½¬æ¢æˆ Stream æ¥ä½¿ç”¨æ–¹ä¾¿çš„æ“ä½œç¬¦ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;                                     &lt;span class="c1"&gt;// è·å–æ•°æ®æµ&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;                                        &lt;span class="c1"&gt;// æ ¹æ® Predicate è¿‡æ»¤æ•°æ®&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
                    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
                    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getEmailAddress&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt;                  &lt;span class="c1"&gt;// æ ¹æ® Function è½¬æ¢æ•°æ®&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forEach&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;   &lt;span class="c1"&gt;// å¯¹æ•°æ®æ‰§è¡Œæ“ä½œ(æ¶ˆè´¹æ•°æ®)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Lambda å†™æ³•&lt;/h4&gt;
&lt;p&gt;åŸºæœ¬å†™æ³•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;

&lt;span class="c1"&gt;// æ²¡æœ‰å‚æ•°&lt;/span&gt;
&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello lambda&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;// å‚æ•°å¤šäº 1 ä¸ª&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚æ•°åˆ—è¡¨ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥çœç•¥æ‰æ‹¬å·ï¼Œå…¶ä»–æƒ…å†µéœ€è¦å†™ä¸Šä¸€å¯¹æ‹¬å·ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ ç®­å¤´ &lt;code&gt;-&amp;gt;&lt;/code&gt; åé¢å¿…é¡»æ˜¯ä¸€ä¸ªå•ç‹¬çš„è¡¨è¾¾å¼ï¼ˆexpressionï¼‰æˆ–è€…æ˜¯ä¸€ä¸ªè¯­å¥å—ï¼ˆstatement blockï¼‰ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// è¡¨è¾¾å¼&lt;/span&gt;
&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;

&lt;span class="c1"&gt;// ä»£ç å—&lt;/span&gt;
&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getGender&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MALE&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAge&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ–¹æ³•å¼•ç”¨&lt;/h2&gt;
&lt;p&gt;å½“ä½ ä½¿ç”¨ä¸€ä¸ª lambda è¡¨è¾¾å¼çš„æ—¶å€™ï¼Œå¦‚æœå®ƒä»…ä»…æ˜¯è°ƒç”¨äº†ä¸€ä¸‹å·²æœ‰çš„æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰åšå…¶ä»–ä»»ä½•æ“ä½œï¼Œå°±å¯ä»¥æŠŠå®ƒè½¬æ¢æˆ&lt;strong&gt;æ–¹æ³•å¼•ç”¨&lt;/strong&gt;ã€‚æ–¹æ³•å¼•ç”¨æœ‰å››ç§å†™æ³•ï¼Œä¸‹é¢ä¸€ä¸€ä»‹ç»ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// å…ˆåˆ¶é€ ä¸€äº›æ•°æ®ï¼Œ ä¾›åé¢çš„ä¾‹å­ä½¿ç”¨&lt;/span&gt;
&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;createRoster&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;rosterAsArray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toArray&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()]);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;å¼•ç”¨é™æ€æ–¹æ³•&lt;/h4&gt;
&lt;p&gt;é¦–å…ˆåœ¨ Person ç±»ä¸­æœ‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œé€šè¿‡å¹´é¾„æ¯”è¾ƒå¤§å°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// Person.java&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;compareByAge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;birthday&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareTo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;birthday&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;//MethodReferencesTest.java&lt;/span&gt;
&lt;span class="c1"&gt;// åŸæ¥çš„å†™æ³•ï¼Œä¼ å…¥åŒ¿åç±»&lt;/span&gt;
&lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rosterAsArray&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Comparator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;compare&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;o1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;o2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareByAge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;o1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;o2&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;});&lt;/span&gt;

&lt;span class="c1"&gt;// å†™æˆ lambda å½¢å¼&lt;/span&gt;
&lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rosterAsArray&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareByAge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;span class="c1"&gt;// è½¬æ¢æˆæ–¹æ³•å¼•ç”¨ =&amp;gt;&lt;/span&gt;
&lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rosterAsArray&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;compareByAge&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;å¼•ç”¨å…·ä½“å®ä¾‹çš„æ–¹æ³•&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ComparisonProvider&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;compareByName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;compareTo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;compareByAge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBirthday&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;compareTo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBirthday&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;ComparisonProvider&lt;/span&gt; &lt;span class="n"&gt;comparisonProvider&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ComparisonProvider&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

&lt;span class="c1"&gt;// lambda å½¢å¼&lt;/span&gt;
&lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rosterAsArray&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;comparisonProvider&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareByAge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p2&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;span class="c1"&gt;// è½¬æ¢æˆæ–¹æ³•å¼•ç”¨ =&amp;gt;&lt;/span&gt;
&lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rosterAsArray&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;comparisonProvider&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;compareByName&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;å¼•ç”¨ç‰¹å®šç±»å‹çš„å¯¹è±¡çš„å®ä¾‹æ–¹æ³•&lt;/h4&gt;
&lt;p&gt;Person å®ç°ä¸€ä¸‹ &lt;code&gt;Comparable&amp;lt;T&amp;gt;&lt;/code&gt; æ¥å£ï¼Œä¼šæœ‰ä¸€ä¸ª &lt;code&gt;compareTo(Person)&lt;/code&gt; æ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Person&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Comparable&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;compareTo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareByAge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// å¤ç”¨ä¹‹å‰é™æ€æ–¹æ³•çš„é€»è¾‘&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// å…¶ä»–å¿½ç•¥&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// lambda å½¢å¼&lt;/span&gt;
&lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rosterAsArray&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compareTo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p2&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;span class="c1"&gt;// è½¬æ¢æˆæ–¹æ³•å¼•ç”¨ =&amp;gt;&lt;/span&gt;
&lt;span class="n"&gt;Arrays&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rosterAsArray&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;compareTo&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;å¼•ç”¨æ„é€ æ–¹æ³•&lt;/h4&gt;
&lt;p&gt;æœ‰ä¸€ä¸ª &lt;code&gt;transferElements&lt;/code&gt; æ–¹æ³•ï¼Œå°† &lt;code&gt;SOURCE&lt;/code&gt; ç±»å‹çš„é›†åˆè½¬æ¢æˆ &lt;code&gt;DEST&lt;/code&gt; ç±»å‹çš„é›†åˆã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SOURCE&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;Collection&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;,&lt;/span&gt; &lt;span class="n"&gt;DEST&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;Collection&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="n"&gt;DEST&lt;/span&gt; &lt;span class="nf"&gt;transferElements&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;SOURCE&lt;/span&gt; &lt;span class="n"&gt;sourceCollection&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Supplier&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;DEST&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;collectionFactory&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="n"&gt;DEST&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;collectionFactory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sourceCollection&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ &lt;code&gt;java.util.function.Supplier&amp;lt;T&amp;gt;&lt;/code&gt; ä¹Ÿæ˜¯æ ‡å‡†çš„å‡½æ•°å¼æ¥å£ï¼Œå®ƒæœ‰ä¸€ä¸ª &lt;code&gt;get()&lt;/code&gt; æ–¹æ³•æ¥è·å–æ‰€æä¾›çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// åŒ¿åç±»å½¢å¼&lt;/span&gt;
&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;rosterSet&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;transferElements&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Supplier&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HashSet&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;});&lt;/span&gt;
&lt;span class="c1"&gt;// lambda å½¢å¼&lt;/span&gt;
&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;rosterSet&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;transferElements&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HashSet&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;());&lt;/span&gt;
&lt;span class="c1"&gt;// è½¬æ¢æˆæ–¹æ³•å¼•ç”¨ =&amp;gt;&lt;/span&gt;
&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;rosterSet&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;transferElements&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roster&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;HashSet&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;lambda è¡¨è¾¾å¼ä¸­ç›´æ¥ new äº†ä¸€ä¸ª HashSetï¼Œç›¸å½“äºè°ƒç”¨äº† HashSet çš„æ„é€ æ–¹æ³•ï¼Œæ•…å¯ä»¥å†™æˆ &lt;code&gt;HashSet::new&lt;/code&gt; æ–¹æ³•å¼•ç”¨çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;h2&gt;é™æ€å’Œé»˜è®¤æ¥å£æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;åœ¨ Java8 ä¹‹å‰ï¼Œæ¥å£ä¸å…è®¸æœ‰é»˜è®¤å®ç°ï¼Œå¦‚æœæ¥å£çš„ä¸¤ä¸ªå®ç°ç±»æœ‰åŒæ ·çš„å®ç°é€»è¾‘ï¼Œå°±å¾—å†™é‡å¤ä»£ç äº†ã€‚ç°åœ¨æ¥å£å¯ä»¥é€šè¿‡å…³é”®å­— &lt;code&gt;default&lt;/code&gt; å®ç°é»˜è®¤æ–¹æ³•ï¼Œå¦å¤–æ¥å£è¿˜å¯ä»¥å®ç°é™æ€æ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;SampleInterface&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;SampleInterface default impl&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;staticTest&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;666&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;staticTest&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SampleTest&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;SampleInterfaceImpl1&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;test&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;

        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;test2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;SampleInterfaceImpl2&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;test&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test2&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SampleInterfaceImpl1&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;SampleInterface&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="nd"&gt;@Override&lt;/span&gt;
        &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;SampleInterfaceImpl1 override&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;SampleInterface&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;staticTest&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;233&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SampleInterfaceImpl2&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;SampleInterface&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// ä¸éœ€è¦å®ç° test æ–¹æ³•&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æœ€åè¾“å‡ºç»“æœï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;SampleInterfaceImpl1 override
333
SampleInterface default impl
766
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨æ¥å£çš„é»˜è®¤æ–¹æ³•å¯ä»¥å‡å°‘ä»£ç é‡å¤ï¼Œé™æ€æ–¹æ³•ä¹Ÿå¯ä»¥æ–¹ä¾¿åœ°å°è£…ä¸€äº›é€šç”¨é€»è¾‘ã€‚&lt;/p&gt;
&lt;h2&gt;é‡å¤æ³¨è§£&lt;/h2&gt;
&lt;p&gt;é‡å¤æ³¨è§£å°±æ˜¯å…è®¸åœ¨åŒä¸€ç”³æ˜ç±»å‹ï¼ˆç±»ï¼Œå±æ€§ï¼Œæˆ–æ–¹æ³•ï¼‰å¤šæ¬¡ä½¿ç”¨åŒä¸€ä¸ªæ³¨è§£ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Repeatable&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Schedules&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// æŒ‡å®šå­˜å‚¨ Schedule çš„æ³¨è§£&lt;/span&gt;
&lt;span class="nd"&gt;@Target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ElementType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;METHOD&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="nd"&gt;@Retention&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RetentionPolicy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;RUNTIME&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nd"&gt;@interface&lt;/span&gt; &lt;span class="n"&gt;Schedule&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;dayOfWeek&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Mon&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;dayOfMonth&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;hour&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="nd"&gt;@Target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ElementType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;METHOD&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="nd"&gt;@Retention&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RetentionPolicy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;RUNTIME&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nd"&gt;@interface&lt;/span&gt; &lt;span class="n"&gt;Schedules&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;Schedule&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="nf"&gt;value&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="c1"&gt;// å­˜å‚¨ Schedule&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨æ—¶å¯ä»¥é€šè¿‡ &lt;code&gt;AnnotatedElement.getAnnotationsByType()&lt;/code&gt; æ–¹æ³•æ¥è·å–åˆ°æ³¨è§£ï¼Œç„¶åè¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AnnotationTest&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="nd"&gt;@Schedule&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dayOfMonth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;last&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="nd"&gt;@Schedule&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dayOfWeek&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Fri&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hour&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;doSomethingWork&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;doSomethingWork&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;Method&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;AnnotationTest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMethod&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;doSomethingWork&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;Schedule&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;schedules&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAnnotationsByType&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Schedule&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Schedule&lt;/span&gt; &lt;span class="n"&gt;schedule&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;schedules&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Schedule: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;schedule&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;dayOfWeek&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;, &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;schedule&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;dayOfMonth&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;, &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;schedule&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hour&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NoSuchMethodException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printStackTrace&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;AnnotationTest&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;doSomethingWork&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¾“å‡ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;doSomethingWork
Schedule: Mon, last, 12
Schedule: Fri, first, 9
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨å°±æ˜¯è¿™ä¹ˆç®€å•~&lt;/p&gt;
&lt;h2&gt;åœ¨ Android ä¸­ä½¿ç”¨è¿™äº›ç‰¹æ€§&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸» module (app) çš„ &lt;code&gt;build.gradle&lt;/code&gt; é‡Œé…ç½®ï¼Œå¼€å¯ jack ç¼–è¯‘å™¨ï¼Œä½¿ç”¨ Java8 è¿›è¡Œç¼–è¯‘ã€‚
å¦‚æœè¦ä½“éªŒæ¥å£çš„é»˜è®¤æ–¹æ³•ç­‰ç‰¹æ€§ï¼ŒminSdkVersion éœ€è¦æŒ‡å®šä¸º 24 (Android N)ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;android&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;compileSdkVersion&lt;/span&gt; &lt;span class="mi"&gt;24&lt;/span&gt;
    &lt;span class="n"&gt;buildToolsVersion&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;24.0.0&amp;quot;&lt;/span&gt;

    &lt;span class="n"&gt;defaultConfig&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;applicationId&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;me.brucezz.sharedelementdemo&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;minSdkVersion&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;
        &lt;span class="n"&gt;targetSdkVersion&lt;/span&gt; &lt;span class="mi"&gt;24&lt;/span&gt;
        &lt;span class="n"&gt;versionCode&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;versionName&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1.0&amp;quot;&lt;/span&gt;

        &lt;span class="c1"&gt;// å¼€å¯ jack ç¼–è¯‘&lt;/span&gt;
        &lt;span class="n"&gt;jackOptions&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;enabled&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;compileOptions&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// æŒ‡å®šç”¨ Java8 ç¼–è¯‘&lt;/span&gt;
        &lt;span class="n"&gt;sourceCompatibility&lt;/span&gt; &lt;span class="n"&gt;JavaVersion&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;VERSION_1_8&lt;/span&gt;
        &lt;span class="n"&gt;targetCompatibility&lt;/span&gt; &lt;span class="n"&gt;JavaVersion&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;VERSION_1_8&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ–‡ä¸­ä»£ç å¤§éƒ¨åˆ†æ¥è‡ªäº &lt;a href="https://docs.oracle.com/javase/tutorial/"&gt;Oracle å®˜æ–¹æ–‡æ¡£æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blog.zhaiyifan.cn/2016/04/20/trans-java-8-in-android-n-preview/"&gt;åœ¨ Android N é¢„è§ˆç‰ˆä¸­ä½¿ç”¨ Java 8 çš„æ–°ç‰¹æ€§&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Wed, 05 Oct 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-10-05:articles/2016/10/05/use_java8_in_android/</guid></item><item><title>RxLifecycle ä½¿ç”¨ä¸åŸç†</title><link>http://brucezz.github.io/articles/2016/09/19/usage_and_principle_of_rxlifecycle/</link><description>&lt;p&gt;RxJava å·²ç»æˆä¸ºå½“å‰ Android åœˆä¸­å¾ˆç«çš„ä¸€é—¨æŠ€æœ¯äº†ï¼ŒåŸºäº Observable çš„äº‹ä»¶æµé…åˆä¸Šå„ç§æ“ä½œç¬¦é»‘é­”æ³•ï¼Œè®©äººçˆ½åˆ°ä¸èƒ½å‘¼å¸ ğŸ˜†ã€‚RxLifecycle ä½œä¸º RxJava çš„æ‰©å±•åº“ï¼Œç”¨èµ·æ¥ä¹Ÿæ˜¯å¾ˆçˆ½çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡åŸºäº RxLifecycle v0.5 è¿›è¡Œçš„åˆ†æï¼Œæœ€æ–°ç‰ˆæœ¬å·²ç»æ˜¯ v0.7 äº†ï¼Œé¡¹ç›®ç»“æ„ç•¥æœ‰å˜åŒ–ï¼Œä½†æ˜¯åŸç†éƒ¨åˆ†åŸºæœ¬ç›¸åŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;ä½¿ç”¨å§¿åŠ¿&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://github.com/trello/RxLifecycle"&gt;RxLifecycle&lt;/a&gt; çš„ä½¿ç”¨å§¿åŠ¿æ¯”è¾ƒç®€å•ï¼Œè€Œä¸”é¡¹ç›®æ–‡æ¡£ä¹Ÿå¾ˆæ¸…æ™°ï¼Œç›´æ¥è®©è‡ªå·±çš„ Activity åŸºç±»ç»§æ‰¿è‡ª RxActivity å°± okäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æ—¶å°±è°ƒç”¨ä¸€ä¸‹  &lt;code&gt;compose()&lt;/code&gt; è½»æ¾ç»‘å®šï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;myObservable&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compose&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bindUntilEvent&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ActivityEvent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;DESTROY&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;subscribe&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;myObservable&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;compose&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bindToLifecycle&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;subscribe&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;å®ç°åŸç†&lt;/h3&gt;
&lt;p&gt;RxLifecycle ä½¿ç”¨ç®€å•ï¼ŒåŸç†ä¹Ÿä¸å¤æ‚ï¼Œåªæ˜¯è®¾è®¡å¾—ååˆ†å·§å¦™ã€‚&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶æˆ‘ä»¬éƒ½è¦ç»§æ‰¿è‡ª RxActivityï¼Œé‚£å°±ä»è¿™ä¸ªç±»å¼€å§‹çœ‹å§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="BehaviorSubject" src="http://ww4.sinaimg.cn/large/801b780agw1f7yowyv3cij20m801h3yo.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;RxActivity åœ¨å…¶å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª BehaviorSubject å¯¹è±¡ã€‚Subject å¯¹è±¡ç›¸å½“äºä¸€ä¸ªç®¡é“ï¼Œä¸€è¾¹å¯ä»¥æ¥æ”¶æ•°æ®ï¼Œä»å¦å¤–ä¸€è¾¹å‘å°„å‡ºå»ã€‚è€Œ BehaviorSubject  ç»§æ‰¿è‡ª Subjectï¼Œå¹¶ä¸”è¿˜å¤šäº†ä¸€é¡¹ç‰¹æ€§ï¼Œåœ¨æ–°çš„è§‚å¯Ÿè€…è®¢é˜…æ—¶ï¼Œä¼šé¦–å…ˆå‘å°„&lt;strong&gt;ä¸€ä¸ªæœ€è¿‘å‘å°„è¿‡çš„å…ƒç´ &lt;/strong&gt;(&lt;a href="http://reactivex.io/RxJava/javadoc/rx/subjects/BehaviorSubject.html"&gt;å‚è€ƒæ–‡æ¡£çœ‹è¿™é‡Œ&lt;/a&gt;)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="lifecycleSubject" src="http://ww2.sinaimg.cn/large/801b780agw1f7yp10juhuj20m80fxtat.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œåœ¨ Activity åˆ°è¾¾å„ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ—¶å€™ï¼Œ&lt;code&gt;lifecycleSubject&lt;/code&gt; ä¼šæ¥æ”¶åˆ°å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥çœ‹æˆ‘ä»¬æœ€å¸¸ç”¨çš„ &lt;code&gt;bindToLifecycle()&lt;/code&gt; æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="bindToLifecycle" src="http://ww4.sinaimg.cn/large/801b780agw1f7yp1i7ughj20m802fdg4.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;è·³è½¬åˆ° RxLifecycle ç±»ä¸­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="RxLifecycle" src="http://ww2.sinaimg.cn/large/801b780agw1f7yp1rzte0j20m802omxn.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="ACTIVITY_LIFECYCLE" src="http://ww4.sinaimg.cn/large/801b780agw1f7yp21rtavj20m808jgnb.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€è°“çš„ &lt;code&gt;ACTIVITY_LIFECYCLE&lt;/code&gt; å…¶å®å°±æ˜¯ä¸€ä¸ªå‡½æ•° Func1 è€Œå·²ï¼ŒæŠŠ Activity çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶è¿›è¡Œä¸€ä¸‹å˜æ¢ï¼Œ&lt;code&gt;CREATE&lt;/code&gt; å¯¹åº” &lt;code&gt;DESTROY&lt;/code&gt;ï¼Œ&lt;code&gt;RESUME&lt;/code&gt; å¯¹åº” &lt;code&gt;PAUSE&lt;/code&gt; ç­‰ç­‰ã€‚çœ‹åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯å·²ç»çœ‹å‡ºäº†ä¸€ç‚¹ç«¯å€ªäº†ï¼Œå…¶å«ä¹‰å°±æ˜¯ &lt;strong&gt;æŠŠå½“å‰çš„ Activity ç”Ÿå‘½å‘¨æœŸè½¬æ¢æˆå¯¹åº”çš„éœ€è¦è¢«é”€æ¯çš„æ—¶å€™çš„ç”Ÿå‘½å‘¨æœŸã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æœ€åéƒ½èµ°åˆ°äº†è¿™ä¸ªæ–¹æ³• &lt;code&gt;RxLifecycle#bind(rx.Observable&amp;lt;R&amp;gt;, rx.functions.Func1&amp;lt;R,R&amp;gt;)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="bind" src="http://ww3.sinaimg.cn/large/801b780agw1f7yp2bskhqj20m80bugo7.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ˜¯æ•´ä¸ªä»£ç ä¸­æœ€æ ¸å¿ƒã€æœ€å·§å¦™çš„éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ &lt;code&gt;lifecycle&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯ RxActivity é‡Œçš„é‚£ä¸ª BehaviorSubject å¯¹è±¡ï¼Œè¿™é‡Œä½œä¸º Observable æ¥ä½¿ç”¨ã€‚å®ƒä¼šä¸æ–­å‘å°„ &lt;strong&gt;ActivityEvent&lt;/strong&gt;ï¼Œä¹Ÿå°±æ˜¯ Activity çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆä»‹ç»ä¸‹é‡Œé¢ç”¨åˆ°çš„å‡ ä¸ªæ“ä½œç¬¦ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://reactivex.io/RxJava/javadoc/rx/Observable.html#share()"&gt;share&lt;/a&gt;ï¼šç®€å•æ¥è¯´å°±æ˜¯è®© Observable æ”¯æŒå¤šè®¢é˜…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mcxiaoke.gitbooks.io/rxdocs/content/operators/Take.html"&gt;take&lt;/a&gt;ï¼šåªå‘å°„å‰é¢çš„ N é¡¹æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mcxiaoke.gitbooks.io/rxdocs/content/operators/Skip.html"&gt;skip&lt;/a&gt;ï¼šè·³è¿‡ Observable å‘å°„çš„å‰Né¡¹æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mcxiaoke.gitbooks.io/rxdocs/content/operators/CombineLatest.html"&gt;combineLatest&lt;/a&gt;ï¼šå½“ä¸¤ä¸ª Observables ä¸­çš„ä»»ä½•ä¸€ä¸ªå‘å°„äº†æ•°æ®æ—¶ï¼Œä½¿ç”¨ä¸€ä¸ªå‡½æ•°ç»“åˆæ¯ä¸ª Observable å‘å°„çš„æœ€è¿‘æ•°æ®é¡¹ï¼Œå¹¶ä¸”åŸºäºè¿™ä¸ªå‡½æ•°çš„ç»“æœå‘å°„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mcxiaoke.gitbooks.io/rxdocs/content/operators/Conditional.html#takeuntil"&gt;takeUntil&lt;/a&gt;ï¼šå½“ç¬¬äºŒä¸ª Observable å‘å°„äº†ä¸€é¡¹æ•°æ®æˆ–è€…ç»ˆæ­¢æ—¶ï¼Œä¸¢å¼ƒåŸå§‹ Observable å‘å°„çš„ä»»ä½•æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mcxiaoke.gitbooks.io/rxdocs/content/operators/Catch.html#onerrorreturn"&gt;onErrorReturn&lt;/a&gt;ï¼šè®© Observable é‡åˆ°é”™è¯¯æ—¶å‘å°„ä¸€ä¸ªç‰¹æ®Šçš„å€¼å¹¶ä¸”æ­£å¸¸ç»ˆæ­¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mcxiaoke.gitbooks.io/rxdocs/content/operators/First.html#takefirst"&gt;takeFirst&lt;/a&gt;ï¼šä¼ å…¥ä¸€ä¸ª Func1 ç»™ takeFirst, å‘å°„å‡ºèƒ½å¤Ÿä½¿å¾—è¿™ä¸ª Func1 ä¸º true çš„å…ƒç´ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œå†æ¨èä¸€ä¸ªç½‘ç«™ &lt;a href="http://rxmarbles.com/"&gt;http://rxmarbles.com/&lt;/a&gt;ï¼Œå¯è§†åŒ–äº¤äº’å¼ä½“éªŒ RxJava çš„æ“ä½œç¬¦ï¼Œèƒ½æ›´å¥½åœ°ç†è§£å„ä¸ªæ“ä½œç¬¦çš„å«ä¹‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…ˆåˆ†æä»£ç å—çš„å†…å±‚ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ˜¯ &lt;code&gt;combineLatest&lt;/code&gt; æ“ä½œç¬¦éœ€è¦æ¥æ”¶ä¸¤ä¸ª Observable å’Œä¸€ä¸ªå‡½æ•° Func2ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ä¸ªæ•°æ®æºç”± &lt;code&gt;lifecycle&lt;/code&gt; åªå‘å°„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³å½“å‰æ‰€åœ¨çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œç„¶åè¿›è¡Œä¸€ä¸‹ map å˜æ¢ï¼Œå¾—åˆ°åº”è¯¥è¢«é”€æ¯çš„ç”Ÿå‘½å‘¨æœŸ (ActivityEvent)ï¼Œå¹¶ä¸”è¿™ä¸ª Observable åªæœ‰è¿™ä¸€ä¸ªå…ƒç´ ï¼›&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒä¸ªæ•°æ®æºç”± &lt;code&gt;lifecycle&lt;/code&gt; è·³è¿‡ç¬¬ä¸€ä¸ªå…ƒç´ æ„æˆï¼Œå³åç»­ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æ‰€ç»„æˆçš„æ•°æ®æµï¼›&lt;/li&gt;
&lt;li&gt;å¤„ç†å‡½æ•°ï¼šå½“ä¸¤ä¸ªæ•°æ®æºçš„æ•°æ®ç›¸ç­‰æ—¶ï¼Œå³ Activity åˆ°è¾¾éœ€è¦è¢«é”€æ¯çš„ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œè¿”å› &lt;strong&gt;true&lt;/strong&gt;ï¼Œå‘å°„å‡ºä¸€ä¸ªå…ƒç´ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åæ‰§è¡Œ &lt;code&gt;onErrorReturn()&lt;/code&gt;ï¼Œè¿™æ˜¯å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œä½¿ Observable ä¸ä¼šå› ä¸ºé”™è¯¯è€Œä¸­æ–­ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åæ˜¯ &lt;code&gt;takeFirst(Func1)&lt;/code&gt;ï¼Œè¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³ &lt;code&gt;Func1&lt;/code&gt; çš„å…ƒç´ å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œç­‰åˆ° Activity åˆ°è¾¾éœ€è¦è¢«é”€æ¯çš„ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œ&lt;code&gt;combineLatest()&lt;/code&gt; æ‰€äº§ç”Ÿçš„ Observable ä¼šå‘å°„å‡ºä¸€ä¸ªå€¼ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶ååˆ†æå¤–å±‚ä»£ç ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;source.takeUntil(observable);&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;source å°±æ˜¯æˆ‘ä»¬åœ¨æ­£å¸¸ä»£ç ä¸­ä½¿ç”¨åˆ°çš„ Observableï¼Œæˆ‘ä»¬å¸Œæœ›è‡ªåŠ¨ç»“æŸçš„ Observableã€‚å½“å†…éƒ¨ observable å‘å°„å‡ºä¸€ä¸ªå€¼æ—¶ï¼Œsource ä¸¢å¼ƒæ‰åç»­æ•°æ®ï¼Œå³ç»ˆæ­¢æ‰è¿™ä¸ª Observableã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä»¥ä¸Šçš„ä»£ç ï¼Œå°±å®Œæˆäº† Observable è‡ªåŠ¨ç»‘å®šåˆ° Activity çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸”è‡ªåŠ¨ç»“æŸã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤– &lt;code&gt;RxLifecycle#bindUntilEvent()&lt;/code&gt; æ–¹æ³•ï¼Œç”¨äºå°† Observable ç»‘å®šåˆ°ç‰¹å®šçš„ç”Ÿå‘½å‘¨æœŸä¸Šï¼ŒåŸç†è·Ÿå‰é¢æ‰€ä»‹ç»çš„åŸºæœ¬ä¸€æ ·ï¼Œæˆ–è€…è¯´æ›´ä¸ºç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="bindUntilEvent" src="http://ww3.sinaimg.cn/large/801b780agw1f7yp2mk5kxj20m808o75q.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;åˆ¤æ–­åç»­çš„ç”Ÿå‘½å‘¨æœŸç­‰äºä¼ å…¥çš„ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œå°±åœæ­¢æ¥æ”¶æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº Fragmengã€View ç­‰ï¼ŒåŸç†å’Œåˆ†ææ–¹æ³•åŸºæœ¬ä¸€è‡´ï¼Œä¸å†è¯¦è¿°äº†ã€‚&lt;/p&gt;
&lt;h3&gt;å‘ä¸æç¤º&lt;/h3&gt;
&lt;h4&gt;1. BaseActivity ä¸æ–¹ä¾¿ç»§æ‰¿ RxActivity&lt;/h4&gt;
&lt;p&gt;ç›´æ¥è®© BaseActivity å®ç° &lt;code&gt;ActivityLifecycleProvider&lt;/code&gt; æ¥å£ï¼Œç„¶åæŠŠ RxActivity é‡Œçš„ä»£ç æ‹·è´åˆ° BaseActivity å°± ok äº†ã€‚&lt;/p&gt;
&lt;h4&gt;2. åœ¨&lt;strong&gt;ç•Œé¢åˆ‡æ¢&lt;/strong&gt;æ—¶ä½¿ç”¨ RxLifecycle æœ‰ä¸ªå°å‘&lt;/h4&gt;
&lt;p&gt;æ¯”å¦‚ä» ActivityA å¯åŠ¨ ActivityBï¼Œ ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A.onPause -&amp;gt; B.onCreate -&amp;gt; B.onResume -&amp;gt; A.onStop&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœ A ä¸­å¯åŠ¨ B çš„åŒæ—¶ï¼Œè®¢é˜…äº†ä¸€ä¸ª Observableï¼ŒåŒæ—¶è°ƒç”¨äº† &lt;code&gt;compose(bindToLifecycle())&lt;/code&gt;ï¼Œå¯èƒ½å‡ºç°å¦‚ä¸‹çš„ bugï¼š
è®¢é˜…æ—¶ï¼ŒA è¿˜å¤„äº &lt;code&gt;RESUME&lt;/code&gt; å‘¨æœŸï¼Œ&lt;code&gt;bindToLifecycle()&lt;/code&gt; ä¼šå¯¹åº”åˆ° &lt;code&gt;PAUSE&lt;/code&gt; å‘¨æœŸç»™é”€æ¯æ‰ã€‚è¿™ä¸ªæ—¶å€™å¯åŠ¨äº† Bï¼ŒA ä¼šè¿›å…¥ 'PAUSE' ç”Ÿå‘½å‘¨æœŸï¼Œè¿™æ˜¯å‰é¢çš„ Observable ä¼šè¢«åœæ‰ã€‚å¦‚æœä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæˆçš„è¯ï¼Œç»“æœä¼šè¾¾ä¸åˆ°æˆ‘ä»¬çš„é¢„æœŸã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¿™é‡Œåº”è¯¥ä½¿ç”¨ &lt;code&gt;bindUntilEvent(ActivityEvent.DESTROY)&lt;/code&gt;ã€‚å…¶å®ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„ Observable éƒ½ç»‘å®šåˆ° &lt;code&gt;DESTROY&lt;/code&gt; å³å¯ï¼Œå¯ä»¥åœ¨åŸºç±»ä¸­å°è£…ä¸€ä¸ª &lt;code&gt;bindToDestroyEvent()&lt;/code&gt; çš„æ–¹æ³•æ–¹ä¾¿ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h3&gt;å‚è€ƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/trello/RxLifecycle"&gt;trello/RxLifecycle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://mcxiaoke.gitbooks.io/rxdocs/content/"&gt;ReactiveX/RxJava æ–‡æ¡£ä¸­æ–‡ç‰ˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://rxmarbles.com/"&gt;RxMarbles&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Mon, 19 Sep 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-09-19:articles/2016/09/19/usage_and_principle_of_rxlifecycle/</guid></item><item><title>è®¾è®¡æ¨¡å¼å®è·µç³»åˆ—ï¼ˆä¸€ï¼‰</title><link>http://brucezz.github.io/articles/2016/08/28/design_pattern_practice_1/</link><description>&lt;p&gt;æœ€è¿‘åœ¨çœ‹ &lt;a href="https://book.douban.com/subject/1400656/"&gt;ã€ŠHead First Design Patternã€‹&lt;/a&gt;ï¼ˆé¡ºä¾¿æ¨èä¸€ä¸‹ğŸ˜„ï¼‰ï¼Œæ·±æ„Ÿç»“åˆå®ä¾‹ä¾‹å­æ‰èƒ½ç†è§£å¥½å„ç§æ¨¡å¼ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªå°åœºæ™¯ï¼Œæ¥å®è·µä¸€ä¸‹æœ€è¿‘å­¦ä¹ çš„å››ç§è®¾è®¡æ¨¡å¼ï¼ˆè£…é¥°å™¨æ¨¡å¼ã€å·¥å‚æ–¹æ³•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š &lt;a href="https://github.com/brucezz/DesignPatternStudy/tree/master/src/practice/practice01"&gt;DesignPatternStudy/src/practice/practice01 at master Â· brucezz/DesignPatternStudy&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¹³å¸¸æœ€ç¦»ä¸å¼€çš„å°±æ˜¯æ‰‹æœºäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ•…äº‹å°±ä»&lt;strong&gt;ä¹°æ‰‹æœº&lt;/strong&gt;å¼€å§‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éœ€è¦ä¸ªå®ä½“ç±» &lt;code&gt;Phone&lt;/code&gt;ï¼Œä»¥åŠç»§æ‰¿è‡ª &lt;code&gt;Phone&lt;/code&gt; çš„ä¸€ç³»åˆ—ä¸åŒå“ç‰Œçš„æ‰‹æœºã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Phone&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getBrand&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;// å“ç‰Œ&lt;/span&gt;

    &lt;span class="c1"&gt;//...&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸åŒå“ç‰Œçš„æ‰‹æœºå•ç‹¬å®ç°ä¸€ä¸‹ &lt;code&gt;getBrand()&lt;/code&gt; æ–¹æ³•å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;NexusPhone&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getBrand&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Nexus&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;OneplusPhone&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getBrand&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Oneplus&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸åŒçš„æ‰‹æœºï¼Œè‡ªç„¶æœ‰è‡ªå·±çš„ featureï¼Œ æ¯”å¦‚æœ‰çš„æ‰‹æœºå±å¹•å¤§ï¼Œæœ‰çš„æ‰‹æœºç»­èˆªæ—¶é—´é•¿ï¼Œè¿˜æœ‰çš„éŸ³è´¨ä¸é”™~&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå°±è¦ç”¨åˆ°ç¬¬ä¸€ä¸ªæ¨¡å¼å•¦ â€”â€” &lt;strong&gt;è£…é¥°å™¨æ¨¡å¼&lt;/strong&gt;ã€‚å…ˆç»§æ‰¿ &lt;code&gt;Phone&lt;/code&gt; å¾—åˆ°ä¸€ä¸ªè£…é¥°å™¨ç±» &lt;code&gt;PhoneDecorator&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PhoneDecorator&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;PhoneDecorator&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªè£…é¥°å™¨ç±»å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª &lt;code&gt;Phone&lt;/code&gt; å¯¹è±¡ï¼Œæ–¹ä¾¿å¯¹å…¶è¿›è¡Œè£…é¥°ï¼ŒåŒæ—¶ç»§æ‰¿äº† &lt;code&gt;Phone&lt;/code&gt;ï¼Œä¿è¯è£…é¥°åçš„å¯¹è±¡ç±»å‹ä¸åŸæ¥çš„ç±»å‹ä¿æŒä¸€è‡´ï¼Œä¸ä¼šå½±å“åˆ°ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * å¤§å±å¹•&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LargeScreen&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;PhoneDecorator&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;LargeScreen&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getBrand&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBrand&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;, Large Screen&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœæƒ³è¦å¾—åˆ°ä¸€å°å¤§å±å¹•çš„ Nexusï¼Œå¯ä»¥è¿™æ ·&lt;code&gt;Phone nexus = new LargeScreen(new NexusPhone());&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä»–è£…é¥°å™¨å¯ä»¥å»å‚è€ƒé¡¹ç›®ä»£ç ï¼Œä¸è´´å•¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰äº†æ‰‹æœºï¼Œå°±è¯¥æœ‰æ‰‹æœºåº—äº†ã€‚æˆ‘ä»¬è¿™é‡Œçš„æ‰‹æœºåº—æ˜¯ä¸“å–åº—å•¦ï¼Œéƒ½åªå–å„è‡ªç±»å‹çš„æ‰‹æœºã€‚é¦–å…ˆæˆ‘ä»¬è¿˜æ˜¯å¾—ä¸€ä¸ªæ¥å£ï¼ˆåœ¨è®¾è®¡æ¨¡å¼é‡Œé¢ï¼Œæ¥å£æ³›æŒ‡çˆ¶ç±»æˆ–è€…æ¥å£è¿™ç§è¶…ç±»å‹ï¼‰æ¥å®šä¹‰ç»Ÿä¸€çš„å–æ‰‹æœºçš„æ–¹æ³•ã€‚å®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PhoneStore&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="nf"&gt;sale&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;producePhone&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;// ç”Ÿäº§&lt;/span&gt;
        &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;pack&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;// æ‰“åŒ…&lt;/span&gt;
        &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;transport&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;// è¿è¾“&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="nf"&gt;producePhone&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œç”¨åˆ°äº†å¦ä¸€ä¸ªæ¨¡å¼ â€”â€” &lt;strong&gt;å·¥å‚æ–¹æ³•æ¨¡å¼&lt;/strong&gt;ã€‚å°†å®ä¾‹åŒ– &lt;code&gt;Phone&lt;/code&gt; å¯¹è±¡çš„è¿‡ç¨‹å»¶è¿Ÿåˆ°å­ç±»ä¸­è¿›è¡Œï¼Œç”±å­ç±»å³å…·ä½“çš„æ‰‹æœºä¸“å–åº—æ¥å†³å®šæ‰‹æœºçš„ç±»å‹ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸åŒå“ç‰Œçš„ä¸“å–åº—å°±èƒ½å–å„è‡ªå®¶çš„æ‰‹æœºäº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;NexusStore&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;PhoneStore&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="nf"&gt;producePhone&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;LongBatteryLife&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;LargeScreen&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HiFi&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;NexusPhone&lt;/span&gt;&lt;span class="o"&gt;())));&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;NexusStore&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åˆ°è¿™é‡Œï¼Œ&lt;code&gt;PhoneStore&lt;/code&gt; ä¹Ÿå®ç°å¥½äº†ï¼Œæ¶ˆè´¹è€…å¯ä»¥ç›´æ¥é€šè¿‡ &lt;code&gt;Phone nexus = new NexusStore().sale();&lt;/code&gt; æ¥ä¹°ä¸€å° nexusã€‚ &lt;/p&gt;
&lt;p&gt;æ•´ä¸ªæ•…äº‹çš„å‰§æƒ…å°±æ˜¯è¿™æ ·ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Customer&lt;/span&gt; &lt;span class="n"&gt;jaeger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Customer&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Jaeger&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Nexus&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;jaeger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hello&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

        &lt;span class="n"&gt;NexusStore&lt;/span&gt; &lt;span class="n"&gt;store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;NexusStore&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sale&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

        &lt;span class="n"&gt;jaeger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setPhone&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;jaeger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hello&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¾“å‡ºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;[Jaeger] å˜¿, æˆ‘æ˜¯ Jaeger, æˆ‘å–œæ¬¢ Nexus è¿™ä¸ªç‰Œå­, ä¸è¿‡æˆ‘è¿˜æ²¡æœ‰æ‰‹æœºè¯¶ :(
[Nexus, HiFi, Large Screen, Long Battery Life Phone] æ‰“åŒ…ä¸­ ...
[Nexus, HiFi, Large Screen, Long Battery Life Phone] è¿è¾“ä¸­ ...
[Jaeger] æˆ‘æœ‰æ‰‹æœºå•¦! Nexus, HiFi, Large Screen, Long Battery Life
[Jaeger] å˜¿, æˆ‘æ˜¯ Jaeger, æˆ‘å–œæ¬¢ Nexus è¿™ä¸ªç‰Œå­, æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªæ‰‹æœº: Nexus, HiFi, Large Screen, Long Battery Life 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;éªšå¹´ï¼Œä½ ä»¥ä¸ºè¿™æ ·æ•…äº‹å°±å®Œç»“äº†ï¼Ÿå›¾æ ·å›¾æ£®ç ´å•Šï¼
å…¶å® &lt;a href="https://github.com/laobie"&gt;Jaeger&lt;/a&gt; å»ä¹°æ‰‹æœºçš„æ—¶å€™ï¼Œæ‰‹æœºæ²¡è´§å•¦ ğŸ˜…
ç„¶ååº—å‘˜å‘Šè¯‰ä»–ï¼šä½ åœ¨è¿™é‡Œç™»è®°ä¸€ä¸‹ï¼Œç„¶åä¸‰å¤©ä¹‹åæ‰‹æœºåˆ°è´§äº†ï¼Œæˆ‘ä»¬ä¼šä¸»åŠ¨è”ç³»ä½ çš„ï¼Œåˆ°æ—¶å€™ä½ å†æ¥ä¹°æ‰‹æœºï¼Œè‚¯å®šæœ‰è´§ï¼&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç™»è®°å’Œé€šçŸ¥çš„è¿‡ç¨‹å˜›ï¼Œå°±è¦ç”¨åˆ°ç¬¬ä¸‰ä¸ªæ¨¡å¼ â€”â€” &lt;strong&gt;è§‚å¯Ÿè€…æ¨¡å¼&lt;/strong&gt;ã€‚æ‰‹æœºåº—ä¸ºè¢«è§‚å¯Ÿå¯¹è±¡ï¼Œ &lt;a href="https://github.com/laobie"&gt;Jaeger&lt;/a&gt; æ˜¯è§‚å¯Ÿè€…ã€‚é¦–å…ˆè§‚å¯Ÿè€…è¦å‘è¢«è§‚å¯Ÿè€…è¿›è¡Œæ³¨å†Œï¼Œä¹Ÿå°±æ˜¯ç™»è®°çš„è¿‡ç¨‹ã€‚ç„¶åè¢«è§‚å¯Ÿè€…åœ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰æ³¨å†Œçš„è§‚å¯Ÿè€…ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PhoneStore&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt;     * ç­‰å¾…è´­ä¹°çš„é¡¾å®¢çš„åˆ—è¡¨&lt;/span&gt;
&lt;span class="cm"&gt;     */&lt;/span&gt;
    &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Waiting&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;waitList&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="nf"&gt;sale&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;isPhoneValid&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;producePhone&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;pack&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;transport&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;[&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;] ç°åœ¨æ‰‹æœºå–å®Œå•¦, ä½ å…ˆç™»è®°ä¸€ä¸‹, ç­‰ä¸‰å¤©ä¹‹åæ‰‹æœºåˆ°è´§äº†æˆ‘ä»¬å†é€šçŸ¥ä½ ~&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;days&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;register&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Waiting&lt;/span&gt; &lt;span class="n"&gt;waiting&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(!&lt;/span&gt;&lt;span class="n"&gt;waitList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;contains&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;waiting&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;waitList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;waiting&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;unRegister&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Customer&lt;/span&gt; &lt;span class="n"&gt;customer&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;waitList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;remove&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;customer&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;notifyAllCustomers&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Waiting&lt;/span&gt; &lt;span class="n"&gt;waiting&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;waitList&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;waiting&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;onPhoneValid&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;days&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt;     * ç­‰å¾…ä¸‰å¤©&lt;/span&gt;
&lt;span class="cm"&gt;     */&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;oneDayPassed&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;days&lt;/span&gt;&lt;span class="o"&gt;++;&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;days&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; å¤©è¿‡å»äº† ...&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;days&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;notifyAllCustomers&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;isPhoneValid&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;days&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="nf"&gt;producePhone&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;abstract&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;Waiting&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onPhoneValid&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PhoneStore&lt;/span&gt; &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Customer&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;PhoneStore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Waiting&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;favorite&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt;     * @param name     åå­—&lt;/span&gt;
&lt;span class="cm"&gt;     * @param favorite å–œæ¬¢çš„ç‰Œå­&lt;/span&gt;
&lt;span class="cm"&gt;     */&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;Customer&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;favorite&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;favorite&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;favorite&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;setPhone&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;[&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;] &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
                &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;æˆ‘æœ‰&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;æˆ‘æ¢&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
                &lt;span class="s"&gt;&amp;quot;æ‰‹æœºå•¦! &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBrand&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt;     * å•†åº—é€šçŸ¥è¯´,æœ‰è´§å•¦!&lt;/span&gt;
&lt;span class="cm"&gt;     */&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onPhoneValid&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PhoneStore&lt;/span&gt; &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;setPhone&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sale&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt; &lt;span class="k"&gt;instanceof&lt;/span&gt; &lt;span class="n"&gt;Customer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(((&lt;/span&gt;&lt;span class="n"&gt;Customer&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;name&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;format&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;[%s] å˜¿, æˆ‘æ˜¯ %s, æˆ‘å–œæ¬¢ %s è¿™ä¸ªç‰Œå­, &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;
                &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;ä¸è¿‡æˆ‘è¿˜æ²¡æœ‰æ‰‹æœºè¯¶ :(&amp;quot;&lt;/span&gt;
                &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªæ‰‹æœº: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBrand&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; ^_^&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;favorite&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;hello&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œç”¨ &lt;code&gt;oneDayPassed()&lt;/code&gt; æ–¹æ³•æ¥æ¨¡æ‹Ÿæ—¶é—´çš„æµé€ï¼Œè®¡æ•°ç´¯è®¡åˆ° 3 æ—¶ï¼Œä¸ºæ‰‹æœºæœ‰è´§çš„çŠ¶æ€ã€‚
è®©æ¶ˆè´¹è€…å®ç° &lt;code&gt;PhoneStore.Waiting&lt;/code&gt; è¿™ä¸ªæ¥å£æ¥å®šä¹‰æ”¶åˆ°é€šçŸ¥æ—¶çš„æ“ä½œã€‚å•†åº—å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªåˆ—è¡¨ï¼ŒæŠŠæ‰€æœ‰ç­‰å¾…çš„æ¶ˆè´¹è€…éƒ½åŠ è¿›å»äº†ï¼Œç­‰åˆ°æ‰‹æœºæœ‰è´§äº†ï¼ŒæŒ¨ä¸ªé€šçŸ¥æ¶ˆè´¹è€…ï¼Œè®©å…¶å›æ¥ä¹°æ‰‹æœºã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡å®ç°è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè§£å†³äº†æ‰‹æœºå–å®Œçš„å°´å°¬äº†ã€‚ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Customer&lt;/span&gt; &lt;span class="n"&gt;jaeger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Customer&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Jaeger&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Nexus&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;jaeger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hello&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

        &lt;span class="n"&gt;PhoneStore&lt;/span&gt; &lt;span class="n"&gt;store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;NexusStore&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;Phone&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sale&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;// ç­‰ä¸‰å¤©&lt;/span&gt;
            &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;register&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaeger&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;oneDayPassed&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;oneDayPassed&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;oneDayPassed&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;

        &lt;span class="n"&gt;jaeger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hello&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;[Jaeger] å˜¿, æˆ‘æ˜¯ Jaeger, æˆ‘å–œæ¬¢ Nexus è¿™ä¸ªç‰Œå­, ä¸è¿‡æˆ‘è¿˜æ²¡æœ‰æ‰‹æœºè¯¶ :(
[NexusStore] ç°åœ¨æ‰‹æœºå–å®Œå•¦, ä½ å…ˆç™»è®°ä¸€ä¸‹, ç­‰ä¸‰å¤©ä¹‹åæ‰‹æœºåˆ°è´§äº†æˆ‘ä»¬å†é€šçŸ¥ä½ ~
1 å¤©è¿‡å»äº† ...
2 å¤©è¿‡å»äº† ...
3 å¤©è¿‡å»äº† ...
[Nexus, HiFi, Large Screen, Long Battery Life Phone] æ‰“åŒ…ä¸­ ...
[Nexus, HiFi, Large Screen, Long Battery Life Phone] è¿è¾“ä¸­ ...
[Jaeger] æˆ‘æœ‰æ‰‹æœºå•¦! Nexus, HiFi, Large Screen, Long Battery Life
[Jaeger] å˜¿, æˆ‘æ˜¯ Jaeger, æˆ‘å–œæ¬¢ Nexus è¿™ä¸ªç‰Œå­, æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªæ‰‹æœº: Nexus, HiFi, Large Screen, Long Battery Life ^_^
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æœ€åï¼Œ &lt;a href="https://github.com/laobie"&gt;Jaeger&lt;/a&gt; è§‰å¾—è¿™ä¸ª Nexus æ‰‹æœºç”¨ç€ä¸çˆ½ï¼Œè¦ä¹°æœ€æ–°çš„ 1+3 ğŸ˜’ã€‚è¿™ä¸ªä¸éš¾ï¼Œç›´æ¥å»ä¸“å–åº—ä¹°ä¸€ä¸ªå°±å¥½å•¦ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Main&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// ... çœç•¥&lt;/span&gt;

        &lt;span class="c1"&gt;// æ¢ä¸ªæ‰‹æœº&lt;/span&gt;
        &lt;span class="n"&gt;store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OneplusStore&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;store&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sale&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;jaeger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setPhone&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phone&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;jaeger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hello&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶å®è¿™é‡ŒåŒ…å«äº†æœ€åä¸€ç§æ¨¡å¼ â€”â€” &lt;strong&gt;ç­–ç•¥æ¨¡å¼&lt;/strong&gt;ã€‚&lt;code&gt;Custom&lt;/code&gt; å¯¹è±¡ä¸­æŒæœ‰ä¸€ä¸ª &lt;code&gt;Phone&lt;/code&gt; æ‰‹æœºå¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»å‹ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„ç±»ã€‚è¿™æ ·çš„å¥½å¤„å°±æ˜¯å¯ä»¥æ–¹ä¾¿åœ°ç”¨ &lt;code&gt;Phone&lt;/code&gt; çš„ä»»æ„å­ç±»å»æ›¿æ¢ &lt;code&gt;Custom&lt;/code&gt; ä¸­çš„æ‰‹æœºï¼Œè€Œä¸ä¼šå½±å“åˆ°å†…éƒ¨å…¶ä»–åœ°æ–¹çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å¼äº†ï¼Œæ•…äº‹å°±æ‰¯åˆ°è¿™é‡Œäº†ï¼Œé€šè¿‡  &lt;a href="https://github.com/laobie"&gt;Jaeger&lt;/a&gt; ä¹°æ‰‹æœºçš„ç»å†ï¼Œå®è·µäº†ä¸€ä¸‹è¿™å››ä¸ªè®¾è®¡æ¨¡å¼ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è£…é¥°å™¨æ¨¡å¼ï¼šåŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡å¢åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œæ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚&lt;/li&gt;
&lt;li&gt;å·¥å‚æ–¹æ³•æ¨¡å¼ï¼šå®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå°†å“ªä¸€ä¸ªç±»å®ä¾‹åŒ–&lt;/li&gt;
&lt;li&gt;è§‚å¯Ÿè€…æ¨¡å¼ï¼šå®šä¹‰å¯¹è±¡ä¹‹é—´çš„ä¸€ç§ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œä½¿å¾—æ¯å½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå…¶ç›¸å…³ä¾èµ–å¯¹è±¡çš†å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚&lt;/li&gt;
&lt;li&gt;ç­–ç•¥æ¨¡å¼ï¼šå®šä¹‰ä¸€ç³»åˆ—ç­–ç•¥ï¼Œå°†æ¯ä¸€ä¸ªç­–ç•¥å°è£…èµ·æ¥ï¼Œå¹¶è®©å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œè®©ä»–ä»¬çš„å˜åŒ–ç‹¬ç«‹è¯­è°ƒç”¨è€…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä»–è®¾è®¡æ¨¡å¼å¾…ç»­â€¦â€¦&lt;/p&gt;
&lt;p&gt;æˆ‘çš„è®¾è®¡æ¨¡å¼ç»ƒä¹ ä»£ç ï¼š&lt;a href="https://github.com/brucezz/DesignPatternStudy"&gt;brucezz/DesignPatternStudy: Design Pattern in Java&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºè®¾è®¡æ¨¡å¼æˆ‘ä¹Ÿåªæ˜¯åˆå­¦ï¼Œæœ‰ä¸€äº›è‡ªå·±çš„ç†è§£ï¼Œæ¬¢è¿æ¥è®¨è®ºæŒ‡ç‚¹ ğŸ˜„&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ€åçš„æœ€åï¼Œæ„Ÿè°¢å¥½æœºæ²¹  &lt;a href="https://github.com/laobie"&gt;Jaeger&lt;/a&gt; å€¾æƒ…å‡ºæ¼”ğŸ˜†ï¼&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Sun, 28 Aug 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-08-28:articles/2016/08/28/design_pattern_practice_1/</guid></item><item><title>Android åˆ©ç”¨ APT æŠ€æœ¯åœ¨ç¼–è¯‘æœŸç”Ÿæˆä»£ç </title><link>http://brucezz.github.io/articles/2016/08/06/use-apt-in-android/</link><description>&lt;p&gt;APT(&lt;code&gt;Annotation Processing Tool&lt;/code&gt; çš„ç®€ç§°)ï¼Œå¯ä»¥åœ¨ä»£ç ç¼–è¯‘æœŸè§£ææ³¨è§£ï¼Œå¹¶ä¸”ç”Ÿæˆæ–°çš„ Java æ–‡ä»¶ï¼Œå‡å°‘æ‰‹åŠ¨çš„ä»£ç è¾“å…¥ã€‚ç°åœ¨æœ‰å¾ˆå¤šä¸»æµåº“éƒ½ç”¨ä¸Šäº† APTï¼Œæ¯”å¦‚ Dagger2, ButterKnife, EventBus3 ç­‰ï¼Œæˆ‘ä»¬è¦ç´§è·Ÿæ½®æµï¼Œä¸æ—¶ä¿±è¿›å‘ï¼Â (à¸‡ â€¢Ì€_â€¢Ì)à¸‡&lt;/p&gt;
&lt;p&gt;ä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•çš„ View æ³¨å…¥é¡¹ç›® &lt;code&gt;ViewFinder&lt;/code&gt; æ¥ä»‹ç» APT ç›¸å…³å†…å®¹ï¼Œç®€å•å®ç°äº†ç±»ä¼¼äº &lt;code&gt;ButterKnife&lt;/code&gt; ä¸­çš„ä¸¤ç§æ³¨è§£ &lt;code&gt;@BindView&lt;/code&gt; å’Œ &lt;code&gt;@OnClick&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href="https://github.com/brucezz/ViewFinder"&gt;https://github.com/brucezz/ViewFinder&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¤§æ¦‚é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;viewFinder-annotation&lt;/code&gt;  - æ³¨è§£ç›¸å…³æ¨¡å—&lt;/li&gt;
&lt;li&gt;&lt;code&gt;viewFinder-compiler&lt;/code&gt;  - æ³¨è§£å¤„ç†å™¨æ¨¡å—&lt;/li&gt;
&lt;li&gt;&lt;code&gt;viewfinder&lt;/code&gt;  - API ç›¸å…³æ¨¡å—&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sample&lt;/code&gt;  - ç¤ºä¾‹ Demo æ¨¡å—&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å®ç°ç›®æ ‡&lt;/h3&gt;
&lt;p&gt;åœ¨é€šå¸¸çš„ Android é¡¹ç›®ä¸­ï¼Œä¼šå†™å¤§é‡çš„ç•Œé¢ï¼Œé‚£ä¹ˆå°±ä¼šç»å¸¸é‡å¤åœ°å†™ä¸€äº›ä»£ç ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;TextView&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TextView&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;findViewById&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;tv&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setOnClickListener&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;OnClickListener&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// on click&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¤©å¤©å†™è¿™ä¹ˆå†—é•¿åˆæ— è„‘çš„ä»£ç ï¼Œè¿˜èƒ½ä¸èƒ½æ„‰å¿«åœ°ç©è€å•¦ã€‚æ‰€ä»¥ï¼Œæˆ‘æ‰“ç®—é€šè¿‡ &lt;code&gt;ViewFinder&lt;/code&gt; è¿™ä¸ªé¡¹ç›®æ›¿ä»£è¿™é‡å¤çš„å·¥ä½œï¼Œåªéœ€è¦ç®€å•åœ°æ ‡æ³¨ä¸Šæ³¨è§£å³å¯ã€‚é€šè¿‡æ§ä»¶ id è¿›è¡Œæ³¨è§£ï¼Œå¹¶ä¸” &lt;code&gt;@OnClick&lt;/code&gt; å¯ä»¥å¯¹å¤šä¸ªæ§ä»¶æ³¨è§£åŒä¸€ä¸ªæ–¹æ³•ã€‚å°±åƒä¸‹é¢è¿™æ ·å­å’¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@BindView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;tv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;TextView&lt;/span&gt; &lt;span class="n"&gt;mTextView&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="nd"&gt;@OnClick&lt;/span&gt;&lt;span class="o"&gt;({&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;tv&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;btn&lt;/span&gt;&lt;span class="o"&gt;})&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onSomethingClick&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// on click&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;å®šä¹‰æ³¨è§£&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ›å»º module  &lt;code&gt;viewFinder-annotation&lt;/code&gt; ï¼Œç±»å‹ä¸º Java Libraryï¼Œå®šä¹‰é¡¹ç›®æ‰€éœ€è¦çš„æ³¨è§£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨ &lt;code&gt;ViewFinder&lt;/code&gt; ä¸­éœ€è¦ä¸¤ä¸ªæ³¨è§£ &lt;code&gt;@BindView&lt;/code&gt; å’Œ &lt;code&gt;@OnClick&lt;/code&gt; ã€‚å®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Retention&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RetentionPolicy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;CLASS&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="nd"&gt;@Target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ElementType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;FIELD&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nd"&gt;@interface&lt;/span&gt; &lt;span class="n"&gt;BindView&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;value&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Retention&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RetentionPolicy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;CLASS&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="nd"&gt;@Target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ElementType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;METHOD&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nd"&gt;@interface&lt;/span&gt; &lt;span class="n"&gt;OnClick&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="nf"&gt;value&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;@BindView&lt;/code&gt; éœ€è¦å¯¹æˆå‘˜å˜é‡è¿›è¡Œæ³¨è§£ï¼Œå¹¶ä¸”æ¥æ”¶ä¸€ä¸ª int ç±»å‹çš„å‚æ•°ï¼›
&lt;code&gt;@OnClick&lt;/code&gt; éœ€è¦å¯¹æ–¹æ³•è¿›è¡Œæ³¨è§£ï¼Œæ¥æ”¶ä¸€ç»„ int ç±»å‹å‚æ•°ï¼Œç›¸å½“äºç»™ä¸€ç»„ View æŒ‡å®šç‚¹å‡»å“åº”äº‹ä»¶ã€‚&lt;/p&gt;
&lt;h3&gt;ç¼–å†™ API&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ›å»º module &lt;code&gt;viewfinder&lt;/code&gt;ï¼Œç±»å‹ä¸º Android Libraryã€‚åœ¨è¿™ä¸ª module ä¸­å»å®šä¹‰ APIï¼Œä¹Ÿå°±æ˜¯å»ç¡®å®šè®©åˆ«äººå¦‚ä½•æ¥ä½¿ç”¨æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦ä¸€ä¸ª API ä¸»å…¥å£ï¼Œæä¾›é™æ€æ–¹æ³•ç›´æ¥è°ƒç”¨ï¼Œå°±æ¯”å¦‚è¿™æ ·ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;ViewFinder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åŒæ—¶ï¼Œéœ€è¦ä¸ºä¸åŒçš„ç›®æ ‡ï¼ˆæ¯”å¦‚ Activityã€Fragment å’Œ View ç­‰ï¼‰æä¾›é‡è½½çš„æ³¨å…¥æ–¹æ³•ï¼Œæœ€ç»ˆéƒ½è°ƒç”¨ &lt;code&gt;inject()&lt;/code&gt; æ–¹æ³•ã€‚å…¶ä¸­æœ‰ä¸‰ä¸ªå‚æ•°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;host&lt;/code&gt; è¡¨ç¤ºæ³¨è§£ View å˜é‡æ‰€åœ¨çš„ç±»ï¼Œä¹Ÿå°±æ˜¯æ³¨è§£ç±»&lt;/li&gt;
&lt;li&gt;&lt;code&gt;source&lt;/code&gt; è¡¨ç¤ºæŸ¥æ‰¾ View çš„åœ°æ–¹ï¼ŒActivity &amp;amp; View è‡ªèº«å°±å¯ä»¥æŸ¥æ‰¾ï¼ŒFragment éœ€è¦åœ¨è‡ªå·±çš„ itemView ä¸­æŸ¥æ‰¾&lt;/li&gt;
&lt;li&gt;&lt;code&gt;provider&lt;/code&gt; æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®šä¹‰äº†ä¸åŒå¯¹è±¡ï¼ˆæ¯”å¦‚ Activityã€View ç­‰ï¼‰å¦‚ä½•å»æŸ¥æ‰¾ç›®æ ‡ Viewï¼Œé¡¹ç›®ä¸­åˆ†åˆ«ä¸º Activityã€View å®ç°äº† &lt;code&gt;Provider&lt;/code&gt; æ¥å£ï¼ˆå…·ä½“å®ç°å‚è€ƒ&lt;a href="https://github.com/brucezz/ViewFinder"&gt;é¡¹ç›®ä»£ç &lt;/a&gt;å§ ğŸ˜„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ViewFinder&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;ActivityProvider&lt;/span&gt; &lt;span class="n"&gt;PROVIDER_ACTIVITY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ActivityProvider&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;ViewProvider&lt;/span&gt; &lt;span class="n"&gt;PROVIDER_VIEW&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ViewProvider&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Activity&lt;/span&gt; &lt;span class="n"&gt;activity&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;activity&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;activity&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PROVIDER_ACTIVITY&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// for view&lt;/span&gt;
        &lt;span class="n"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// for fragment&lt;/span&gt;
        &lt;span class="n"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PROVIDER_VIEW&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Provider&lt;/span&gt; &lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// how to implement ?&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é‚£ä¹ˆ &lt;code&gt;inject()&lt;/code&gt; æ–¹æ³•ä¸­éƒ½å†™ä¸€äº›ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¥å£ &lt;code&gt;Finder&lt;/code&gt;ï¼Œç„¶åä¸ºæ¯ä¸€ä¸ªæ³¨è§£ç±»éƒ½ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„å†…éƒ¨ç±»å¹¶ä¸”å®ç°è¿™ä¸ªæ¥å£ï¼Œç„¶åå®ç°å…·ä½“çš„æ³¨å…¥é€»è¾‘ã€‚åœ¨ &lt;code&gt;inject()&lt;/code&gt; æ–¹æ³•ä¸­é¦–å…ˆæ‰¾åˆ°è°ƒç”¨è€…å¯¹åº”çš„ &lt;code&gt;Finder&lt;/code&gt; å®ç°ç±»ï¼Œç„¶åè°ƒç”¨å…¶å†…éƒ¨çš„å…·ä½“é€»è¾‘æ¥è¾¾åˆ°æ³¨å…¥çš„ç›®çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¥å£ &lt;code&gt;Finder&lt;/code&gt; è®¾è®¡å¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;Finder&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Provider&lt;/span&gt; &lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸¾ä¸ªğŸŒ°ï¼Œä¸º &lt;code&gt;MainActivity&lt;/code&gt; ç”Ÿæˆ &lt;code&gt;MainActivity$$Finder&lt;/code&gt;ï¼Œå¯¹å…¶æ³¨è§£çš„ View è¿›è¡Œåˆå§‹åŒ–å’Œè®¾ç½®ç‚¹å‡»äº‹ä»¶ï¼Œè¿™å°±è·Ÿæˆ‘ä»¬å¹³å¸¸æ‰€å†™çš„é‡å¤ä»£ç åŸºæœ¬ç›¸åŒã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MainActivity$$Finder&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Finder&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;MainActivity&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;MainActivity&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Provider&lt;/span&gt; &lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;mTextView&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TextView&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2131427414&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;mButton&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Button&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2131427413&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;mEditText&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EditText&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2131427412&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;OnClickListener&lt;/span&gt; &lt;span class="n"&gt;listener&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;listener&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;OnClickListener&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="nd"&gt;@Override&lt;/span&gt;
            &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;onButtonClick&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="o"&gt;};&lt;/span&gt;
        &lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2131427413&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;setOnClickListener&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;listener&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;listener&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;OnClickListener&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="nd"&gt;@Override&lt;/span&gt;
            &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;onTextClick&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="o"&gt;};&lt;/span&gt;
        &lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2131427414&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;setOnClickListener&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;listener&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¥½äº†ï¼Œæ‰€æœ‰æ³¨è§£ç±»éƒ½æœ‰äº†ä¸€ä¸ªåä¸º &lt;code&gt;xx$$Finder&lt;/code&gt; çš„å†…éƒ¨ç±»ã€‚æˆ‘ä»¬é¦–å…ˆé€šè¿‡æ³¨è§£ç±»çš„ç±»åï¼Œå¾—åˆ°å…¶å¯¹åº”å†…éƒ¨ç±»çš„ Class å¯¹è±¡ï¼Œç„¶åå®ä¾‹åŒ–æ‹¿åˆ°å…·ä½“å¯¹è±¡ï¼Œè°ƒç”¨æ³¨å…¥æ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ViewFinder&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="c1"&gt;// same as above&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Finder&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;FINDER_MAP&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Provider&lt;/span&gt; &lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;className&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getClass&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;Finder&lt;/span&gt; &lt;span class="n"&gt;finder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FINDER_MAP&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;className&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;finder&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;finderClass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;className&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$$Finder&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
                &lt;span class="n"&gt;finder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Finder&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;finderClass&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newInstance&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
                &lt;span class="n"&gt;FINDER_MAP&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;className&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;finder&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;finder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;provider&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Exception&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;RuntimeException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Unable to inject for &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;className&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦å¤–ä»£ç ä¸­ä½¿ç”¨åˆ°äº†ä¸€ç‚¹åå°„ï¼Œæ‰€ä»¥ä¸ºäº†æé«˜æ•ˆç‡ï¼Œé¿å…æ¯æ¬¡æ³¨å…¥çš„æ—¶å€™éƒ½å»æ‰¾ &lt;code&gt;Finder&lt;/code&gt; å¯¹è±¡ï¼Œè¿™é‡Œç”¨ä¸€ä¸ª Map å°†ç¬¬ä¸€æ¬¡æ‰¾åˆ°çš„å¯¹è±¡ç¼“å­˜èµ·æ¥ï¼Œåé¢ç”¨çš„æ—¶å€™ç›´æ¥ä» Map é‡Œé¢å–ã€‚&lt;/p&gt;
&lt;p&gt;åˆ°æ­¤ï¼ŒAPI æ¨¡å—çš„è®¾è®¡åŸºæœ¬æå®šäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å»é€šè¿‡æ³¨è§£å¤„ç†å™¨ä¸ºæ¯ä¸€ä¸ªæ³¨è§£ç±»ç”Ÿæˆ &lt;code&gt;Finder&lt;/code&gt; å†…éƒ¨ç±»ã€‚&lt;/p&gt;
&lt;h3&gt;åˆ›å»ºæ³¨è§£å¤„ç†å™¨&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ›å»º module &lt;code&gt;viewFinder-compiler&lt;/code&gt;ï¼Œç±»å‹ä¸º Java Libraryï¼Œå®ç°ä¸€ä¸ªæ³¨è§£å¤„ç†å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªæ¨¡å—éœ€è¦æ·»åŠ ä¸€äº›ä¾èµ–ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;compile&lt;/span&gt; &lt;span class="nf"&gt;project&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;:viewfinder-annotation&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;compile&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;com.squareup:javapoet:1.7.0&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;compile&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;com.google.auto.service:auto-service:1.0-rc2&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;å› ä¸ºè¦ç”¨åˆ°å‰é¢å®šä¹‰çš„æ³¨è§£ï¼Œå½“ç„¶è¦ä¾èµ– &lt;code&gt;viewFinder-annotation&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;javapoet&lt;/code&gt; æ˜¯&lt;strong&gt;æ–¹å—å…¬å¸&lt;/strong&gt;å‡ºçš„åˆä¸€ä¸ªå¥½ç”¨åˆ°çˆ†ç‚¸çš„è£¤å­ï¼Œæä¾›äº†å„ç§ API è®©ä½ ç”¨å„ç§å§¿åŠ¿å»ç”Ÿæˆ Java ä»£ç æ–‡ä»¶ï¼Œé¿å…äº†å¾’æ‰‹æ‹¼æ¥å­—ç¬¦ä¸²çš„å°´å°¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;auto-service&lt;/code&gt; æ˜¯ Google å®¶çš„è£¤å­ï¼Œä¸»è¦ç”¨äºæ³¨è§£ &lt;code&gt;Processor&lt;/code&gt;ï¼Œå¯¹å…¶ç”Ÿæˆ &lt;code&gt;META-INF&lt;/code&gt; é…ç½®ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢å°±æ¥åˆ›å»ºæˆ‘ä»¬çš„å¤„ç†å™¨ &lt;code&gt;ViewFinderProcessor&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@AutoService&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Processor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ViewFinderProcesser&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;AbstractProcessor&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt;     * ä½¿ç”¨ Google çš„ auto-service åº“å¯ä»¥è‡ªåŠ¨ç”Ÿæˆ META-INF/services/javax.annotation.processing.Processor æ–‡ä»¶&lt;/span&gt;
&lt;span class="cm"&gt;     */&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Filer&lt;/span&gt; &lt;span class="n"&gt;mFiler&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;//æ–‡ä»¶ç›¸å…³çš„è¾…åŠ©ç±»&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Elements&lt;/span&gt; &lt;span class="n"&gt;mElementUtils&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;//å…ƒç´ ç›¸å…³çš„è¾…åŠ©ç±»&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Messager&lt;/span&gt; &lt;span class="n"&gt;mMessager&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;//æ—¥å¿—ç›¸å…³çš„è¾…åŠ©ç±»&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;synchronized&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;init&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ProcessingEnvironment&lt;/span&gt; &lt;span class="n"&gt;processingEnv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;init&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;processingEnv&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;mFiler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;processingEnv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getFiler&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;mElementUtils&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;processingEnv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getElementUtils&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;mMessager&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;processingEnv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMessager&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt;     * @return æŒ‡å®šå“ªäº›æ³¨è§£åº”è¯¥è¢«æ³¨è§£å¤„ç†å™¨æ³¨å†Œ&lt;/span&gt;
&lt;span class="cm"&gt;     */&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getSupportedAnnotationTypes&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;types&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;LinkedHashSet&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
        &lt;span class="n"&gt;types&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BindView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCanonicalName&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
        &lt;span class="n"&gt;types&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;OnClick&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCanonicalName&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;types&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt;     * @return æŒ‡å®šä½¿ç”¨çš„ Java ç‰ˆæœ¬ã€‚é€šå¸¸è¿”å› SourceVersion.latestSupported()ã€‚&lt;/span&gt;
&lt;span class="cm"&gt;     */&lt;/span&gt;
    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;SourceVersion&lt;/span&gt; &lt;span class="nf"&gt;getSupportedSourceVersion&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;SourceVersion&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;latestSupported&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;process&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;TypeElement&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;annotations&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RoundEnvironment&lt;/span&gt; &lt;span class="n"&gt;roundEnv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// to process annotations &lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç”¨ &lt;code&gt;@AutoService&lt;/code&gt; æ¥æ³¨è§£è¿™ä¸ªå¤„ç†å™¨ï¼Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆé…ç½®ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;code&gt;init()&lt;/code&gt; å¯ä»¥åˆå§‹åŒ–æ‹¿åˆ°ä¸€äº›å®ç”¨çš„å·¥å…·ç±»ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;code&gt;getSupportedAnnotationTypes()&lt;/code&gt; æ–¹æ³•ä¸­è¿”å›æ‰€è¦å¤„ç†çš„æ³¨è§£çš„é›†åˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;code&gt;getSupportedSourceVersion()&lt;/code&gt; æ–¹æ³•ä¸­è¿”å› Java ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å‡ ä¸ªæ–¹æ³•å†™æ³•åŸºæœ¬ä¸Šéƒ½æ˜¯å›ºå®šçš„ï¼Œé‡å¤´æˆåœ¨ &lt;code&gt;process()&lt;/code&gt; æ–¹æ³•ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œæ’æ’­ä¸€ä¸‹ &lt;code&gt;Element&lt;/code&gt; å…ƒç´ ç›¸å…³æ¦‚å¿µï¼Œåé¢ä¼šç”¨åˆ°ä¸å°‘ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;Element&lt;/code&gt; å…ƒç´ ï¼Œæºä»£ç ä¸­çš„æ¯ä¸€éƒ¨åˆ†éƒ½æ˜¯ä¸€ä¸ªç‰¹å®šçš„å…ƒç´ ç±»å‹ï¼Œåˆ†åˆ«ä»£è¡¨äº†åŒ…ã€ç±»ã€æ–¹æ³•ç­‰ç­‰ï¼Œå…·ä½“çœ‹ Demoã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;com.example&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// TypeElement&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;// VariableElement&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Foo&lt;/span&gt; &lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;// VariableElement&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;Foo&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{}&lt;/span&gt; &lt;span class="c1"&gt;// ExecuteableElement&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;setA&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="c1"&gt;// ExecuteableElement&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;newA&lt;/span&gt; &lt;span class="c1"&gt;// TypeElement&lt;/span&gt;
    &lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™äº› &lt;code&gt;Element&lt;/code&gt; å…ƒç´ ï¼Œç›¸å½“äº XML ä¸­çš„ DOM æ ‘ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªå…ƒç´ å»è®¿é—®å®ƒçš„çˆ¶å…ƒç´ æˆ–è€…å­å…ƒç´ ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getEnclosingElement&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;// è·å–çˆ¶å…ƒç´ &lt;/span&gt;
&lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getEnclosedElements&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;// è·å–å­å…ƒç´ &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨è§£å¤„ç†å™¨çš„æ•´ä¸ªå¤„ç†è¿‡ç¨‹è·Ÿæ™®é€šçš„ Java ç¨‹åºæ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ€æƒ³å’Œè®¾è®¡æ¨¡å¼ï¼Œå°†ç›¸å…³é€»è¾‘å°è£…åˆ° model ä¸­ï¼Œä½¿å¾—æµç¨‹æ›´æ¸…æ™°ç®€æ´ã€‚åˆ†åˆ«å°†æ³¨è§£çš„æˆå‘˜å˜é‡ã€ç‚¹å‡»æ–¹æ³•å’Œæ•´ä¸ªæ³¨è§£ç±»å°è£…æˆä¸åŒçš„ modelã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BindViewField&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;VariableElement&lt;/span&gt; &lt;span class="n"&gt;mFieldElement&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mResId&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;BindViewField&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Element&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getKind&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;ElementKind&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;FIELD&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
                &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;format&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Only fields can be annotated with @%s&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BindView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getSimpleName&lt;/span&gt;&lt;span class="o"&gt;()));&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;

        &lt;span class="n"&gt;mFieldElement&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VariableElement&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;BindView&lt;/span&gt; &lt;span class="n"&gt;bindView&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mFieldElement&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getAnnotation&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BindView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;mResId&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bindView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;value&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="c1"&gt;// some getter methods&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸»è¦å°±æ˜¯åœ¨åˆå§‹åŒ–æ—¶æ ¡éªŒäº†ä¸€ä¸‹å…ƒç´ ç±»å‹ï¼Œç„¶åè·å–æ³¨è§£çš„å€¼ï¼Œåœ¨æä¾›å‡ ä¸ª get æ–¹æ³•ã€‚&lt;code&gt;OnClickMethod&lt;/code&gt; å°è£…ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AnnotatedClass&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;TypeElement&lt;/span&gt; &lt;span class="n"&gt;mClassElement&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BindViewField&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mFields&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;OnClickMethod&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mMethods&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Elements&lt;/span&gt; &lt;span class="n"&gt;mElementUtils&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;// omit some easy methods &lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;JavaFile&lt;/span&gt; &lt;span class="nf"&gt;generateFinder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

        &lt;span class="c1"&gt;// method inject(final T host, Object source, Provider provider)&lt;/span&gt;
        &lt;span class="n"&gt;MethodSpec&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt; &lt;span class="n"&gt;injectMethodBuilder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MethodSpec&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;methodBuilder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;inject&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addModifiers&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Modifier&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;PUBLIC&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addAnnotation&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Override&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addParameter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TypeName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mClassElement&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;asType&lt;/span&gt;&lt;span class="o"&gt;()),&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;host&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Modifier&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;FINAL&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addParameter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TypeName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;OBJECT&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;source&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addParameter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TypeUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;PROVIDER&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;provider&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BindViewField&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mFields&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;// find views&lt;/span&gt;
            &lt;span class="n"&gt;injectMethodBuilder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addStatement&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;host.$N = ($T)(provider.findView(source, $L))&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getFieldName&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt;
                &lt;span class="n"&gt;ClassName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getFieldType&lt;/span&gt;&lt;span class="o"&gt;()),&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getResId&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mMethods&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;size&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;injectMethodBuilder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addStatement&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;$T listener&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TypeUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ANDROID_ON_CLICK_LISTENER&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;OnClickMethod&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mMethods&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;// declare OnClickListener anonymous class&lt;/span&gt;
            &lt;span class="n"&gt;TypeSpec&lt;/span&gt; &lt;span class="n"&gt;listener&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TypeSpec&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;anonymousClassBuilder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
                &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addSuperinterface&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TypeUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ANDROID_ON_CLICK_LISTENER&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
                &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addMethod&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MethodSpec&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;methodBuilder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;onClick&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
                    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addAnnotation&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Override&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
                    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addModifiers&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Modifier&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;PUBLIC&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
                    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;returns&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TypeName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;VOID&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
                    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addParameter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TypeUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ANDROID_VIEW&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;view&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
                    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addStatement&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;host.$N()&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMethodName&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt;
                    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt;
                &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;injectMethodBuilder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addStatement&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;listener = $L &amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;listener&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ids&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="c1"&gt;// set listeners&lt;/span&gt;
                &lt;span class="n"&gt;injectMethodBuilder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addStatement&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;provider.findView(source, $L).setOnClickListener(listener)&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="c1"&gt;// generate whole class &lt;/span&gt;
        &lt;span class="n"&gt;TypeSpec&lt;/span&gt; &lt;span class="n"&gt;finderClass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TypeSpec&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;classBuilder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mClassElement&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getSimpleName&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$$Finder&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addModifiers&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Modifier&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;PUBLIC&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addSuperinterface&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ParameterizedTypeName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TypeUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;FINDER&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TypeName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mClassElement&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;asType&lt;/span&gt;&lt;span class="o"&gt;())))&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addMethod&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;injectMethodBuilder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt;
            &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

        &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;packageName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mElementUtils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getPackageOf&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mClassElement&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;getQualifiedName&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="c1"&gt;// generate file&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;JavaFile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;packageName&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;finderClass&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;AnnotatedClass&lt;/code&gt; è¡¨ç¤ºä¸€ä¸ªæ³¨è§£ç±»ï¼Œé‡Œé¢æ”¾äº†ä¸¤ä¸ªåˆ—è¡¨ï¼Œåˆ†åˆ«è£…ç€æ³¨è§£çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ã€‚åœ¨ &lt;code&gt;generateFinder()&lt;/code&gt; æ–¹æ³•ä¸­ï¼ŒæŒ‰ç…§ä¸Šä¸€èŠ‚è®¾è®¡çš„æ¨¡æ¿ï¼Œåˆ©ç”¨ &lt;code&gt;JavaPoet&lt;/code&gt; çš„ API ç”Ÿæˆä»£ç ã€‚è¿™éƒ¨åˆ†æ²¡å•¥ç‰¹åˆ«çš„å§¿åŠ¿ï¼Œç…§ç€ &lt;a href="https://github.com/square/javapoet"&gt;JavaPoet æ–‡æ¡£&lt;/a&gt; æ¥å°±å¥½äº†ï¼Œæ–‡æ¡£å†™å¾—å¾ˆç»†è‡´ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦ç”¨åˆ°å¯¹è±¡çš„ç±»å‹ï¼Œæ™®é€šç±»å‹å¯ä»¥ç”¨&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ClassName get(String packageName, String simpleName, String... simpleNames)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¼ å…¥åŒ…åã€ç±»åã€å†…éƒ¨ç±»åï¼Œå°±å¯ä»¥æ‹¿åˆ°æƒ³è¦çš„ç±»å‹äº†ï¼ˆå¯ä»¥å‚è€ƒ é¡¹ç›®ä¸­&lt;code&gt;TypeUtil&lt;/code&gt; ç±»ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨åˆ°æ³›å‹çš„è¯ï¼Œå¯ä»¥ç”¨&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ParameterizedTypeName get(ClassName rawType, TypeName... typeArguments)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¼ å…¥å…·ä½“ç±»å’Œæ³›å‹ç±»å‹å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™äº› model éƒ½ç¡®å®šå¥½äº†ä¹‹åï¼Œ&lt;code&gt;process()&lt;/code&gt; æ–¹æ³•å°±å¾ˆæ¸…çˆ½å•¦ã€‚ä½¿ç”¨ &lt;code&gt;RoundEnvironment&lt;/code&gt; å‚æ•°æ¥æŸ¥è¯¢è¢«ç‰¹å®šæ³¨è§£æ ‡æ³¨çš„å…ƒç´ ï¼Œç„¶åè§£ææˆå…·ä½“çš„ modelï¼Œæœ€åç”Ÿæˆä»£ç è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@AutoService&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Processor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ViewFinderProcesser&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;AbstractProcessor&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;AnnotatedClass&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mAnnotatedClassMap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="nf"&gt;process&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;TypeElement&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;annotations&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RoundEnvironment&lt;/span&gt; &lt;span class="n"&gt;roundEnv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// process() will be called several times&lt;/span&gt;
        &lt;span class="n"&gt;mAnnotatedClassMap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;clear&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

        &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;processBindView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roundEnv&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;processOnClick&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;roundEnv&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMessage&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;// stop process&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AnnotatedClass&lt;/span&gt; &lt;span class="n"&gt;annotatedClass&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mAnnotatedClassMap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;values&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Generating file for %s&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotatedClass&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getFullClassName&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
                &lt;span class="n"&gt;annotatedClass&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;generateFinder&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;writeTo&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mFiler&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Generate file failed, reason: %s&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMessage&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;processBindView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RoundEnvironment&lt;/span&gt; &lt;span class="n"&gt;roundEnv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Element&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;roundEnv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getElementsAnnotatedWith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BindView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;AnnotatedClass&lt;/span&gt; &lt;span class="n"&gt;annotatedClass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;getAnnotatedClass&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;BindViewField&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;BindViewField&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;annotatedClass&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addField&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;processOnClick&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RoundEnvironment&lt;/span&gt; &lt;span class="n"&gt;roundEnv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// same as processBindView()&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;AnnotatedClass&lt;/span&gt; &lt;span class="nf"&gt;getAnnotatedClass&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Element&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;TypeElement&lt;/span&gt; &lt;span class="n"&gt;classElement&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TypeElement&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getEnclosingElement&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;fullClassName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;classElement&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getQualifiedName&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;AnnotatedClass&lt;/span&gt; &lt;span class="n"&gt;annotatedClass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mAnnotatedClassMap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fullClassName&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;annotatedClass&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;annotatedClass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;AnnotatedClass&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;classElement&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mElementUtils&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;mAnnotatedClassMap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fullClassName&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotatedClass&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;annotatedClass&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é¦–å…ˆè§£ææ³¨è§£å…ƒç´ ï¼Œå¹¶æ”¾åˆ°å¯¹åº”çš„æ³¨è§£ç±»å¯¹è±¡ä¸­ï¼Œæœ€åè°ƒç”¨æ–¹æ³•ç”Ÿæˆæ–‡ä»¶ã€‚model çš„ä»£ç ä¸­è¿˜ä¼šåŠ å…¥ä¸€äº›æ ¡éªŒä»£ç ï¼Œæ¥åˆ¤æ–­æ³¨è§£å…ƒç´ æ˜¯å¦åˆç†ï¼Œæ•°æ®æ˜¯å¦æ­£å¸¸ï¼Œç„¶åæŠ›å‡ºå¼‚å¸¸ï¼Œå¤„ç†å™¨æ¥æ”¶åˆ°ä¹‹åå¯ä»¥æ‰“å°å‡ºé”™è¯¯æç¤ºï¼Œç„¶åç›´æ¥è¿”å› &lt;code&gt;true&lt;/code&gt; æ¥ç»“æŸå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;è‡³æ­¤ï¼Œæ³¨è§£å¤„ç†å™¨ä¹ŸåŸºæœ¬å®Œæˆäº†ï¼Œå…·ä½“ç»†èŠ‚å‚è€ƒé¡¹ç›®ä»£ç ã€‚&lt;/p&gt;
&lt;h3&gt;å®é™…é¡¹ç›®ä½¿ç”¨&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ›å»º module &lt;code&gt;sample&lt;/code&gt;ï¼Œæ™®é€šçš„ Android moduleï¼Œæ¥æ¼”ç¤º &lt;code&gt;ViewFinder&lt;/code&gt; çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨æ•´ä¸ªé¡¹ç›®ä¸‹çš„ &lt;code&gt;build.gradle&lt;/code&gt; ä¸­æ·»åŠ &lt;/p&gt;
&lt;p&gt;&lt;code&gt;classpath 'com.neenbedankt.gradle.plugins:android-apt:1.8'&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç„¶ååœ¨ &lt;code&gt;sample&lt;/code&gt; module ä¸‹çš„ &lt;code&gt;build.gradle&lt;/code&gt; ä¸­æ·»åŠ &lt;/p&gt;
&lt;p&gt;&lt;code&gt;apply plugin: 'com.neenbedankt.android-apt'&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åŒæ—¶æ·»åŠ ä¾èµ–ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;compile&lt;/span&gt; &lt;span class="nf"&gt;project&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;:viewfinder-annotation&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;compile&lt;/span&gt; &lt;span class="nf"&gt;project&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;:viewfinder&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;apt&lt;/span&gt; &lt;span class="nf"&gt;project&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;:viewfinder-compiler&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åéšä¾¿åˆ›å»ºä¸ªå¸ƒå±€ï¼Œéšä¾¿æ·»åŠ å‡ ä¸ªæ§ä»¶ï¼Œå°±èƒ½ä½“éªŒæ³¨è§£å•¦ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MainActivity&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;AppCompatActivity&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nd"&gt;@BindView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;tv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;TextView&lt;/span&gt; &lt;span class="n"&gt;mTextView&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nd"&gt;@BindView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;btn&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Button&lt;/span&gt; &lt;span class="n"&gt;mButton&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nd"&gt;@BindView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;et&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;EditText&lt;/span&gt; &lt;span class="n"&gt;mEditText&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="nd"&gt;@OnClick&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;btn&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onButtonClick&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Toast&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;makeText&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;onButtonClick&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Toast&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;LENGTH_SHORT&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;show&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="nd"&gt;@OnClick&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;tv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onTextClick&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Toast&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;makeText&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;onTextClick&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Toast&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;LENGTH_SHORT&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;show&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onCreate&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Bundle&lt;/span&gt; &lt;span class="n"&gt;savedInstanceState&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;onCreate&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;savedInstanceState&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;setContentView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;layout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;activity_main&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;ViewFinder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;inject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªæ—¶å€™ build ä¸€ä¸‹é¡¹ç›®ï¼Œå°±èƒ½çœ‹åˆ°ç”Ÿæˆçš„ &lt;code&gt;MainActivity$$Finder&lt;/code&gt; ç±»äº†ï¼Œå†è¿è¡Œé¡¹ç›®å°±è·‘èµ·æ¥äº†ã€‚æ¯æ¬¡æ”¹å˜æ³¨è§£ä¹‹åï¼Œbuild ä¸€ä¸‹é¡¹ç›®å°±å¥½å•¦ã€‚&lt;/p&gt;
&lt;p&gt;all done ~&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé¡¹ç›®ä¹Ÿå°±æ˜¯ä¸ªç©å…·çº§çš„ APT é¡¹ç›®ï¼Œå€Ÿæ­¤æ¥å­¦ä¹ å¦‚ä½•ç¼–å†™ APT é¡¹ç›®ã€‚æ„Ÿè§‰ APT é¡¹ç›®æ›´å¤šåœ°æ˜¯è€ƒè™‘å¦‚ä½•å»è®¾è®¡æ¶æ„ï¼Œç±»ä¹‹é—´å¦‚ä½•è°ƒç”¨ï¼Œéœ€è¦ç”Ÿæˆä»€ä¹ˆæ ·çš„ä»£ç ï¼Œæä¾›æ€æ ·çš„ API å»è°ƒç”¨ã€‚æœ€åæ‰æ˜¯åˆ©ç”¨æ³¨è§£å¤„ç†å™¨å»è§£ææ³¨è§£ï¼Œç„¶åç”¨ JavaPoet å»ç”Ÿæˆå…·ä½“çš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;æ€è·¯æ¯”å®ç°æ›´é‡è¦ï¼Œè®¾è®¡æ¯”ä»£ç æ›´å·§å¦™ã€‚&lt;/p&gt;
&lt;h3&gt;å‚è€ƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://qiushao.net/2015/07/07/Annotation-Processing-Tool%E8%AF%A6%E8%A7%A3/"&gt;Annotation-Processing-Toolè¯¦è§£&lt;/a&gt; ï¼ˆå¤§åŠ›æ¨èï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blog.csdn.net/lmj623565791/article/details/51931859"&gt;Android å¦‚ä½•ç¼–å†™åŸºäºç¼–è¯‘æ—¶æ³¨è§£çš„é¡¹ç›®&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/square/javapoet"&gt;JavaPoet æ–‡æ¡£&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/JakeWharton/butterknife"&gt;ButterKnife&lt;/a&gt; ï¼ˆä»£ç ç»“æ„è®¾è®¡å¾ˆæ£’ï¼‰&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Sat, 06 Aug 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-08-06:articles/2016/08/06/use-apt-in-android/</guid></item><item><title>RxBus çš„ç®€å•å®ç°</title><link>http://brucezz.github.io/articles/2016/06/02/a-simple-rxbus-implementation/</link><description>&lt;p&gt;ä»Šå¤©å†™ä»£ç æ­£å¥½æƒ³åˆ°è¦ç”¨äº‹ä»¶æ€»çº¿ï¼Œå…ˆå‰éƒ½æ˜¯ä½¿ç”¨ Square çš„Â Otto æˆ–è€… GreenRobot çš„ EventBus ï¼Œå¬è¯´ RxJava èƒ½å¤Ÿè½»æ˜“å®ç°ä¸€ä¸ª Busï¼Œæ‰€ä»¥å°±æ¥ç ”ç©¶ç ”ç©¶è¿™ä¸ªè½¦æ€ä¹ˆå¼€~&lt;/p&gt;
&lt;p&gt;&lt;img alt="æ²¡æ—¶é—´è§£é‡Šäº†ï¼Œå¿«ä¸Šè½¦ï¼" src="/images/no-time-to-explain.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;è¿™è¾†è½¦éœ€è¦æœ‰ä¸€ä¸‹åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®¢é˜…è€…èƒ½å¤Ÿè®¢é˜…æŸç§äº‹ä»¶ Event&lt;/li&gt;
&lt;li&gt;å‘å¸ƒæŸç§ Event æ—¶ï¼Œè¯¥äº‹ä»¶çš„è®¢é˜…è€…ä»¬èƒ½å¤ŸåŠæ—¶å“åº”&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ RxJava é‡Œæœ‰ä¸€ä¸ªå¯¹è±¡ Subjectï¼Œæ—¢æ˜¯ Observable åˆæ˜¯ Observerï¼Œå¯ä»¥æŠŠ Subject ç†è§£æˆä¸€ä¸ªç®¡é“æˆ–è€…è½¬å‘å™¨ï¼Œæ•°æ®ä»ä¸€ç«¯è¾“å…¥ï¼Œç„¶åä»å¦ä¸€ç«¯è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;Subject æœ‰å¥½å‡ ç§ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨æœ€ç®€å•çš„ &lt;code&gt;PublishSubject&lt;/code&gt;ã€‚ä¸€æ—¦æ•°æ®ä»ä¸€ç«¯ä¼ å…¥ï¼Œç»“æœä¼šé‡Œç«‹åˆ»ä»å¦ä¸€ç«¯è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºå…è®¸è®¢é˜…è€…è®¢é˜…æŸä¸€ç§ç±»å‹çš„ Eventï¼Œæ‰€ä»¥æ³¨å†Œè®¢é˜…çš„æ—¶å€™éœ€è¦ä¸€ä¸ª Class å¯¹è±¡å¯¹äº‹ä»¶è¿›è¡Œè¿‡æ»¤ã€‚&lt;/p&gt;
&lt;h3&gt;ç®€å•å®ç°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RxBus&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;volatile&lt;/span&gt; &lt;span class="n"&gt;RxBus&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Subject&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;BUS&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="nf"&gt;RxBus&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;BUS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;SerializedSubject&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;(&lt;/span&gt;&lt;span class="n"&gt;PublishSubject&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;RxBus&lt;/span&gt; &lt;span class="nf"&gt;getDefault&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="kd"&gt;synchronized&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RxBus&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;instance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;RxBus&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
                &lt;span class="o"&gt;}&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;post&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;BUS&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;onNext&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Observable&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;toObserverable&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;eventType&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// ofType = filter + cast&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;BUS&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ofType&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eventType&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ï¼ŒRxBus ä½¿ç”¨äº†å•ä¾‹æ¨¡å¼ï¼Œç¡®ä¿åº”ç”¨ä¸­åªæœ‰ä¸€è¾†è½¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;post&lt;/code&gt; æ–¹æ³•å‘å¸ƒä¸€ä¸ª Event å¯¹è±¡ç»™ busï¼Œç„¶åç”± bus è½¬å‘ç»™è®¢é˜…è€…ä»¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;toObserverable&lt;/code&gt; æ–¹æ³•èƒ½å¤Ÿè·å¾—ä¸€ä¸ªåŒ…å«ç›®æ ‡äº‹ä»¶çš„ Observableï¼Œè®¢é˜…è€…å¯¹å…¶è®¢é˜…å³å¯å“åº”ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bus.ofType()&lt;/code&gt; ç­‰æ•ˆäº  &lt;code&gt;bus.filter(eventType::isInstance).cast(eventType)&lt;/code&gt; ï¼Œå³å…ˆè¿‡æ»¤äº‹ä»¶ç±»å‹ï¼Œç„¶åå‘å°„ç»™è®¢é˜…è€…ã€‚&lt;/p&gt;
&lt;h3&gt;å¼€è½¦å•¦&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RxBusActivity&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;AppCompatActivity&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;CompositeSubscription&lt;/span&gt; &lt;span class="n"&gt;allSubscription&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CompositeSubscription&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;Button&lt;/span&gt; &lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onCreate&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Nullable&lt;/span&gt; &lt;span class="n"&gt;Bundle&lt;/span&gt; &lt;span class="n"&gt;savedInstanceState&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;onCreate&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;savedInstanceState&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;setContentView&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;layout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;activity_main&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;send&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Button&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;findViewById&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;send&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setOnClickListener&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
                &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;RxBus&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDefault&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;post&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OneEvent&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;hello bus&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)));&lt;/span&gt;
        &lt;span class="n"&gt;allSubscription&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RxBus&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDefault&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
                &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toObserverable&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;OneEvent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;subscribe&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;response&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;OneEvent&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ToastUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;show&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="nd"&gt;@Override&lt;/span&gt;
    &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;onDestroy&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;onDestroy&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;allSubscription&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;allSubscription&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isUnsubscribed&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt;
            &lt;span class="n"&gt;allSubscription&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;unsubscribe&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;OneEvent&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// some data you need ...&lt;/span&gt;
        &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;OneEvent&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç‚¹å‡»æŒ‰é’®ï¼Œå‘é€  &lt;code&gt;OneEvent&lt;/code&gt; äº‹ä»¶ï¼Œç„¶åå“åº”æ­¤äº‹ä»¶ï¼Œå‘å‡º Toast ~&lt;/p&gt;
&lt;p&gt;é€šè¿‡å¤šæ¬¡è°ƒç”¨ &lt;code&gt;toObserverable()&lt;/code&gt; æ–¹æ³•å¯ä»¥è®¢é˜…å¤šç§äº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å° tip&lt;/strong&gt; : &lt;code&gt;CompositeSubscription&lt;/code&gt; å¯ä»¥æŠŠ Subscription æ”¶é›†åˆ°ä¸€èµ·ï¼Œæ–¹ä¾¿ Activity é”€æ¯æ—¶å–æ¶ˆè®¢é˜…ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚&lt;/p&gt;
&lt;h3&gt;Reference&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://drakeet.me/rxbus"&gt;ç¿»è¯‘ï¼šé€šè¿‡ RxJava å®ç°ä¸€ä¸ª Event Bus â€“ RxBus | Drakeetçš„ä¸ªäººåšå®¢&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.jianshu.com/p/ca090f6e2fe2/"&gt;ç”¨RxJavaå®ç°äº‹ä»¶æ€»çº¿(Event Bus) - ç®€ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Thu, 02 Jun 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-06-02:articles/2016/06/02/a-simple-rxbus-implementation/</guid></item><item><title>åœ¨ CentOS äº‘æœåŠ¡å™¨ä¸Šä½¿ç”¨ Nginx + uWSGI éƒ¨ç½² Flask ç¨‹åº</title><link>http://brucezz.github.io/articles/2016/04/18/nginx-uwsgi-flask-deploy-on-centos/</link><description>&lt;h2&gt;0x00 è¦å¹²å•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¥½ä¹…æ²¡å†™åšå®¢äº†ï¼Œæœ€è¿‘è¢«ä¸¤ä¸ªæ¯•è®¾æŠ˜è…¾æˆç‹—ï¼Œè¿™ä¸¤å¤©éƒ¨ç½²ç¨‹åºè¸©äº†å¾ˆå¤šå‘é•¿äº†ç‚¹å§¿åŠ¿ï¼Œè®°å½•ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æ¯•è®¾éœ€è¦è‡ªå·±åšä¸€ä¸ªåç«¯ç¨‹åºï¼Œä¸ºæˆ‘çš„ APP æä¾› API æ•°æ®æ”¯æŒã€‚æˆ‘å°±ç”¨ Flask å†™äº†ä¸ªç®€å•çš„ç¨‹åºï¼Œåœ¨æœ¬åœ°è·‘èµ·æ¥äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šã€‚æˆ‘åŸä»¥ä¸ºæŠŠä»£ç æ”¾ä¸Šå»ï¼Œç„¶å &lt;code&gt;python manage.py&lt;/code&gt; å°± ok äº†ï¼ŒåŸæ¥æ˜¯æˆ‘å¤ª naive äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;Flask è‡ªå¸¦çš„ server æ€§èƒ½å¤ªå·®ï¼Œåªå¤Ÿè°ƒè¯•ç”¨çš„ï¼Œé‚£ä¹ˆæˆ‘åªå¥½å¦æ‰¾é€”å¾„äº†ã€‚æœç´¢ä¸€ç•ªï¼ŒNginx + uWSGI + Flask çš„å¥—è·¯å¤§å®¶ç”¨çš„æŒºå¤šçš„ï¼Œé‚£æˆ‘ä¹Ÿå°±é€‰æ‹©è¿™å¥—æ–¹æ¡ˆå•¦ã€‚&lt;/p&gt;
&lt;h2&gt;0x01 Nginx/uWSGI æ˜¯ä»€ä¹ˆ&lt;/h2&gt;
&lt;p&gt;&lt;img alt="wsgi-server" src="/images/wsgi-server.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://nginx.org/en/"&gt;Nginx&lt;/a&gt; æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½çš„ Web å’Œ åå‘ä»£ç† æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;WSGI, Web æœåŠ¡å™¨ç½‘å…³æ¥å£ï¼ˆPython Web Server Gateway Interface)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="https://uwsgi-docs.readthedocs.org/en/latest/"&gt;uWSGI&lt;/a&gt;ï¼Œä¸€ä¸ªå®ç°äº† WSGIï¼Œuwsgiï¼Œhttp ç­‰åè®®çš„æœåŠ¡å™¨ï¼Œä¸ nginx åœ¨ä¸€ä¸ªå±‚æ¬¡, æä¾›ç½‘å…³æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="http://docs.jinkan.org/docs/flask/"&gt;Flask&lt;/a&gt; æ˜¯ä¸€ä¸ªä½¿ç”¨ Python ç¼–å†™çš„è½»é‡çº§ Web åº”ç”¨æ¡†æ¶ã€‚&lt;/p&gt;
&lt;h2&gt;0x02 ç”¨ Nginx/uWSGI éƒ¨ç½² Flask&lt;/h2&gt;
&lt;h3&gt;1.ç¯å¢ƒ&lt;/h3&gt;
&lt;p&gt;CentOS 7.2, Python / 2.7.5, uwsgi / 2.0.12, nginx / 1.6.3&lt;/p&gt;
&lt;h3&gt;2.é…ç½® Python è™šæ‹Ÿç¯å¢ƒå’Œé¡¹ç›®ä¾èµ–&lt;/h3&gt;
&lt;p&gt;ç”±äºåº”ç”¨ä¼šæ·»åŠ å¤šç§ä¾èµ–ï¼Œä¸ºäº†é¿å…æ±¡æŸ“é»˜è®¤ Python ç¯å¢ƒæ–‡ä»¶ï¼Œä½¿ç”¨ Python è™šæ‹Ÿç¯å¢ƒå¯ä»¥ç‹¬ç«‹ä¸åŒåº”ç”¨çš„ç¯å¢ƒ&lt;/p&gt;
&lt;p&gt;å®‰è£… &lt;code&gt;virtualenv&lt;/code&gt; &amp;gt; &lt;code&gt;pip install virtualenv&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åˆ›å»ºè™šæ‹Ÿå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;cd /home/bruce/web
virtualenv ENV
./ENV/bin/activate
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ &lt;code&gt;deactivate&lt;/code&gt; å¯ä»¥é€€å‡ºè™šæ‹Ÿç¯å¢ƒ&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;pip&lt;/code&gt; å®‰è£…é¡¹ç›®ä¾èµ– &amp;gt; &lt;code&gt;pip install flask&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…é€šè¿‡ &lt;code&gt;requirements.txt&lt;/code&gt; ä¾èµ–æ¸…å•ï¼Œå®Œæˆæ‰¹é‡å®‰è£…&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pip install -r requirements.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆä¾èµ–æ¸…å•å¯ä»¥ç”¨å‘½ä»¤&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pip freeze &amp;gt; requirements.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æå®šï¼&lt;/p&gt;
&lt;h3&gt;3.éƒ¨ç½² Flask ç¨‹åº&lt;/h3&gt;
&lt;p&gt;åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼Œæ”¾ç½® Flask ç¨‹åºï¼Œæœ€ç®€å•çš„ &lt;code&gt;hello.py&lt;/code&gt; å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nd"&gt;@app.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello Python&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‰§è¡Œ &lt;code&gt;python hello.py&lt;/code&gt; ä¼šçœ‹åˆ°&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;* Running on http://127.0.0.1:5000/&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ · Flask ç¨‹åºå°±è·‘èµ·æ¥å•¦~&lt;/p&gt;
&lt;h3&gt;4.é…ç½® uWSGI æœåŠ¡å™¨ç½‘å…³æœåŠ¡&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ pip å®‰è£… &amp;gt; &lt;code&gt;pip install uwsgi&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨åº”ç”¨&lt;/p&gt;
&lt;p&gt;&lt;code&gt;uwsgi -s /tmp/uwsgi.sock --module hello --callable app&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;uwsgi -s /tmp/uwsgi.sock -w hello&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½å‚æ•°å¯åŠ¨ï¼š&lt;/p&gt;
&lt;p&gt;åˆ›å»º uwsgi é…ç½®æ–‡ä»¶ &lt;code&gt;vim /etc/uwsgi/apps-enabled/hello.ini&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;[uwsgi]&lt;/span&gt;
&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;å¼€å¯ä¸»çº¿ç¨‹&lt;/span&gt;
&lt;span class="na"&gt;master&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;true&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;é¡¹ç›®ç›®å½•&lt;/span&gt;
&lt;span class="na"&gt;base&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/home/bruce/web&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;ç§»åŠ¨åˆ°é¡¹ç›®ç›®å½•&lt;/span&gt; &lt;span class="err"&gt;cd&lt;/span&gt;
&lt;span class="na"&gt;chdir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;%(base)&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;æœ¬åœ°çš„ipå’Œç«¯å£&lt;/span&gt;
&lt;span class="na"&gt;socket&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;127.0.0.1:5000&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;Python&lt;/span&gt; &lt;span class="err"&gt;è™šæ‹Ÿç¯å¢ƒç›®å½•&lt;/span&gt;
&lt;span class="na"&gt;home&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;%(base)/ENV&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;ç¨‹åºå¯åŠ¨æ–‡ä»¶&lt;/span&gt;
&lt;span class="na"&gt;wsgi-file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;hello.py&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;é¡¹ç›®ä¸­å¼•ç”¨&lt;/span&gt; &lt;span class="err"&gt;flask&lt;/span&gt; &lt;span class="err"&gt;å®ä¾‹çš„å˜é‡å&lt;/span&gt;
&lt;span class="na"&gt;callable&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;app&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;å¤„ç†å™¨æ•°&lt;/span&gt;
&lt;span class="na"&gt;processes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;2&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;çº¿ç¨‹æ•°&lt;/span&gt;
&lt;span class="na"&gt;threads&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;4&lt;/span&gt;

&lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;è·å–uwsgiç»Ÿè®¡ä¿¡æ¯çš„æœåŠ¡åœ°å€&lt;/span&gt;
&lt;span class="na"&gt;stats&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;127.0.0.1:9191&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¿å­˜é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ &lt;code&gt;uwsgi -i /etc/uwsgi/apps-enabled/hello.ini&lt;/code&gt;ï¼Œæ¥å¯åŠ¨ uwsgiã€‚&lt;/p&gt;
&lt;h3&gt;5.å®‰è£…é…ç½® Nginx ä»£ç†&lt;/h3&gt;
&lt;p&gt;å…ˆæ·»åŠ è½¯ä»¶æºï¼Œç„¶åå®‰è£… Nginx&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo su -c &amp;#39;rpm -Uvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm&amp;#39;

sudo yum install -y nginx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ &lt;code&gt;/etc/nginx/ngixn.conf&lt;/code&gt; æ–‡ä»¶çš„ &lt;code&gt;http&lt;/code&gt; éƒ¨åˆ†æ·»åŠ ä¸€æ¡ include å†…å®¹ï¼Œå³æœ€åä¸€è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    include /etc/nginx/sites-enabled/*;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åˆ›å»ºé…ç½®æ–‡ä»¶ &lt;code&gt;vim /etc/nginx/sites-enabled/hello.conf&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;Running&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;
    &lt;span class="n"&gt;listen&lt;/span&gt; &lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;æœåŠ¡å™¨&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt; &lt;span class="err"&gt;æˆ–è€…åŸŸå&lt;/span&gt;
    &lt;span class="n"&gt;server_name&lt;/span&gt; &lt;span class="n"&gt;xxx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;Proxying&lt;/span&gt; &lt;span class="n"&gt;connections&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;application&lt;/span&gt; &lt;span class="n"&gt;servers&lt;/span&gt;
    &lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;

        &lt;span class="n"&gt;include&lt;/span&gt;            &lt;span class="n"&gt;uwsgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;uwsgi_pass&lt;/span&gt;         &lt;span class="m"&gt;127&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="err"&gt;å’Œ&lt;/span&gt; &lt;span class="n"&gt;uWSGI&lt;/span&gt; &lt;span class="err"&gt;é…ç½®æ–‡ä»¶ä¸­çš„&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="err"&gt;ç«¯å£ä¸€è‡´&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨å‘½ä»¤ &lt;code&gt;sudo nginx -t&lt;/code&gt; æµ‹è¯•é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœå‡ºç°ä¸‹é¢çš„æ–‡å­—ï¼Œæµ‹è¯•å°±æ˜¯é€šè¿‡çš„å•¦ï¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;nginx: the configuration file /etc/nginx/nginx.conf syntax is ok&lt;/p&gt;
&lt;p&gt;nginx: configuration file /etc/nginx/nginx.conf test is successful&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶åä½¿ç”¨ &lt;code&gt;sudo nginx -s reload&lt;/code&gt; å¯ä»¥å¹³æ»‘é‡å¯æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å°±å¯ä»¥é€šè¿‡åŸŸåæˆ–ipè®¿é—®é¡¹ç›®äº†ï¼Œwebçš„è¯·æ±‚ä¼šè½¬å‘åˆ° 5000 ç«¯å£ã€‚&lt;/p&gt;
&lt;h2&gt;0x03 è®¾ç½®è‡ªå¯åŠ¨&lt;/h2&gt;
&lt;p&gt;ç”±äºè¿™äº›æœåŠ¡æ˜¯æ”¾åœ¨æœåŠ¡å™¨ä¸Šé•¿æœŸè¿è¡Œçš„ï¼Œæœ€å¥½å°† Nginx å’Œ uWSGI é…ç½®ä¸ºç³»ç»ŸæœåŠ¡ï¼Œå¹¶ä¸”å¼€æœºè‡ªå¯åŠ¨ã€‚&lt;/p&gt;
&lt;h3&gt;1.é…ç½® Nginx å¼€å¯å¯åŠ¨&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;sudo vim /etc/init.d/nginx&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å†™å…¥ä¸‹åˆ—å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;# chkconfig: - 85 15&lt;/span&gt;
&lt;span class="nv"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/sbin/nginx
&lt;span class="nv"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/etc/nginx/nginx.conf

&lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nv"&gt;$1&lt;/span&gt; in
    start&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;Starting Nginx&amp;quot;&lt;/span&gt;
        $nginx -c &lt;span class="nv"&gt;$c&lt;/span&gt;onf
        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;

    stop&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;Stopping Nginx&amp;quot;&lt;/span&gt;
        $nginx -s stop
        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;

    &lt;span class="nb"&gt;test&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
        $nginx -t -c &lt;span class="nv"&gt;$c&lt;/span&gt;onf
    &lt;span class="p"&gt;;;&lt;/span&gt;

    reload&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;Reloading Nginx&amp;quot;&lt;/span&gt;
        $nginx -s reload
        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;

    restart&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nv"&gt;$0&lt;/span&gt; stop
        &lt;span class="nv"&gt;$0&lt;/span&gt; start
    &lt;span class="p"&gt;;;&lt;/span&gt;

    show&lt;span class="o"&gt;)&lt;/span&gt;
        ps -aux&lt;span class="p"&gt;|&lt;/span&gt;grep nginx
    &lt;span class="p"&gt;;;&lt;/span&gt;

    *&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;Usage: &lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt; {start|restart|reload|stop|test|show}&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;

&lt;span class="k"&gt;esac&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç²—ç•¥åœ°çœ‹ä¸€ä¸‹ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å‘½ä»¤åç¬¬ä¸€ä¸ªå‚æ•°ï¼Œcase åˆ¤æ–­ç›¸åº”çš„æ“ä½œ(start, stop, test, reload, restart, show )ã€‚&lt;/p&gt;
&lt;p&gt;ç»™è„šæœ¬æ·»åŠ å¯æ‰§è¡Œå±æ€§ &lt;code&gt;sudo chmod +x /etc/init.d/nginx&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ·»åŠ ä¸ºç³»ç»ŸæœåŠ¡ï¼ˆå¼€æœºè‡ªå¯åŠ¨ï¼‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo chkconfig --add nginx
sudo chkconfig nginx on
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯åŠ¨ Nginx æœåŠ¡&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo service nginx start&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;2.é…ç½® uWSGI å¼€æœºå¯åŠ¨&lt;/h3&gt;
&lt;p&gt;å’Œ nginx ç±»ä¼¼çš„æ“ä½œï¼š&lt;/p&gt;
&lt;p&gt;åˆ›å»ºè„šæœ¬&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo vim /etc/init.d/uwsgi&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å†™å…¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;# chkconfig: - 85 15&lt;/span&gt;
&lt;span class="nv"&gt;uwsgi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/bin/uwsgi
&lt;span class="nv"&gt;hello_conf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/etc/uwsgi/apps-enabled/hello.ini

&lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nv"&gt;$1&lt;/span&gt; in
    start&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;Starting uWsgi&amp;quot;&lt;/span&gt;
        nohup $uwsgi -i $hello_conf &amp;gt;/var/log/uwsgi/hello.log 2&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;

    stop&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;Stopping uWsgi&amp;quot;&lt;/span&gt;
        killall -9 uwsgi
        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; done&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;

    restart&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nv"&gt;$0&lt;/span&gt; stop
        &lt;span class="nv"&gt;$0&lt;/span&gt; start
    &lt;span class="p"&gt;;;&lt;/span&gt;

    show&lt;span class="o"&gt;)&lt;/span&gt;
        ps -ef&lt;span class="p"&gt;|&lt;/span&gt;grep uwsgi
    &lt;span class="p"&gt;;;&lt;/span&gt;

    *&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;Usage: &lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt; {start|restart|stop|show}&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;

&lt;span class="k"&gt;esac&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ·»åŠ å¯æ‰§è¡Œå±æ€§&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo chmod +x /etc/init.d/uwsgi&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ·»åŠ ä¸ºç³»ç»ŸæœåŠ¡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo chkconfig --add uwsgi
sudo chkconfig uwsgi on
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯åŠ¨ uWSGI æœåŠ¡&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo service uwsgi start&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ³¨ï¼šè„šæœ¬å¼€å¤´è¦å†™ä¸Š &lt;code&gt;# chkconfig: - 85 15&lt;/code&gt; ï¼Œä¸ç„¶æ— æ³•æ·»åŠ ä¸ºç³»ç»ŸæœåŠ¡ï¼ˆç½‘ä¸Šæœ‰çš„ä»£ç å°‘äº†è¿™å¥è¯ï¼‰ã€‚&lt;/p&gt;
&lt;h2&gt;0x04 å°é¢˜æ™®ä¸(tips) â•°(&lt;em&gt;Â°â–½Â°&lt;/em&gt;)â•¯&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ç†Ÿç»ƒæŒæ¡ vi/vim è¯»å†™ä¿å­˜æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;æ›´æ”¹ Nginx é…ç½®ä¹‹åï¼Œä½¿ç”¨ &lt;code&gt;sudo service nginx test&lt;/code&gt; æµ‹è¯•&lt;/li&gt;
&lt;li&gt;æµ‹è¯•é€šè¿‡ Nginx é…ç½®ä¹‹åï¼Œä½¿ç”¨ &lt;code&gt;sudo service nginx reload&lt;/code&gt; å¹³æ»‘é‡å¯æœåŠ¡&lt;/li&gt;
&lt;li&gt;å¸¸æŸ¥ logï¼Œæœ‰ bug ä¸€èˆ¬åœ¨æ—¥å¿—æ–‡ä»¶ä¸­ä¼šæœ‰æŠ¥é”™&lt;/li&gt;
&lt;li&gt;Nginx åœ¨ &lt;code&gt;/var/log/nginx&lt;/code&gt; ç›®å½•ä¸‹æœ‰ &lt;code&gt;access.log&lt;/code&gt; å’Œ &lt;code&gt;error.log&lt;/code&gt; ä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;uWSGI åœ¨ &lt;code&gt;/var/log/uwsgi&lt;/code&gt; ç›®å½•ä¸‹æœ‰é¡¹ç›®å¯¹åº”æ—¥å¿—&lt;/li&gt;
&lt;li&gt;Flask ç¨‹åºå¯ä»¥è‡ªå·±ä¿å­˜æ—¥å¿—&lt;/li&gt;
&lt;li&gt;æ”¹é…ç½®æ–‡ä»¶ä»€ä¹ˆçš„ï¼Œæœ€å¥½å¤‡ä¸ªä»½ï¼Œå…å¾—æ”¹æŒ‚æ‰äº†ä¸€è„¸æ‡µé€¼Ê˜ÊšÊ˜ï¼Œä¸è¦é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„ã€‚ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨ &lt;code&gt;ps -ef | grep uwsgi&lt;/code&gt; å¯ä»¥æŸ¥çœ‹å½“å‰ uwsgi çš„è¿›ç¨‹ï¼Œå¿…è¦æ—¶èƒ½æ ¹æ® pid æŠŠå®ƒ kill æ‰ã€‚nginx åŒç†&lt;/li&gt;
&lt;li&gt;å¾…ç»­ ...&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Reference&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://sagerblog.github.io/blog/2013/01/15/linux-nginx-uwsgi/"&gt;Linuxé…ç½®Nginx+uWsgiç¯å¢ƒ - SagerXiao's Blog&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://sagerblog.github.io/blog/2013/01/15/linux-service-auto-startup/"&gt;é…ç½®Nginxå’ŒuWsigæœåŠ¡å¼€æœºè‡ªåŠ¨å¯åŠ¨ - SagerXiao's Blog&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://fedepot.com/zai-centos-shang-shi-yong-nginx/"&gt;åœ¨ CentOS ä¸Šä½¿ç”¨ Nginx/uWSGI éƒ¨ç½² Flask ç½‘ç«™åº”ç”¨&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Mon, 18 Apr 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-04-18:articles/2016/04/18/nginx-uwsgi-flask-deploy-on-centos/</guid></item><item><title>LeanCloud äº‘å¼•æ“åˆä½“éªŒ</title><link>http://brucezz.github.io/articles/2016/03/05/start-with-leanengine/</link><description>&lt;p&gt;ä¹‹å‰æ¥è§¦è¿‡ &lt;a href="https://leancloud.cn"&gt;LeanCloud&lt;/a&gt;ï¼Œä¸€ç›´æŠŠå®ƒå½“åšæ˜¯ä¸ºç§»åŠ¨ç«¯ç¨‹åºå‘˜æä¾›çš„ä¸€ç§åç«¯æ”¯æŒæœåŠ¡ï¼Œè®©æˆ‘ä»¬å…å»äº†ç¹ççš„åå°å¼€å‘å·¥ä½œï¼Œé€šè¿‡é›†æˆ SDK å°±å¯ä»¥ç›´æ¥å®ç°äº‘ç«¯æ•°æ®å­˜å‚¨ç­‰åŠŸèƒ½ã€‚æ¯”å¦‚ï¼Œæˆ‘åœ¨æœ¬åœ°ç”¨ Python å†™äº†ä¸€ä¸ªçˆ¬è™«ï¼Œç„¶åè·å–åˆ°ä¸€ç³»åˆ—çš„æ•°æ®ï¼Œä¿å­˜åˆ° Leancloud äº‘ç«¯ï¼Œå†ä» App ä¸Šè·å–äº‘ç«¯æ•°æ®ï¼Œå®ç°æ•°æ®çš„è·å–ä¸å±•ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;è¿™å‡ å¤©æˆ‘åˆæœ‰ä¸€ä¸ªæ–°çš„æƒ³æ³•ï¼Œä¹‹å‰äº‘ç«¯æ•°æ®ä»…ä»…æ˜¯æä¾›ç»™è‡ªå·±çš„ App ä½¿ç”¨ï¼Œå¹¶ä¸”è¿˜éœ€è¦é…ç½® App ID/Key å’Œé›†æˆ SDKã€‚å¦‚æœæˆ‘æƒ³æŠŠæ•°æ®æä¾›ç»™åˆ«äººä½¿ç”¨çš„è¯ï¼Œè¿™æ ·æ“ä½œå®åœ¨æ˜¯ä¸æ–¹ä¾¿ï¼Œè€Œä¸”æä¾› App ID ç»™åˆ«äººä¼šä½¿å¾—è‡ªå·±çš„æ•°æ®ä¹Ÿä¸å®‰å…¨ ã€‚ç„¶åå°±å‘ç°äº† LeanCloud æœ‰ä¸€é¡¹åŠŸèƒ½â€”â€”äº‘å¼•æ“ï¼Œ&lt;a href="https://leancloud.cn/docs/leanengine_guide-python.html"&gt;å®˜ç½‘ä»‹ç»&lt;/a&gt;å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;äº‘å¼•æ“å…è®¸ä½ ç¼–å†™ JavaScript æˆ–è€… Python ä»£ç ï¼Œå¹¶éƒ¨ç½²åˆ°æˆ‘ä»¬çš„äº‘ç«¯ï¼Œé€šè¿‡æ‹¦æˆª save è¯·æ±‚ï¼Œåœ¨ä¿å­˜å¯¹è±¡ä¹‹å‰æˆ–ä¹‹ååšä¸€äº›äº‹æƒ…ï¼›ä½ å¯ä»¥è‡ªå®šä¹‰ä¸šåŠ¡å‡½æ•°ï¼Œå¹¶é€šè¿‡ SDK è°ƒç”¨ï¼›ä½ è¿˜å¯ä»¥è°ƒç”¨éƒ¨åˆ†ç¬¬ä¸‰æ–¹åº“æ¥å®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œç”šè‡³è¿˜å¯ä»¥å°†æ•´ä¸ªç½‘ç«™æ¶è®¾åœ¨äº‘å¼•æ“ä¹‹ä¸Šï¼Œæˆ‘ä»¬æä¾›äº†ç½‘ç«™æ‰˜ç®¡æœåŠ¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åœ¨ LeanCloud äº‘ç«¯éƒ¨ç½²æˆ‘è‡ªå·±çš„ Python ä»£ç ï¼Œé‚£å°±å¯ä»¥åœ¨äº‘ç«¯è·‘ä¸€ä¸ª Web ç¨‹åºæä¾›æˆ‘ä»¬è‡ªå®šä¹‰çš„ API æœåŠ¡ï¼Œç®€å•æ˜“ç”¨çš„ &lt;a href="http://flask.pocoo.org/"&gt;Flask&lt;/a&gt; æ¡†æ¶å†å¥½ä¸è¿‡å•¦ :)&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å°±ç…§ç€ LeanCloud æä¾›çš„æ–‡æ¡£æµç¨‹èµ°ï¼š&lt;/p&gt;
&lt;h2&gt;å®‰è£…å‘½ä»¤è¡Œå·¥å…·&lt;/h2&gt;
&lt;p&gt;å‘½ä»¤è¡Œå·¥å…· avoscloud æ˜¯ LeanCloud æä¾›çš„ç”¨æ¥ç®¡ç†ã€éƒ¨ç½²äº‘å¼•æ“é¡¹ç›®çš„å·¥å…·ï¼Œé€šè¿‡ç®€å•çš„å‘½ä»¤å°±å¯ä»¥éƒ¨ç½²ã€å‘å¸ƒäº‘å¼•æ“ä»£ç äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="https://leancloud.cn/docs/cloud_code_commandline.html#ä½¿ç”¨"&gt;æ–‡æ¡£çœ‹è¿™é‡Œ&lt;/a&gt;ï¼Œ Linux å’Œ Mac OSX ä¸Šéƒ½éœ€è¦å…ˆå®‰è£… nodejsï¼Œç„¶åé€šè¿‡ npm å®‰è£…å‘½ä»¤è¡Œå·¥å…· avoscloudï¼ŒWindows å¹³å°å°±å‚è€ƒæ–‡æ¡£å§ï¼Œæˆ‘ä¹Ÿæ²¡è¯•è¿‡ã€‚&lt;/p&gt;
&lt;h2&gt;è¿è¡Œç¤ºä¾‹ç¨‹åº&lt;/h2&gt;
&lt;p&gt;æ–‡æ¡£æä¾›äº†ä¸€ä¸ª Demo ç¨‹åºï¼ˆ&lt;a href="https://github.com/leancloud/python-getting-started"&gt;python-getting-started&lt;/a&gt;ï¼‰ä»¥ä¾›å‚è€ƒï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŒ‰ç…§æ–‡æ¡£çš„æµç¨‹èµ°ä¸€éï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å…‹éš†é¡¹ç›® -&amp;gt; æ·»åŠ  App ID ç­‰ä¿¡æ¯ -&amp;gt; å®‰è£…é¡¹ç›®ä¾èµ– -&amp;gt; avoscloud å‘½ä»¤å¯åŠ¨é¡¹ç›®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ ·å°±å¯ä»¥åœ¨æœ¬åœ° &lt;a href="http://localhost:3000"&gt;http://localhost:3000&lt;/a&gt; çœ‹åˆ°æ•ˆæœäº†ï¼ŒåŒæ—¶ &lt;code&gt;avoscloud deploy&lt;/code&gt; å’Œ &lt;code&gt;avoscloud publish&lt;/code&gt; å‘½ä»¤åˆ†åˆ«å¯ä»¥æŠŠé¡¹ç›®éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒå»ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;PS: APP_ID/APP_KEY ç­‰ä¿¡æ¯ï¼Œå¯ä»¥åœ¨ &lt;code&gt;ä½ çš„ App ç•Œé¢ -&amp;gt; è®¾ç½® -&amp;gt; åº”ç”¨ Key&lt;/code&gt; æ‰¾åˆ° :)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;æ”¹å†™ä»£ç ï¼Œå®ç°åŠŸèƒ½&lt;/h2&gt;
&lt;h3&gt;1. è¿”å›è‡ªå®šä¹‰å†…å®¹&lt;/h3&gt;
&lt;p&gt;æ‰“å¼€é¡¹ç›®å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ &lt;code&gt;wsgi.py&lt;/code&gt; é‡Œåˆå§‹åŒ–äº† leancloud ç»„ä»¶ï¼Œå¹¶ä¸”è·å–åˆ°ç¯å¢ƒå˜é‡ä¸­çš„ App ID ç­‰å‚æ•°ã€‚åœ¨ &lt;code&gt;app.py&lt;/code&gt; ä¸­å®šä¹‰äº†å‡ ä¸ªè·¯ç”±å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;# è®¿é—®æ ¹ç›®å½• / ï¼Œä¼šæ¸²æŸ“ index.html å¹¶è¿”å›&lt;/span&gt;
&lt;span class="nd"&gt;@app.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;index.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å¯ä»¥æ¨¡ä»¿å†™ä¸€ä¸ªè‡ªå®šä¹‰ APIï¼Œæ¯”å¦‚è®¿é—® &lt;a href="http://brucezz.leanapp.cn/brucezz"&gt;'/brucezz'&lt;/a&gt;ï¼Œä¼šè¿”å›ç›¸åº”çš„æ¬¢è¿ä¿¡æ¯ï¼Œå¹¶ä¸”æ ¼å¼ä¸º JSONã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;# /&amp;lt;name&amp;gt; è¡¨ç¤ºï¼Œè®¿é—®è¿™æ ·æ ¼å¼çš„url, ä¼šæ˜ å°„åˆ°æ­¤å‡½æ•°ï¼Œå¹¶è¿”å›å“åº”ç»“æœ&lt;/span&gt;
&lt;span class="nd"&gt;@app.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;lt;name&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;user&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# flask.jsonify() å¯ä»¥è¿”å› JSON å­—ç¬¦ä¸²&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Hello, {0}~&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿”å›ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;message&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hello, brucezz~&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“ç„¶è¿™ä¸ª API ä¹Ÿå¤ªç®€å•äº†ï¼Œå®é™…ä½¿ç”¨è‚¯å®šä¼šæœ‰æ›´å¤šçš„é€»è¾‘å¤„ç†ã€‚&lt;/p&gt;
&lt;h3&gt;2. ä» LeanCloud äº‘ç«¯æ•°æ®è¿”å›&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ª Web ç¨‹åºå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡é›†æˆ leancloud-sdk ï¼Œæ¥å®ç°å¯¹ LeanCloud äº‘ç«¯æ•°æ®çš„è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆå†™ä¸€ä¸ªç±» Skill ç»§æ‰¿è‡ª leancloud.Objectï¼Œç„¶åç”¨è£…é¥°å™¨è®¾ç½®å‡ ä¸ªå±æ€§ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;leancloud&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Skill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leancloud&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nd"&gt;@property&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nd"&gt;@property&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;rank&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rank&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# æ·»åŠ å‡ ç»„æ•°æ®ä¾›æµ‹è¯•&lt;/span&gt;
    &lt;span class="n"&gt;APP_ID&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ä½ çš„APP_ID&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;MASTER_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ä½ çš„MASTER_KEY&amp;#39;&lt;/span&gt;

    &lt;span class="n"&gt;leancloud&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;APP_ID&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;master_key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;MASTER_KEY&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;Skill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;rank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;Skill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Java&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;rank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;Skill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Swift&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;rank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;Skill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;C#&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;rank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;Skill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Ruby&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;rank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶ååœ¨ &lt;code&gt;app.py&lt;/code&gt; ä¸­ç¼–å†™è·¯ç”±å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@app.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/skill&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;all_skill&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;skills&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;get_all_skill&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_all_skill&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Skill&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ascending&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rank&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;skill&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rank&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;skill&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rank&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;skill&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è®¿é—® &lt;a href="http://brucezz.leanapp.cn/skill"&gt;'/skill'&lt;/a&gt; è¿”å›ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;skills&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Python&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;rank&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Java&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;rank&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Swift&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;rank&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;C#&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;rank&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Ruby&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;rank&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·å°±å®ç°äº†ä» LeanCloud äº‘ç«¯è¯»å–æ•°æ®å¹¶è¿”å›ã€‚&lt;/p&gt;
&lt;h3&gt;3. é€šè¿‡ç½‘ç»œè®¿é—®ï¼Œè·å–å…¶ä»–ç«™ç‚¹çš„æ•°æ®ï¼Œå†è¿”å›&lt;/h3&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œ è·å– &lt;a href="http://gank.io/api"&gt;Gank.io çš„ API&lt;/a&gt; ç„¶åå¤„ç†æˆè‡ªå·±æƒ³è¦çš„æ ¼å¼ã€‚&lt;/p&gt;
&lt;p&gt;ç»§ç»­å†™è·¯ç”±å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@app.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/android&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_android&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="c1"&gt;# éšæœºè·å–10æ¡ Android çš„æ¨è&lt;/span&gt;
    &lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://gank.io/api/random/data/Android/10&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# ä»…éœ€è¦æ ‡é¢˜å’Œ url&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;desc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;desc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="c1"&gt;# æ¸²æŸ“ HTML æ¨¡æ¿&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;android.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;datas&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;HTML æ¨¡æ¿&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;&amp;lt;!DOCTYPE HTML&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Android æ¨èï¼&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;link&lt;/span&gt; &lt;span class="na"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/static/style.css&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;container&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Android :)&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/android&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ç‚¹æˆ‘æ¢å†…å®¹å“Ÿ ï½&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    {% for data in datas %}
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;{{ data.url }} &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ data.desc }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    {% endfor %}
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è®¿é—® &lt;a href="http://brucezz.leanapp.cn/android"&gt;'/android'&lt;/a&gt; çœ‹çœ‹æ•ˆæœå›¾ï¼&lt;/p&gt;
&lt;p&gt;&lt;img alt="demo" src="/images/leancloud-engine-demo1.png" /&gt;&lt;/p&gt;
&lt;h2&gt;å‘å¸ƒ&lt;/h2&gt;
&lt;p&gt;å‘å¸ƒçš„é¡¹ç›®å¯ä»¥è®¾ç½®ä¸€ä¸ªäºŒçº§åŸŸåï¼Œä½ç½®åœ¨ &lt;code&gt;ä½ çš„ App ç•Œé¢ -&amp;gt; å­˜å‚¨ -&amp;gt; äº‘å¼•æ“ -&amp;gt; è®¾ç½® -&amp;gt; Web ä¸»æœºåŸŸå&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;avoscloud deploy&lt;/code&gt; å°†é¡¹ç›®éƒ¨ç½²åˆ°äº‘ç«¯æµ‹è¯•ç¯å¢ƒï¼Œè®¿é—® &lt;code&gt;http://stg-${your_app_domain}.leanapp.cn&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;avoscloud publish&lt;/code&gt; å°†é¡¹ç›®éƒ¨ç½²åˆ°äº‘ç«¯ç”Ÿäº§ç¯å¢ƒï¼Œè®¿é—® &lt;code&gt;http://${your_app_domain}.leanapp.cn&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å¾…ç»­&lt;/h2&gt;
&lt;p&gt;è¿™æ¬¡ä½“éªŒ LeanCloud äº‘å¼•æ“ä»…ä»…æ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œè¿˜æœ‰äº‘å‡½æ•°ä»¥åŠå®šæ—¶å‡½æ•°å¯ä»¥ä½¿ç”¨ï¼Œä»¥åä¼šæ›´åŠ æ·±å…¥åœ°ç ”ç©¶ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤– LeanCloud äº‘å¼•æ“è¿˜èƒ½ä½¿ç”¨ Python Web æ¡†æ¶ï¼Œéƒ¨ç½²è‡ªå·±çš„å°ç«™ï¼Œå…å»è‡ªå·±æ¶è®¾æœåŠ¡å™¨çš„éº»çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;æ›´å¤šçš„æŠ€å·§å§¿åŠ¿ï¼Œéœ€å‚è€ƒ &lt;a href="https://leancloud.cn/docs/index.html"&gt;LeanCloud æ–‡æ¡£&lt;/a&gt;ï¼Œä»¥åŠ &lt;a href="http://docs.jinkan.org/docs/flask/"&gt;Flask æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Sat, 05 Mar 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-03-05:articles/2016/03/05/start-with-leanengine/</guid><category>LeanCloud</category></item><item><title>å¦‚ä½•æ›´é«˜æ•ˆåœ°ä½¿ç”¨ OkHttp</title><link>http://brucezz.github.io/articles/2016/02/21/effective-okhttp/</link><description>&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åŸæ–‡é“¾æ¥: &lt;a href="http://omgitsmgp.com/2015/12/02/effective-okhttp/"&gt;Effective OkHttp&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;åŸæ–‡ä½œè€… : &lt;a href="http://omgitsmgp.com/"&gt;Michael Parker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;è¯‘æ–‡å‡ºè‡ª : &lt;a href="https://github.com/xitu/gold-miner"&gt;æ˜é‡‘ç¿»è¯‘è®¡åˆ’&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;è¯‘è€… : &lt;a href="https://github.com/brucezz"&gt;Brucezz&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æ ¡å¯¹è€…: &lt;a href="https://github.com/iThreeKing"&gt;iThreeKing&lt;/a&gt;, &lt;a href="https://github.com/shenxn"&gt;Adam Shen&lt;/a&gt;, &lt;a href="https://github.com/laobie"&gt;Jaeger&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;è¯‘æ–‡é“¾æ¥ï¼š&lt;a href="http://brucezz.github.io/articles/2016/02/21/effective-okhttp/"&gt;å¦‚ä½•æ›´é«˜æ•ˆåœ°ä½¿ç”¨ OkHttp&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;è½¬è½½è¯·è”ç³»ï¼Œå¹¶æ³¨æ˜å‡ºå¤„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨ä¸º&lt;a href="https://www.khanacademy.org/"&gt;å¯æ±—å­¦é™¢&lt;/a&gt;å¼€å‘ &lt;a href="https://play.google.com/store/apps/details?id=org.khanacademy.android"&gt;Android app&lt;/a&gt; æ—¶ï¼Œ&lt;a href="http://square.github.io/okhttp/"&gt;OkHttp&lt;/a&gt; æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å¼€æºåº“ã€‚è™½ç„¶å®ƒçš„é»˜è®¤é…ç½®å·²ç»æä¾›äº†å¾ˆå¥½çš„æ•ˆæœï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯é‡‡å–äº†ä¸€äº›æªæ–½æé«˜ OkHttp çš„å¯ç”¨æ€§å’Œè‡ªæˆ‘æ£€æŸ¥èƒ½åŠ›ï¼š&lt;/p&gt;
&lt;h3&gt;1. åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­å¼€å¯å“åº”ç¼“å­˜&lt;/h3&gt;
&lt;p&gt;æœ‰äº›å“åº”æ¶ˆæ¯é€šè¿‡åŒ…å« &lt;code&gt;Cache-Control&lt;/code&gt; HTTP é¦–éƒ¨å­—æ®µå…è®¸ç¼“å­˜ï¼Œä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼ŒOkHttp å¹¶ä¸ä¼šç¼“å­˜è¿™äº›å“åº”æ¶ˆæ¯ã€‚å› æ­¤ä½ çš„å®¢æˆ·ç«¯å¯èƒ½ä¼šå› ä¸ºä¸æ–­è¯·æ±‚ç›¸åŒçš„èµ„æºè€Œæµªè´¹æ—¶é—´å’Œå¸¦å®½ï¼Œè€Œä¸æ˜¯ç®€å•åœ°è¯»å–ä¸€ä¸‹é¦–æ¬¡å“åº”æ¶ˆæ¯çš„ç¼“å­˜å‰¯æœ¬ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­å¼€å¯å“åº”ç¼“å­˜ï¼Œéœ€è¦é…ç½®ä¸€ä¸ª &lt;code&gt;com.squareup.okhttp.Cache&lt;/code&gt; å®ä¾‹ï¼Œç„¶åæŠŠå®ƒä¼ é€’ç»™ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹çš„ &lt;code&gt;setCache&lt;/code&gt; æ–¹æ³•ã€‚ä½ å¿…é¡»ç”¨ä¸€ä¸ªè¡¨ç¤ºç›®å½•çš„ &lt;code&gt;File&lt;/code&gt; å¯¹è±¡å’Œæœ€å¤§å­—èŠ‚æ•°æ¥å®ä¾‹åŒ– &lt;code&gt;Cache&lt;/code&gt; å¯¹è±¡ã€‚é‚£äº›èƒ½å¤Ÿç¼“å­˜çš„å“åº”æ¶ˆæ¯ä¼šè¢«å†™åœ¨æŒ‡å®šçš„ç›®å½•ä¸­ã€‚å¦‚æœå·²ç¼“å­˜çš„å“åº”æ¶ˆæ¯å¯¼è‡´ç›®å½•å†…å®¹è¶…è¿‡äº†æŒ‡å®šçš„å¤§å°ï¼Œå“åº”æ¶ˆæ¯ä¼šæŒ‰ç…§æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆ&lt;a href="https://en.wikipedia.org/wiki/Cache_algorithms#LRU"&gt;LRU Policy&lt;/a&gt;ï¼‰çš„ç­–ç•¥è¢«ç§»é™¤ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚ &lt;a href="http://stackoverflow.com/a/32752861/400717"&gt;Jesse Wilson æ‰€å»ºè®®çš„&lt;/a&gt;ï¼Œæˆ‘ä»¬å°†å“åº”æ¶ˆæ¯ç¼“å­˜åœ¨ &lt;code&gt;context.getCacheDir()&lt;/code&gt; çš„å­æ–‡ä»¶å¤¹ä¸­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// ç¼“å­˜æ ¹ç›®å½•ï¼Œç”±è¿™é‡Œæ¨è -&amp;gt; http://stackoverflow.com/a/32752861/400717.&lt;/span&gt;
&lt;span class="c1"&gt;// å°å¿ƒå¯èƒ½ä¸ºç©ºï¼Œå‚è€ƒä¸‹é¢ä¸¤ä¸ªé“¾æ¥&lt;/span&gt;
&lt;span class="c1"&gt;// https://groups.google.com/d/msg/android-developers/-694j87eXVU/YYs4b6kextwJ å’Œ&lt;/span&gt;
&lt;span class="c1"&gt;// http://stackoverflow.com/q/4441849/400717.&lt;/span&gt;
&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="nd"&gt;@Nullable&lt;/span&gt; &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="n"&gt;baseDir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCacheDir&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;baseDir&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="n"&gt;cacheDir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;File&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;baseDir&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;HttpResponseCache&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;okHttpClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setCache&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Cache&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cacheDir&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;HTTP_RESPONSE_DISK_CACHE_MAX_SIZE&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨å¯æ±—å­¦é™¢çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šäº† &lt;code&gt;HTTP_RESPONSE_DISK_CACHE_MAX_SIZE&lt;/code&gt; çš„å¤§å°ä¸º &lt;code&gt;10 * 1024 * 1024&lt;/code&gt;ï¼Œå³ 10MBã€‚&lt;/p&gt;
&lt;h3&gt;2. é›†æˆ Stetho&lt;/h3&gt;
&lt;p&gt;&lt;a href="http://facebook.github.io/stetho/"&gt;Stetho&lt;/a&gt; æ˜¯ä¸€ä¸ª Facebook å‡ºå“çš„è¶…èµçš„å¼€æºåº“ï¼Œå®ƒå¯ä»¥è®©ä½ ç”¨ Chrome çš„åŠŸèƒ½â€”â€”&lt;a href="https://developers.google.com/web/tools/setup/workspace/setup-devtools"&gt;å¼€å‘è€…å·¥å…·&lt;/a&gt; æ¥æ£€æŸ¥è°ƒè¯•ä½ çš„ Android åº”ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;Stetho ä¸ä»…èƒ½å¤Ÿæ£€æŸ¥åº”ç”¨çš„ SQLite æ•°æ®åº“å’Œè§†å›¾å±‚æ¬¡ï¼Œè¿˜å¯ä»¥æ£€æŸ¥ OkHttp çš„æ¯ä¸€æ¡è¯·æ±‚å’Œå“åº”æ¶ˆæ¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="Image of Stetho" src="http://omgitsmgp.com/assets/images/posts/stetho-inspector-network.png" /&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç§è‡ªæˆ‘æ£€æŸ¥æ–¹å¼ï¼ˆIntrospectionï¼‰æœ‰æ•ˆåœ°ç¡®ä¿äº†æœåŠ¡å™¨è¿”å›å…è®¸ç¼“å­˜èµ„æºçš„ HTTP é¦–éƒ¨æ—¶ï¼Œä¸”æ ¸ç¼“å­˜èµ„æºå­˜åœ¨æ—¶ï¼Œä¸å†å‘å‡ºä»»ä½•è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å¯ Stethoï¼Œåªç”¨ç®€å•åœ°æ·»åŠ ä¸€ä¸ª &lt;code&gt;StethoInterceptor&lt;/code&gt; å®ä¾‹åˆ°ç½‘ç»œæ‹¦æˆªå™¨ï¼ˆNetwork Interceptorï¼‰çš„åˆ—è¡¨ä¸­å»ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;okHttpClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;networkInterceptors&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;StethoInterceptor&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åº”ç”¨è¿è¡Œå®Œæ¯•ä¹‹åï¼Œæ‰“å¼€ Chrome ç„¶åè·³è½¬åˆ° &lt;code&gt;chrome://inspect&lt;/code&gt;ã€‚è®¾å¤‡ã€åº”ç”¨ä»¥åŠåº”ç”¨æ ‡è¯†ç¬¦ä¿¡æ¯ä¼šè¢«é™ˆåˆ—å‡ºæ¥ã€‚ç›´æ¥ç‚¹å‡»â€œinspectâ€é“¾æ¥å°±å¯ä»¥æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œç„¶ååˆ‡æ¢åˆ° Network æ ‡ç­¾å¼€å§‹ç›‘æµ‹ OkHttp å‘å‡ºçš„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;h3&gt;3. ä½¿ç”¨ Picasso å’Œ Retrofit&lt;/h3&gt;
&lt;p&gt;å¯èƒ½å’Œæˆ‘ä»¬ä¸€æ ·ï¼Œä½ ä½¿ç”¨ &lt;a href="http://square.github.io/picasso/"&gt;Picasso&lt;/a&gt; æ¥åŠ è½½ç½‘ç»œå›¾ç‰‡ï¼Œæˆ–è€…ä½¿ç”¨ &lt;a href="http://square.github.io/retrofit/"&gt;Retrofit&lt;/a&gt; æ¥ç®€åŒ–ç½‘ç»œè¯·æ±‚å’Œè§£æå“åº”æ¶ˆæ¯ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æ²¡æœ‰æ˜¾å¼åœ°æŒ‡å®šä¸€ä¸ª &lt;code&gt;OkHttpClient&lt;/code&gt;ï¼Œè¿™äº›å¼€æºåº“ä¼šéšå¼åœ°åˆ›å»ºå®ƒä»¬è‡ªå·±çš„ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹ä»¥ä¾›å†…éƒ¨ä½¿ç”¨ã€‚ä»¥ä¸‹ä»£ç æ¥è‡ªäº Picasso 2.5.2 ç‰ˆæœ¬çš„ &lt;code&gt;OkHttpDownloader&lt;/code&gt; ç±»ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt; &lt;span class="nf"&gt;defaultOkHttpClient&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;OkHttpClient&lt;/span&gt; &lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
  &lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setConnectTimeout&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Utils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;DEFAULT_CONNECT_TIMEOUT_MILLIS&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TimeUnit&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MILLISECONDS&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setReadTimeout&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Utils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;DEFAULT_READ_TIMEOUT_MILLIS&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TimeUnit&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MILLISECONDS&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setWriteTimeout&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Utils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;DEFAULT_WRITE_TIMEOUT_MILLIS&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TimeUnit&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MILLISECONDS&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Retrofit ä¹Ÿæœ‰ç±»ä¼¼çš„å·¥å‚æ–¹æ³•ç”¨æ¥åˆ›å»ºå®ƒè‡ªå·±çš„ &lt;code&gt;OkHttpClient&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å›¾ç‰‡æ˜¯åº”ç”¨ä¸­éœ€è¦åŠ è½½çš„æœ€å¤§çš„èµ„æºä¹‹ä¸€ã€‚Picasso æ˜¯ä¸¥æ ¼åœ°æŒ‰ç…§ LRU ç­–ç•¥åœ¨å†…å­˜ä¸­ç»´æŠ¤å®ƒçš„å›¾ç‰‡ç¼“å­˜ã€‚å¦‚æœå®¢æˆ·ç«¯å°è¯•ç”¨ Picasso åŠ è½½ä¸€å¼ å›¾ç‰‡ï¼Œå¹¶ä¸” Picasso æ²¡æœ‰åœ¨å†…å­˜ç¼“å­˜ä¸­æ‰¾åˆ°è¯¥å›¾ç‰‡ï¼Œé‚£ä¹ˆå®ƒä¼šå§”æ‰˜å†…éƒ¨çš„ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹æ¥åŠ è½½è¯¥å›¾ç‰‡ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œç”±äºå‰é¢çš„ &lt;code&gt;defaultOkHttpClient&lt;/code&gt; æ–¹æ³•æ²¡æœ‰åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­é…ç½®å“åº”ç¼“å­˜ï¼Œè¯¥å®ä¾‹ä¼šä¸€ç›´ä»æœåŠ¡å™¨åŠ è½½å›¾ç‰‡ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªå®šä¹‰ä¸€ä¸ª &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹ï¼Œå°†ä»æ–‡ä»¶ç³»ç»Ÿè¿”å›ä¸€ä¸ªå·²ç¼“å­˜çš„å“åº”æ¶ˆæ¯è¿™ç§æƒ…å†µè€ƒè™‘åœ¨å†…ã€‚æ²¡æœ‰ä¸€å¼ å›¾ç‰‡ç›´æ¥ä»æœåŠ¡å™¨åŠ è½½ã€‚è¿™åœ¨åº”ç”¨ç¬¬ä¸€æ¬¡åŠ è½½æ—¶æ˜¯å°¤ä¸ºé‡è¦çš„ã€‚åœ¨è¿™ä¸ªæ—¶å€™ï¼ŒPicasso çš„å†…å­˜ä¸­çš„ç¼“å­˜æ˜¯ &lt;a href="http://stackoverflow.com/a/22756972/400717"&gt;â€œå†·â€&lt;/a&gt;çš„ï¼Œå®ƒä¼šé¢‘ç¹åœ°å§”æ‰˜ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹å»åŠ è½½å›¾ç‰‡ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±éœ€è¦æ„å»ºä¸€ä¸ªç”¨ä½ çš„ &lt;code&gt;OkHttpClient&lt;/code&gt; é…ç½®çš„ &lt;code&gt;Picasso&lt;/code&gt; å®ä¾‹ã€‚å¦‚æœä½ åœ¨ä»£ç ä¸­ä½¿ç”¨  &lt;code&gt;Picasso.with(context).load(...)&lt;/code&gt; æ¥åŠ è½½å›¾ç‰‡ï¼Œä½ æ‰€ä½¿ç”¨çš„ &lt;code&gt;Picasso&lt;/code&gt; å•ä¾‹å¯¹è±¡ï¼Œæ˜¯åœ¨  &lt;code&gt;with&lt;/code&gt; æ–¹æ³•ä¸­ç”¨è‡ªå·±çš„ &lt;code&gt;OkHttpClient&lt;/code&gt; å»¶è¿ŸåŠ è½½å’Œé…ç½®çš„ã€‚å› æ­¤æˆ‘ä»¬å¿…é¡»åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ &lt;code&gt;with&lt;/code&gt; æ–¹æ³•ä¹‹å‰æŒ‡å®šè‡ªå·±çš„ &lt;code&gt;Picasso&lt;/code&gt; å®ä¾‹ä½œä¸ºå•ä¾‹å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•åœ°æŠŠ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹åŒ…è£…åˆ°ä¸€ä¸ª &lt;code&gt;OkHttpDownloader&lt;/code&gt; å¯¹è±¡ä¸­ï¼Œç„¶åä¼ é€’ç»™ &lt;code&gt;Picasso.Builder&lt;/code&gt; å®ä¾‹çš„ &lt;code&gt;downloader&lt;/code&gt; æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Picasso&lt;/span&gt; &lt;span class="n"&gt;picasso&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Picasso&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;downloader&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpDownloader&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;okHttpClient&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

&lt;span class="c1"&gt;//å®¢æˆ·ç«¯åº”è¯¥åœ¨ä»»ä½•éœ€è¦çš„æ—¶å€™æ¥åˆ›å»ºè¿™ä¸ªå®ä¾‹&lt;/span&gt;
&lt;span class="c1"&gt;//ä»¥é˜²ä¸‡ä¸€ï¼Œæ›¿æ¢æ‰é‚£ä¸ªå•ä¾‹å¯¹è±¡&lt;/span&gt;
&lt;span class="n"&gt;Picasso&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setSingletonInstance&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;picasso&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ Retrofit 1.9.x ä¸­ï¼Œé€šè¿‡ &lt;code&gt;RestAdapter&lt;/code&gt; ä½¿ç”¨ä½ çš„ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹ï¼ŒæŠŠ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹åŒ…è£…åˆ°ä¸€ä¸ª &lt;code&gt;OkClient&lt;/code&gt; å®ä¾‹ä¸­ï¼Œç„¶åä¼ é€’ç»™ &lt;code&gt;RestAdapter.Builder&lt;/code&gt; å®ä¾‹çš„ &lt;code&gt;setClient&lt;/code&gt; æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;restAdapterBuilder.setClient(new OkClient(httpClient));
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ Retrofit 2.0 ä¸­ï¼Œç›´æ¥æŠŠ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹ä¼ é€’ç»™ &lt;code&gt;Retrofit.Builder&lt;/code&gt; å®ä¾‹çš„ &lt;code&gt;client&lt;/code&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å¯æ±—å­¦é™¢çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;a href="http://google.github.io/dagger/"&gt;Dagger&lt;/a&gt; æ¥ç¡®ä¿åªæœ‰ä¸€ä¸ª &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹ï¼Œè€Œä¸” Picasso å’Œ Retrofit éƒ½ä¼šä½¿ç”¨åˆ°å®ƒã€‚æˆ‘ä»¬ä¸ºå¸¦ &lt;code&gt;@Singleton&lt;/code&gt; æ³¨è§£çš„ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹åˆ›å»ºäº†ä¸€ä¸ª providerï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Provides&lt;/span&gt;
&lt;span class="nd"&gt;@Singleton&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt; &lt;span class="nf"&gt;okHttpClient&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Context&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;...)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt; &lt;span class="n"&gt;okHttpClient&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
  &lt;span class="n"&gt;configureClient&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;okHttpClient&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;...);&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;okHttpClient&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ª &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹éšåé€šè¿‡ Dagger æ³¨å…¥åˆ°å…¶ä»–ç”¨æ¥åˆ›å»º &lt;code&gt;RestAdapter&lt;/code&gt; å’Œ &lt;code&gt;Picasso&lt;/code&gt; å®ä¾‹çš„ provider é‡Œã€‚&lt;/p&gt;
&lt;h3&gt;4. è®¾ç½®ç”¨æˆ·ä»£ç†æ‹¦æˆªå™¨ï¼ˆUser-Agent Interceptorï¼‰&lt;/h3&gt;
&lt;p&gt;å½“å®¢æˆ·ç«¯åœ¨æ¯ä¸€æ¬¡è¯·æ±‚ä¸­éƒ½æä¾›ä¸€ä¸ªè¯¦ç»†çš„ &lt;code&gt;User-Agent&lt;/code&gt; å¤´éƒ¨ä¿¡æ¯æ—¶ï¼Œæ—¥å¿—æ–‡ä»¶å’Œåˆ†ææ•°æ®æä¾›äº†å¾ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒOkHttp çš„ &lt;code&gt;User-Agent&lt;/code&gt; å€¼ä»…ä»…åªæœ‰å®ƒçš„ç‰ˆæœ¬å·ã€‚è¦è®¾å®šä½ è‡ªå·±çš„ User-Agentï¼Œåˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ç„¶åæ›¿æ¢æ‰é»˜è®¤å€¼ï¼Œå‚è€ƒ &lt;a href="http://stackoverflow.com/a/27840834/400717"&gt;StackOverflow ä¸Šçš„å»ºè®®&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserAgentInterceptor&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Interceptor&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;USER_AGENT_HEADER_NAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;User-Agent&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;userAgentHeaderValue&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

  &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;UserAgentInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;userAgentHeaderValue&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;userAgentHeaderValue&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Preconditions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;checkNotNull&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;userAgentHeaderValue&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;

  &lt;span class="nd"&gt;@Override&lt;/span&gt;
  &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="nf"&gt;intercept&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chain&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Request&lt;/span&gt; &lt;span class="n"&gt;originalRequest&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;request&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Request&lt;/span&gt; &lt;span class="n"&gt;requestWithUserAgent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;originalRequest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;newBuilder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
        &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;removeHeader&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;USER_AGENT_HEADER_NAME&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addHeader&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;USER_AGENT_HEADER_NAME&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;userAgentHeaderValue&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;proceed&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requestWithUserAgent&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ä»»ä½•ä½ è§‰å¾—æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œæ¥åˆ›å»º &lt;code&gt;User-Agent&lt;/code&gt; å€¼ï¼Œç„¶åä¼ é€’ç»™ &lt;code&gt;UserAgentInterceptor&lt;/code&gt; çš„æ„é€ å‡½æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨äº†è¿™äº›å­—æ®µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;os&lt;/code&gt; å­—æ®µï¼Œå€¼è®¾ç½®ä¸º &lt;code&gt;Android&lt;/code&gt;ï¼Œæ˜ç¡®è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª Android è®¾å¤‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Build.MODEL&lt;/code&gt; å­—æ®µï¼Œå³ç”¨æˆ·å¯è§çš„ç»ˆç«¯äº§å“çš„åç§°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Build.BRAND&lt;/code&gt; å­—æ®µï¼Œå³æ¶ˆè´¹è€…å¯è§çš„è·Ÿäº§å“æˆ–ç¡¬ä»¶ç›¸å…³çš„å•†æ ‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Build.VERSION.SDK_INT&lt;/code&gt; å­—æ®µï¼Œå³ç”¨æˆ·å¯è§çš„ [Android] æ¡†æ¶ç‰ˆæœ¬å·&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BuildConfig.APPLICATION_ID&lt;/code&gt; å­—æ®µ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BuildConfig.VERSION_NAME&lt;/code&gt; å­—æ®µ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BuildConfig.VERSION_CODE&lt;/code&gt;å­—æ®µ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åä¸‰ä¸ªå­—æ®µæ˜¯æ ¹æ®æˆ‘ä»¬çš„ Gradle æ„å»ºè„šæœ¬ä¸­çš„ &lt;code&gt;applicationId&lt;/code&gt;, &lt;code&gt;versionCode&lt;/code&gt; å’Œ &lt;code&gt;versionName&lt;/code&gt; çš„å€¼æ¥ç¡®å®šçš„ã€‚äº†è§£æ›´å¤šä¿¡æ¯è¯·å‚è€ƒæ–‡æ¡£ &lt;a href="http://developer.android.com/tools/publishing/versioning.html"&gt;åº”ç”¨ç‰ˆæœ¬æ§åˆ¶&lt;/a&gt;ï¼Œå’Œ &lt;a href="http://tools.android.com/tech-docs/new-build-system/applicationid-vs-packagename"&gt;ä½¿ç”¨ Gradle é…ç½®ä½ çš„ &lt;code&gt;applicationId&lt;/code&gt;&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å°æç¤ºï¼šå¦‚æœä½ çš„åº”ç”¨ä¸­ç”¨åˆ°äº† &lt;code&gt;WebView&lt;/code&gt;ï¼Œä½ å¯ä»¥é…ç½®ä½¿ç”¨ç›¸åŒçš„ &lt;code&gt;User-Agent&lt;/code&gt; å€¼ï¼Œå³ä¹‹å‰åˆ›å»ºçš„ &lt;code&gt;UserAgentInterceptor&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;WebSettings&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getSettings&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;setUserAgentString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;userAgentHeaderValue&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;5. æŒ‡å®šåˆç†çš„è¶…æ—¶&lt;/h3&gt;
&lt;p&gt;åœ¨ 2.5.0 ç‰ˆæœ¬ä¹‹å‰ï¼ŒOkHttp è¯·æ±‚é»˜è®¤æ°¸ä¸è¶…æ—¶ã€‚ä» 2.5.0 ç‰ˆæœ¬å¼€å§‹ï¼Œå¦‚æœå»ºç«‹äº†ä¸€ä¸ªè¿æ¥ï¼Œæˆ–ä»è¿æ¥è¯»å–ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œæˆ–è€…å‘è¿æ¥å†™å…¥ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œç”¨æ—¶è¶…è¿‡äº†10ç§’ï¼Œè¯·æ±‚å°±ä¼šè¶…æ—¶ã€‚åˆ†åˆ«è°ƒç”¨ &lt;code&gt;setConnectTimeout&lt;/code&gt;ï¼Œ&lt;code&gt;setReadTimeout&lt;/code&gt; æˆ– &lt;code&gt;setWriteTimeout&lt;/code&gt; æ–¹æ³•å¯ä»¥é‡å†™é‚£äº›é»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å°æç¤ºï¼šPicasso å’Œ Retrofit ä¸ºå®ƒä»¬çš„é»˜è®¤ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹æŒ‡å®šä¸åŒçš„è¶…æ—¶æ—¶é•¿ã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼Œ Picasso è®¾å®šå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿æ¥è¶…æ—¶15ç§’&lt;/li&gt;
&lt;li&gt;è¯»å–è¶…æ—¶20ç§’&lt;/li&gt;
&lt;li&gt;å†™å…¥è¶…æ—¶20ç§’&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Retrofit è®¾å®šå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿æ¥è¶…æ—¶15ç§’&lt;/li&gt;
&lt;li&gt;è¯»å–è¶…æ—¶20ç§’&lt;/li&gt;
&lt;li&gt;å†™å…¥æ— è¶…æ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”¨ä½ è‡ªå·±çš„ &lt;code&gt;OkHttpClient&lt;/code&gt; å®ä¾‹é…ç½®å¥½ Picasso å’Œ Retrofit ä¹‹åï¼Œå°±èƒ½ç¡®ä¿æ‰€æœ‰è¯·æ±‚è¶…æ—¶çš„ä¸€è‡´æ€§äº†ã€‚&lt;/p&gt;
&lt;h3&gt;ç»“è®º&lt;/h3&gt;
&lt;p&gt;å†æ¬¡å¼ºè°ƒï¼ŒOkHttp çš„é»˜è®¤é…ç½®æä¾›äº†æ˜¾è‘—çš„æ•ˆæœï¼Œä½†æ˜¯é‡‡å–ä»¥ä¸Šçš„æªæ–½ï¼Œå¯ä»¥æé«˜ OkHttp çš„å¯ç”¨æ€§å’Œè‡ªæˆ‘æ£€æŸ¥èƒ½åŠ›ï¼Œå¹¶ä¸”æå‡ä½ çš„åº”ç”¨çš„è´¨é‡ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Sun, 21 Feb 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-02-21:articles/2016/02/21/effective-okhttp/</guid><category>Android</category><category>OkHttp</category><category>Translation</category></item><item><title>Sublime Text 3 æ’ä»¶ä¸‹è½½å¤±è´¥çš„è§£å†³æ–¹æ¡ˆ</title><link>http://brucezz.github.io/articles/2016/01/29/solution-of-sublime-text-package-download-fail/</link><description>&lt;p&gt;å‰ä¸¤å¤©çæŠ˜è…¾ï¼ŒæŠŠæ—¥å¸¸ä½¿ç”¨çš„ Ubuntu ç³»ç»Ÿç©åäº†ï¼Œåæœå°±æ˜¯é‡è£…ç³»ç»Ÿã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;Sublime Text è¿™æ¬¾æ–‡æœ¬ç¼–è¾‘å™¨ä¹Ÿå¾—é‡è£…ï¼Œå®‰è£…æ’ä»¶çš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªå¤´ç–¼çš„é—®é¢˜ï¼šæä¾› Sublime Text æ’ä»¶ä¸‹è½½çš„ç½‘ç«™ &lt;a href="https://packagecontrol.io/"&gt;packagecontrol.io&lt;/a&gt; è¢«å¢™äº†ï¼å¢™äº†ï¼äº†ï¼&lt;/p&gt;
&lt;p&gt;å®ƒçš„åŒ…ç®¡ç†å™¨(Package Control) ä¹Ÿä¸‹è½½ä¸ä¸‹æ¥ï¼Œå³ä½¿æ‰‹åŠ¨ä¸‹è½½å›æ¥ï¼Œç„¶åä¸¢åˆ°ç›¸åº”çš„æ–‡ä»¶å¤¹ï¼Œä¹Ÿä¸ä¼šä»æœåŠ¡å™¨æˆåŠŸåœ°è·å–åˆ°æœ‰æ•ˆçš„æ’ä»¶åˆ—è¡¨ï¼Œä¸€ç›´ä¼šæç¤º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There are no packages available for installation.&lt;/p&gt;
&lt;p&gt;Package Control: Error downloading channel. curl: (56) Proxy CONNECT aborted downloading https://packagecontrol.io/channel_v3.json.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è§£å†³æ–¹æ¡ˆå°±æ˜¯ï¼š&lt;strong&gt;è®¾ç½®ä»£ç†ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®˜ç½‘ç»™å‡ºçš„å®‰è£… Package Control çš„æœ€å¿«æ·çš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨ Console è¾“å…¥ä¸€æ®µä»£ç ï¼Œå¦‚ä¸‹ï¼ˆå®é™…ä½¿ç”¨çš„æ—¶å€™ä¸æ¢è¡Œï¼‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib.request&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nn"&gt;os&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nn"&gt;hashlib&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; 
&lt;span class="n"&gt;h&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;2915d1851351e5ee549c20394736b442&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;8bc59f460fa1548d1514676163dafc88&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; 
&lt;span class="n"&gt;pf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Package Control.sublime-package&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; 
&lt;span class="n"&gt;ipp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sublime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;installed_packages_path&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;install_opener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;build_opener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ProxyHandler&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;);&lt;/span&gt; 
&lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://packagecontrol.io/&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;pf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;%20&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; 
&lt;span class="n"&gt;dh&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sha256&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; 
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Error validating download (got &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt; instead of &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;), please try manual install&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dh&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;dh&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;h&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;ipp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pf&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wb&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å­¦è¿‡ Python çš„è¯ï¼Œå¾ˆå®¹æ˜“å°±çœ‹æ‡‚äº†ï¼Œä»æœåŠ¡å™¨ä¸‹è½½éœ€è¦çš„åŒ…åˆ°æŒ‡å®šè·¯å¾„ï¼Œå¹¶åˆ¤æ–­ hash å€¼æ˜¯å¦æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­æœ‰ä¸€å¥ &lt;code&gt;urllib.request.ProxyHandler()&lt;/code&gt;ï¼Œè¿™é‡Œä½¿ç”¨äº†ä»£ç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå¡«å…¥è‡ªå·±çš„ä»£ç†åœ°å€ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ProxyHandler&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;http&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;127.0.0.1:1080&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;https&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;127.0.0.1:1080&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åŠ å…¥ä»£ç†ä¹‹åï¼ŒæŠŠé‚£ä¸€å¤§ä¸²ä»£ç è¾“å…¥åˆ° Sublime Text çš„ Console é‡Œï¼Œå°±ä¼šè‡ªåŠ¨ä¸‹è½½å®‰è£… Package Control äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ‰“å¼€ &lt;code&gt;Menu -&amp;gt; Package Settings -&amp;gt; Package Control -&amp;gt; Settings - User&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åœ¨é‡Œé¢è®¾ç½®ä»£ç†ï¼Œè¾“å…¥å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;http_proxy&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;127.0.0.1:1080&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;https_proxy&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;127.0.0.1:1080&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·è®¾ç½®å®Œæˆä¹‹åï¼Œå°±èƒ½é¡ºåˆ©è®¿é—® &lt;a href="https://packagecontrol.io/"&gt;packagecontrol.io&lt;/a&gt; ï¼Œ&lt;code&gt;Ctrl + Shift + P -&amp;gt; Package Control: Install Package&lt;/code&gt; å°±å¯ä»¥å®‰è£…æ’ä»¶å•¦ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–è¿˜æœ‰ç§å®‰è£…æ’ä»¶çš„æ–¹æ³•ï¼Œä» Github ä»“åº“å®‰è£…ï¼Œä¸€èˆ¬æƒ…å†µä¸‹éƒ½èƒ½ç›´æ¥è®¿é—® Githubï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•ä¸ç”¨è®¾ç½®ä»£ç† ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Ctrl + Shift + P -&amp;gt; Package Control: Add Repository&lt;/code&gt; æ·»åŠ  Github ä»“åº“&lt;/li&gt;
&lt;li&gt;è¾“å…¥ &lt;code&gt;https://github.com/&amp;lt;username&amp;gt;/&amp;lt;repo&amp;gt;&lt;/code&gt;, å¦‚&lt;code&gt;https://github.com/wakatime/sublime-wakatime&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl + Shift + P -&amp;gt; Package Control: Install Package&lt;/code&gt; è·å–æ’ä»¶åˆ—è¡¨ï¼Œå°±èƒ½çœ‹åˆ°åˆšåˆšæ·»åŠ çš„æ’ä»¶äº†ï¼ŒæŒ‰ &lt;code&gt;Enter&lt;/code&gt; ä¸‹è½½å°± OK äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â•®(â•¯â–½â•°)â•­ï¼Œæˆ‘ç”¨çš„æ’ä»¶ä¸å¤šï¼Œå°± &lt;code&gt;wakatime&lt;/code&gt;, &lt;code&gt;git&lt;/code&gt;, &lt;code&gt;convertToUTF8&lt;/code&gt;, etc.&lt;/p&gt;
&lt;p&gt;å¦å¦å¤–ï¼ŒUbuntu ç³»ç»Ÿ Sublime Text ä¸èƒ½è¾“å…¥ä¸­æ–‡é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆåœ¨è¿™é‡Œ -&amp;gt; &lt;a href="https://github.com/lyfeyaj/sublime-text-imfix"&gt;lyfeyaj/sublime-text-imfix&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¾“å…¥æ¡†ä¸è·Ÿéšé—®é¢˜ï¼Œç›®å‰å¥½åƒè¿˜æ— èƒ½ä¸ºåŠ›ã€‚ã€‚ã€‚ â•®(â•¯â–½â•°)â•­&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Fri, 29 Jan 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-01-29:articles/2016/01/29/solution-of-sublime-text-package-download-fail/</guid></item><item><title>æŠ“å–æ–—é±¼ç›´æ’­å¼¹å¹•</title><link>http://brucezz.github.io/articles/2016/01/11/douyu-crawler/</link><description>&lt;p&gt;å‰å‡ å¤©çœ‹äº†çŸ¥ä¹çš„ä¸€ä¸ªé—®é¢˜ï¼ˆ&lt;a href="https://www.zhihu.com/question/29027665"&gt;å¦‚ä½•è·å–æ–—é±¼ç›´æ’­é—´çš„å¼¹å¹•ä¿¡æ¯ï¼Ÿ&lt;/a&gt;ï¼‰ä¹‹åï¼Œæ‰æœ‰äº†è¿™ä¸ªæƒ³æ³•ã€‚ä¸€ç›´å¯¹æŠ“å–ä¿¡æ¯æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œè¿™æ¬¡ä¹Ÿä¸ä¼šé”™è¿‡å’¯ï¼Œå°è¯•ä¸€ä¸‹ â†’.â†’&lt;/p&gt;
&lt;p&gt;æŠ“å–æ•°æ®çš„åŸºæœ¬æ€è·¯å°±æ˜¯ï¼š æŠ“åŒ… â†’ åˆ†æè¯·æ±‚ä¿¡æ¯ â†’ æ¨¡æ‹Ÿå‘é€è¯·æ±‚ â†’ è·å¾—æ•°æ®&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;çŸ¥ä¹å›ç­”åœ°å€ï¼š&lt;a href="https://www.zhihu.com/question/29027665/answer/80169234"&gt;å¦‚ä½•è·å–æ–—é±¼ç›´æ’­é—´çš„å¼¹å¹•ä¿¡æ¯ï¼Ÿ - Brucezz çš„å›ç­” - çŸ¥ä¹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Github é¡¹ç›®ä»£ç åœ°å€ï¼š&lt;a href="https://github.com/brucezz/DouyuCrawler"&gt;brucezz/DouyuCrawler&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ€å¸¸è§çš„å°±æ˜¯ç”¨ Chrome çš„å¼€å‘è€…å·¥å…·(F12)ï¼Œç„¶åçœ‹ Network æ ï¼Œæœ‰ä»€ä¹ˆç›¸å…³çš„ GET/POST è¯·æ±‚ï¼Œç„¶åæ„é€ ç›¸åº”çš„å‚æ•°ï¼Œç”¨åŒæ ·çš„æ–¹æ³•å‘é€ç»™æœåŠ¡å™¨ï¼Œå°±èƒ½å¾—åˆ°ç›¸åº”æ•°æ®äº†ï¼Œä¸€èˆ¬é™æ€ç½‘é¡µé‡Œçš„æ•°æ®ç”¨è¿™ç§æ–¹æ³•å°±èƒ½æå®šã€‚å½“ç„¶ï¼Œå¦‚æœå°±è¿™ä¸ªç®€å•çš„è¯ï¼Œè¿™ç¯‡åšå®¢ä¹Ÿæ²¡æœ‰è®°å½•çš„å¿…è¦å•¦ï¼Œå“ˆå“ˆå“ˆã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€ä¸ªå·¥å…· Fiddlerï¼Œå¯ä»¥æ•è· HTTP/HTTPS åè®®çš„æµé‡ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªå¼€æºçš„ç½‘ç»œæ•°æ®åŒ…åˆ†æè½¯ä»¶ Wiresharkï¼Œè¿™æ¬¾è½¯ä»¶åŠŸèƒ½æ›´ä¸ºå¼ºå¤§ï¼Œæ”¯æŒå¤šç§åè®®ï¼Œèƒ½å¤Ÿæ˜¾ç¤ºå‡ºæœ€ä¸ºè¯¦ç»†çš„ç½‘ç»œæ•°æ®åŒ…æ•°æ®ã€‚&lt;/p&gt;
&lt;h2&gt;0x01 åˆæ¢&lt;/h2&gt;
&lt;p&gt;åœ¨ç›´æ’­é¡µé¢çš„ HTML æºç é‡Œéšä¾¿ç¿»ç¿»ï¼Œå‘ç°äº†å‡ ç‚¹ç›¸å…³çš„ js ä»£ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;var $ROOM ={ ... }&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;var room_args = { ... }&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ˜¯å®šä¹‰äº†ä¸¤ä¸ª js çš„å­—å…¸å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ JSON æ ¼å¼çš„æ•°æ®å’¯ã€‚ç”¨ä¸ªå·¥å…·æ ¼å¼åŒ–ï¼ˆ&lt;a href="http://www.kjson.com/jsoneditor/"&gt;JSONåœ¨çº¿ç¼–è¾‘&lt;/a&gt;ï¼‰ä¸€ä¸‹ï¼Œçœ‹èµ·æ¥å°±å¾ˆæ¸…æ™°å•¦ã€‚(çœç•¥äº†ä¸€äº›listé‡Œé¢çš„æ•°æ®)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;room_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;16101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;room_name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;å¾®ç¬‘ï¼š  æ–°å¹´å¿«ä¹å•¦å•¦å•¦~(â‰§â–½â‰¦)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;room_gg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;room_pic&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;http://staticlive.douyutv.com/upload/web_pic/201601/1/16101_1601111612_thumb.jpg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;owner_uid&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;391270&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;owner_name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;å¾®ç¬‘&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;show_status&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;room_url&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;http://www.douyutv.com/weixiao&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;show_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;8557130&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;room_pwd&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;cate_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;cate_name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;è‹±é›„è”ç›Ÿ&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;cate_url&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/directory/game/LOL&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;near_show_time&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;game_cate_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;all_tag_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;room_tag_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;  &lt;span class="p"&gt;],&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;show_time&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1452496988&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;widgetType&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;widgetPosition&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ï¼Œä¸€äº›å‚æ•°çš„å«ä¹‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;room_idï¼šæˆ¿é—´id&lt;/li&gt;
&lt;li&gt;owner_nameï¼šä¸»æ’­å&lt;/li&gt;
&lt;li&gt;show_statusï¼šå½“å‰ç›´æ’­çŠ¶æ€ï¼Œæ­£åœ¨ç›´æ’­ä¸º1&lt;/li&gt;
&lt;li&gt;room_urlï¼šæˆ¿é—´åœ°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;rpc_switch&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;leve_json&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;exp_level&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;no_home&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;no_home_time&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;live_url&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;res_path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/common/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;swf_url&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;http://staticlive.douyutv.com/common/simplayer/WebRoom.swf?v21680&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;server_config&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;quot;ip&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;119.90.49.109&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;quot;port&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;8044&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;quot;ip&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;119.90.49.104&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;quot;port&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;8017&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;],&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;quot;def_disp_gg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ï¼Œ&lt;code&gt;server_config&lt;/code&gt; å­—æ®µçš„æ•°æ®éœ€è¦ UrlDecode è§£ç ä¸€ä¸‹(&lt;a href="http://tool.chinaz.com/tools/urlencode.aspx"&gt;UrlEncodeç¼–ç /UrlDecodeè§£ç &lt;/a&gt;)ï¼Œæ‰èƒ½çœ‹åˆ°åŸæœ¬çš„é¢ç›®ã€‚(çœç•¥äº†å…¶ä»–å‡ ä¸ªæœåŠ¡å™¨åœ°å€)&lt;/p&gt;
&lt;p&gt;å‚æ•°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;leve_jsonï¼šå®šä¹‰äº†ä¸€äº›æˆ¿é—´ç²‰ä¸ç­‰çº§çš„æ ‡ç­¾&lt;/li&gt;
&lt;li&gt;server_configï¼šä¸€ç»„æœåŠ¡å™¨åœ°å€ ip:port ï¼Œåé¢ä¼šç”¨åˆ°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é¡µé¢é‡Œè¿˜è¾“å‡ºäº†å…¶ä»–å‡ ä¸ªJSONæ•°æ®&lt;code&gt;effectConfig&lt;/code&gt;ï¼Œ&lt;code&gt;giftBatterConfig&lt;/code&gt;ï¼Œåˆ†åˆ«æ˜¯å®šä¹‰äº†ä¸€äº›ç¤¼ç‰©çš„å‰ç«¯æ•ˆæœå’Œå¯¹åº”ä»£ç ï¼Œæœ‰éœ€è¦çš„æ—¶å€™å†å»åˆ†æã€‚&lt;/p&gt;
&lt;h2&gt;0x02 æŠ“åŒ…åˆ†æ&lt;/h2&gt;
&lt;p&gt;æ—¢ç„¶ä¸Šé¢æ‹¿åˆ°çš„æœåŠ¡å™¨çš„åœ°å€ï¼Œå°±å°è¯•ç›‘å¬ä¸€ä¸‹è¿™å‡ ä¸ªç«¯å£å§ï¼Œçœ‹çœ‹æœ‰äº›ä»€ä¹ˆæ•°æ®å‘é€åˆ°æœåŠ¡å™¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨ Wireshark ç›‘å¬å½“å‰ç½‘ç»œï¼Œè¿‡æ»¤æ¡ä»¶è®¾ç½®ä¸º&lt;/p&gt;
&lt;p&gt;&lt;code&gt;tcp.port==8046||tcp.port==8044||tcp.port==8071||tcp.port==8068||
tcp.port==8058||tcp.port==8059||tcp.port==8054||tcp.port==8045||tcp.port==8061&amp;amp;&amp;amp;tcp.flags.push==1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å°±æ˜¯è¿‡æ»¤ç›‘å¬ç›¸åº”çš„å‡ ä¸ªç«¯å£ï¼Œç„¶åæˆ‘ä»¬å°±èƒ½çœ‹åˆ°æœ¬åœ°å’ŒæœåŠ¡å™¨é€šä¿¡çš„æ•°æ®åŒ…å•¦ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸ªå°æ’æ›²ï¼Œä¸Šé¢è¿™æ®µè¿‡æ»¤æ¡ä»¶å¾ˆé•¿å˜›ï¼Œæˆ‘æ¯æ¬¡è°ƒè¯•çš„æ—¶å€™å®ƒéƒ½ä¼šå˜ï¼Œå°±å¾—é‡æ–°æ‹¼æ¥è¿™ä¹ˆé•¿ä¸ªå­—ç¬¦ä¸²ã€‚æˆ‘å®åœ¨å¿ä¸äº†äº†ï¼Œå°±å†™äº†ä¸ª &lt;a href="/extra/port_filter.py"&gt;Python å°è„šæœ¬&lt;/a&gt;ï¼ˆå¯ä»¥å³é”®å¦å­˜ï¼‰ï¼Œè‡ªåŠ¨ç”Ÿæˆè¿‡æ»¤å­—ç¬¦ä¸²ï¼ç”¨æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯åŠ¨è„šæœ¬ï¼Œè¾“å…¥ä»ç›´æ’­æˆ¿é—´ HTML ä¸Šå¤åˆ¶ä¸‹æ¥çš„æºä»£ç &lt;/li&gt;
&lt;li&gt;å¤åˆ¶å‡ºç”Ÿæˆçš„è¿‡æ»¤æ¡ä»¶å­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;ç²˜è´´åˆ° Wireshark é‡Œå°±OKå•¦ï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨ï¼šä¸ç”¨åˆ»æ„å»å¤åˆ¶å¯¹ç§°çš„å¼•å·/æ‹¬å·ç­‰ç­‰ï¼Œåªè¦åŒ…å«æ•´ä¸ª &lt;code&gt;server_config&lt;/code&gt; å­—æ®µå°±å¥½äº†ï¼Œå¦‚å›¾&lt;/p&gt;
&lt;p&gt;æ•ˆæœå›¾ Hereï½&lt;/p&gt;
&lt;p&gt;&lt;img alt="prot_filter.pyæ•ˆæœå›¾" src="/images/douyu-crawler-port-filter.png" /&gt;&lt;/p&gt;
&lt;p&gt;å¥½äº†ï¼Œå…ˆçœ‹ç¬¬ä¸€ä¸ªåŒ…ï¼Œé•¿å¾—å°±æ˜¯ä¸‹é¢è¿™æ ·äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç™»å½•æœåŠ¡å™¨æŠ“åŒ…" src="/images/douyu-crawler-1.png" /&gt;&lt;/p&gt;
&lt;p&gt;å‰é¢æ˜¯tcpä¸‰æ¬¡æ¡æ‰‹çš„æ•°æ®åŒ…ï¼Œå°±ä¸è¯¦å†™äº†ã€‚ä»è“è‰²æ¡†æ¡†ä½ç½®å¼€å§‹ï¼Œæ˜¯æ­£æ–‡å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;æ­£æ–‡åŒ…å«äº”ä¸ªéƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ•°æ®é•¿åº¦ï¼Œå¤§å°ä¸ºåå››éƒ¨åˆ†çš„å­—èŠ‚é•¿åº¦ï¼Œå 4ä¸ªå­—èŠ‚&lt;/li&gt;
&lt;li&gt;å†…å®¹å’Œç¬¬ä¸€éƒ¨åˆ†ä¸€æ ·ï¼Œ4å­—èŠ‚&lt;/li&gt;
&lt;li&gt;æ–—é±¼å›ºå®šçš„è¯·æ±‚ç ï¼Œæœ¬åœ°-&amp;gt;æœåŠ¡å™¨æ˜¯ &lt;code&gt;0xb1,0x02,0x00,0x00&lt;/code&gt;ï¼ŒæœåŠ¡å™¨-&amp;gt;æœ¬åœ°æ˜¯ &lt;code&gt;0xb2,0x02,0x00,0x00&lt;/code&gt;ï¼Œ4å­—èŠ‚&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯å†…å®¹&lt;/li&gt;
&lt;li&gt;å°¾éƒ¨ä¸€ä¸ªç©ºå­—èŠ‚ &lt;code&gt;0x00&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¶ˆæ¯å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;type@=loginreq/ # è¯·æ±‚ç±»å‹
username@=/ # ç”¨æˆ·åï¼ŒåŒ¿åä¸ºç©º
ct@=0/ # æœªçŸ¥ï¼Œè®¾ä¸º0å³å¯
password@=/ # å¯†ç 
roomid@=16101/ # ç›´æ’­æˆ¿é—´id
devid@=1C01371705D8B13361396AE2FAD50D6F/ # è®¾å¤‡id 32ä½å¤§å†™16è¿›åˆ¶
rt@=1452508198/ # è¯·æ±‚æ—¶é—´æˆ³ ç§’
vk@=2dcf0e6f1d16e45932a343bb71d5d0ad/ # æŸä¸€ç§key 32ä½
ver@=20150929/. # ç‰ˆæœ¬å·
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åï¼Œçœ‹æœåŠ¡å™¨è¿”å›äº†ä»€ä¹ˆä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç™»å½•æœåŠ¡å™¨è¿”å›æ•°æ®" src="/images/douyu-crawler-2.png" /&gt;&lt;/p&gt;
&lt;p&gt;è¿™å¼ å›¾ç‰‡å°±è¯å®äº†ï¼Œå‰é¢è¯´çš„æ–—é±¼å›ºå®šçš„è¯·æ±‚ç ï¼ŒæœåŠ¡å™¨è¿”å›çš„æ˜¯ &lt;code&gt;0xb2,0x02,0x00,0x00&lt;/code&gt; å››ä¸ªå­—èŠ‚ã€‚ç„¶åè¿”å›äº†åŒ¿åç”¨æˆ·çš„ç”¨æˆ·åï¼ŒåŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ç´§æ¥ç€ï¼ŒæœåŠ¡å™¨åˆè¿”å›äº†ä¸€æ¡æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç™»å½•æœåŠ¡å™¨è¿”å›æ•°æ®2" src="/images/douyu-crawler-3.png" /&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ¡åŒ…å¤§æ¦‚æ˜¯å¤šæ¡è¿”å›æ•°æ®åˆå¹¶åˆ°ä¸€èµ·äº†ï¼Œæ²¡å…³ç³»ï¼Œä¸€ä¸ªä¸€ä¸ªæ¥çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯ç±»å‹ä¸º &lt;code&gt;msgrepeaterlist&lt;/code&gt;, é‡Œé¢åŒ…å«äº†ä¸€ç»„å¯ç”¨çš„å¼¹å¹•æœåŠ¡å™¨åœ°å€ï¼Œæ•°æ®çœ‹èµ·æ¥åŒ…å«äº†ä¸€å †@ç¬¦å·ï¼Œæ˜¯å› ä¸ºç”¨äº†jsä»£ç è¿›è¡Œç¼–ç ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ç”¨ Chrome æ‰¾åˆ°äº†ç›¸åº”çš„jsæ–‡ä»¶ï¼Œç„¶åæŠŠä»£ç è½¬åŒ–ä¸º Java ä»£ç ï¼Œå¤§æ¦‚å°±é•¿ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;deFilterStr&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;trim&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;@A&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;@&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;@S&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;

  &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;filterStr&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;trim&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;@&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;@A&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;@S&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è§£ç å‡ºæ¥ï¼Œé€šè¿‡ &lt;code&gt;/&lt;/code&gt; å­—ç¬¦å¯ä»¥æŠŠå­—ç¬¦ä¸²åˆ†å‰²æˆå¤šä¸ªä»¥ &lt;code&gt;@=&lt;/code&gt; è¿æ¥çš„é”®å€¼å¯¹ã€‚å…¶å®è¿™ä¸ªæ“ä½œä¹Ÿå¯ä»¥ç”¨æ­£åˆ™æ¥å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·å°±èƒ½å¾—åˆ°å¼¹å¹•æœåŠ¡å™¨çš„åœ°å€äº†ï¼Œæ€»å…±å°±å››ä¸ªï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;danmu.douyutv.com:8061
danmu.douyutv.com:8062
danmu.douyutv.com:12601
danmu.douyutv.com:12602
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åé¢ä¸€æ¡æ¶ˆæ¯ï¼Œç±»å‹ä¸º &lt;code&gt;setmsggroup&lt;/code&gt;ï¼Œ é‡Œé¢åŒ…å«äº†æˆ¿é—´ç¼–å·å³ &lt;code&gt;rid&lt;/code&gt; å’Œå¼¹å¹•ç¾¤ç»„ç¼–å·å³ &lt;code&gt;gid&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä½™çš„æ¶ˆæ¯ï¼Œæš‚æ—¶æ²¡å‘ç°æœ‰ä»€ä¹ˆç”¨é€”ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ¥ç›‘å¬ä¸‹å¼¹å¹•æœåŠ¡å™¨çš„ç«¯å£ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆæ•°æ®ã€‚
è®¾ç½®ä¸‹è¿‡æ»¤æ¡ä»¶ï¼š &lt;code&gt;tcp.port==8061||tcp.port==8062||tcp.port==12601||tcp.port==12602&amp;amp;&amp;amp;tcp.flags.push==1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸€æ¥å°±å‘ç°äº†è¦æ‰¾çš„æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="å¼¹å¹•æœåŠ¡å™¨è¯·æ±‚æ•°æ®" src="/images/douyu-crawler-4.png" /&gt;&lt;/p&gt;
&lt;p&gt;å‘å¼¹å¹•æœåŠ¡å™¨å‘é€äº†ä¸€æ¡ç±»å‹ä¸º &lt;code&gt;loginreq&lt;/code&gt; çš„æ¶ˆæ¯ï¼Œæ¶ˆæ¯æ ¼å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;type@=loginreq/
username@=visitor503535/
password@=1234567890123456/
roomid@=16101/.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªåŒ…çš„æ ¼å¼æ¯”è¾ƒç®€å•ï¼ŒåŒ¿åç™»é™†çš„è¯ï¼Œç”¨æˆ·åå’Œå¯†ç éšæ„å°±å¥½ï¼Œ&lt;code&gt;roomid&lt;/code&gt; å°±æ˜¯ç›®æ ‡æˆ¿é—´çš„idã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼ŒæœåŠ¡å™¨å¯¹åº”è¿”å›äº†ä¸€æ¡æ²¡æœ‰ä»·å€¼çš„æ¶ˆæ¯ï¼Œå¿½ç•¥æ‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæœ¬åœ°åˆå‘é€äº†ä¸€æ¡è¯·æ±‚åŠ å…¥å¼¹å¹•ç¾¤ç»„çš„æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="å¼¹å¹•æœåŠ¡å™¨è¯·æ±‚æ•°æ®2" src="/images/douyu-crawler-5.png" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;type@=joingroup/
rid@=16101/
gid@=27/.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ï¼Œ&lt;code&gt;rid&lt;/code&gt; å°±æ˜¯æˆ¿é—´idï¼Œ&lt;code&gt;gid&lt;/code&gt; æ˜¯å‰é¢ä»æœåŠ¡å™¨æ‹¿åˆ°çš„å¼¹å¹•ç¾¤ç»„ç¼–å·ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸¤æ¡æ¶ˆæ¯å‘é€å®Œä¹‹åï¼Œå°±æ˜¯ç™»é™†æˆåŠŸäº†ã€‚æœåŠ¡å™¨ä¸æ–­å‘æœ¬åœ°å‘é€å¼¹å¹•æ•°æ®ï¼Œä»¥åŠé±¼ä¸¸ç¤¼ç‰©ä¿¡æ¯ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¿™é‡Œåªç®€å•åœ°è§£æä¸‹å¼¹å¹•çš„æ•°æ®åŒ…ï¼Œå¯¹äºå…¶ä»–æ•°æ®åŒ…æ–¹æ³•ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="å¼¹å¹•æœåŠ¡å™¨è¿”å›æ•°æ®" src="/images/douyu-crawler-6.png" /&gt;&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯ç±»å‹ä¸º &lt;code&gt;chatmessage&lt;/code&gt; , å…¶ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;senderå¤§æ¦‚å’Œç”¨æˆ·idç±»ä¼¼&lt;/li&gt;
&lt;li&gt;contentä¸ºå¼¹å¹•å†…å®¹ï¼Œç”±äºæ˜¯é ASCII å­—ç¬¦ï¼Œåœ¨ Wireshark é‡Œæ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥&lt;/li&gt;
&lt;li&gt;snickä¸ºç”¨æˆ·æ˜µç§°&lt;/li&gt;
&lt;li&gt;chatmsgidä¸ºå¼¹å¹•å”¯ä¸€id&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯ä»¥ç›´æ¥ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œæ ¹æ®&lt;a href="http://baike.baidu.com/view/1491229.htm"&gt;å¿ƒè·³åŒ…æœºåˆ¶&lt;/a&gt;ï¼Œæˆ‘ä»¬è¦ä¸æ–­å‘æœåŠ¡å™¨å‘é€å¿ƒè·³åŒ…ï¼Œä»¥ä¿æŒè¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡æŠ“åŒ…èƒ½çœ‹åˆ°å¿ƒè·³åŒ…çš„æ ·å­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="å¿ƒè·³åŒ…æ•°æ®" src="/images/douyu-crawler-7.png" /&gt;&lt;/p&gt;
&lt;p&gt;ä¸€æ¡ç±»å‹ä¸º &lt;code&gt;mrkl&lt;/code&gt;(mark keep live ?) çš„æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;è‡³æ­¤ï¼ŒæŠ“åŒ…åˆ†æåŸºæœ¬ä¸Šå°±æå®šäº†ï¼Œæ¯ä¸€ä¸ªåŒ…çš„æ ¼å¼ä¹Ÿææ˜ç™½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ¨¡æ‹Ÿå‘é€ç›¸åŒçš„åŒ…ï¼Œå»è¯·æ±‚æœåŠ¡å™¨äº†ã€‚&lt;/p&gt;
&lt;h2&gt;0x03 æ¨¡æ‹Ÿè¯·æ±‚&lt;/h2&gt;
&lt;p&gt;æ ¹æ®å‰é¢æŠ“åŒ…åˆ†æçš„ç»“æœï¼Œæ¨¡æ‹Ÿè¿‡ç¨‹å¤§æ¦‚æ˜¯è¿™æ ·å­çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è·å–ç›´æ’­æˆ¿é—´ HTML é¡µé¢ï¼Œæå–å‡ºæœåŠ¡å™¨åœ°å€å’Œæˆ¿é—´IDå·&lt;/li&gt;
&lt;li&gt;é€‰æ‹©ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå‘é€ç™»é™†æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„å¼¹å¹•ç¾¤ç»„ç¼–å· &lt;code&gt;gid&lt;/code&gt; å’Œå¼¹å¹•æœåŠ¡å™¨åœ°å€&lt;/li&gt;
&lt;li&gt;é€‰æ‹©ä¸€ä¸ªå¼¹å¹•æœåŠ¡å™¨ï¼Œå‘é€ç™»é™†è¯·æ±‚å’ŒåŠ å…¥ç¾¤ç»„çš„è¯·æ±‚&lt;/li&gt;
&lt;li&gt;è¯»å–æœåŠ¡å™¨è¿”å›çš„å¼¹å¹•æ•°æ®&lt;/li&gt;
&lt;li&gt;å®šæ—¶å‘é€å¿ƒè·³åŒ…&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™é‡Œä¸»è¦å†™ä¸€ä¸‹ç¬¬ä¸‰æ­¥ï¼Œå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè·å– &lt;code&gt;gid&lt;/code&gt; , æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;type@=loginreq/ # è¯·æ±‚ç±»å‹
username@=/ # ç”¨æˆ·åï¼ŒåŒ¿åä¸ºç©º
ct@=0/ # æœªçŸ¥ï¼Œè®¾ä¸º0å³å¯
password@=/ # å¯†ç 
roomid@=16101/ # ç›´æ’­æˆ¿é—´id
devid@=1C01371705D8B13361396AE2FAD50D6F/ # è®¾å¤‡id 32ä½å¤§å†™16è¿›åˆ¶
rt@=1452508198/ # è¯·æ±‚æ—¶é—´æˆ³ ç§’
vk@=2dcf0e6f1d16e45932a343bb71d5d0ad/ # æŸä¸€ç§key 32ä½
ver@=20150929/. # ç‰ˆæœ¬å·
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯¹åº”çš„ Java è¯·æ±‚ä»£ç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="n"&gt;socket&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Socket&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getHost&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getPort&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;&lt;span class="c1"&gt;//Socketè¿æ¥æœåŠ¡å™¨&lt;/span&gt;

    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;timestamp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;valueOf&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;currentTimeMillis&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//è·å–å½“å‰æ—¶é—´æˆ³&lt;/span&gt;
    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;uuid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;UUID&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;randomUUID&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;-&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;toUpperCase&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;//æ„é€ uuidä½œä¸ºdevidå‚æ•°&lt;/span&gt;
    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;vk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MD5Util&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MD5&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timestamp&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;7oE9nPEG9xXV69phU31FYCLUagKeYtsF&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;uuid&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//vkå‚æ•°&lt;/span&gt;
    &lt;span class="c1"&gt;//å‘é€ç™»é™†è¯·æ±‚&lt;/span&gt;
    &lt;span class="n"&gt;MessageHandler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;send&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;gid&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rid&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;uuid&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timestamp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vk&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
    &lt;span class="c1"&gt;//ç­‰å¾…æ¥æ”¶&lt;/span&gt;
    &lt;span class="n"&gt;MessageHandler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;receive&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loginListener&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;å…¶ä¸­vkå‚æ•°çš„ç®—æ³•ï¼Œ &lt;code&gt;vk = MD5(timestamp + "7oE9nPEG9xXV69phU31FYCLUagKeYtsF" + devid)&lt;/code&gt; ï¼Œ
æˆ‘è¿˜ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œåœ¨ Github ä¸Šçœ‹åˆ°çš„ã€‚&lt;a href="https://github.com/reusu/DouyuAssistant"&gt;reusu/DouyuAssistant - Github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ€ç»ˆåœ¨æ§åˆ¶å°çš„æ•ˆæœï¼Œå°±æ˜¯è¿™æ ·å•¦ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é¡ºä¾¿ä¿å­˜åˆ°æ•°æ®åº“é‡Œï¼Œå¯ä»¥ç§¯ç´¯æ•°æ®ç„¶åè¿›è¡Œåˆ†æã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="æ§åˆ¶å°æ•ˆæœå›¾" src="/images/douyu-crawler-final.png" /&gt;&lt;/p&gt;
&lt;h2&gt;0x04 åè®°&lt;/h2&gt;
&lt;p&gt;è¿™æ¬¡æŠ“å–æ–—é±¼å¼¹å¹•ï¼Œæ¶¨äº†ä¸å°‘å§¿åŠ¿å‘¢ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Wireshark è¿‡æ»¤æ•°æ®åŒ…æŠ€å·§&lt;/li&gt;
&lt;li&gt;ä»æŠ“å– HTTP æ•°æ®åˆ°æŠ“å– TCP æ•°æ®&lt;/li&gt;
&lt;li&gt;Java Socket / IO / Thread coding ï¼ˆè™½ç„¶ä¾ç„¶å¾ˆlowï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;blockquote&gt;
&lt;p&gt;çŸ¥ä¹å›ç­”åœ°å€ï¼š&lt;a href="https://www.zhihu.com/question/29027665/answer/80169234"&gt;å¦‚ä½•è·å–æ–—é±¼ç›´æ’­é—´çš„å¼¹å¹•ä¿¡æ¯ï¼Ÿ - Brucezz çš„å›ç­” - çŸ¥ä¹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Github é¡¹ç›®ä»£ç åœ°å€ï¼š&lt;a href="https://github.com/brucezz/DouyuCrawler"&gt;brucezz/DouyuCrawler&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr /&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://www.zhihu.com/question/29027665/answer/75117632"&gt;å¦‚ä½•è·å–æ–—é±¼ç›´æ’­é—´çš„å¼¹å¹•ä¿¡æ¯ï¼Ÿ - å¤©ç™½æ‰ç—´ çš„å›ç­”&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://ndrlslz.github.io/2015/12/26/%E6%96%97%E9%B1%BC%E5%BC%B9%E5%B9%95%E6%8A%93%E5%8F%96/"&gt;æ–—é±¼å¼¹å¹•æŠ“å– | éœ¹é›³å•ªå•¦ç¨‹åºæ±ª&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/reusu/DouyuAssistant"&gt;reusu/DouyuAssistant - Github&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Mon, 11 Jan 2016 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2016-01-11:articles/2016/01/11/douyu-crawler/</guid><category>Java</category><category>Spider</category></item><item><title>å¼ºå¼•ç”¨ã€å¼±å¼•ç”¨ã€è½¯å¼•ç”¨ã€è™šå¼•ç”¨</title><link>http://brucezz.github.io/articles/2015/11/23/four-kind-of-reference-in-java/</link><description>&lt;p&gt;&lt;strong&gt;ç›®å½•&lt;/strong&gt;&lt;/p&gt;
&lt;!-- MarkdownTOC --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="#1å¼ºå¼•ç”¨ï¼ˆstrongreferenceï¼‰"&gt;1.å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#2è½¯å¼•ç”¨ï¼ˆsoftreferenceï¼‰"&gt;2.è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#3å¼±å¼•ç”¨ï¼ˆweakreferenceï¼‰"&gt;3.å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#4è™šå¼•ç”¨ï¼ˆphantomreferenceï¼‰"&gt;4.è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /MarkdownTOC --&gt;

&lt;hr /&gt;
&lt;p&gt;æœ€è¿‘å¬å°ä¼™ä¼´èŠåˆ°å¼±å¼•ç”¨ã€è½¯å¼•ç”¨ï¼ŒåŸæ¥åªæ˜¯å¬è¯´è¿‡ï¼Œä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œç‰¹æ­¤æŸ¥é˜…äº†ä¸€äº›èµ„æ–™ï¼Œå­¦ä¹ ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä»JDK1.2ç‰ˆæœ¬å¼€å§‹ï¼ŒæŠŠå¯¹è±¡çš„å¼•ç”¨åˆ†ä¸ºå››ç§çº§åˆ«ï¼Œè¿™å››ç§çº§åˆ«ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š&lt;strong&gt;å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name="1å¼ºå¼•ç”¨ï¼ˆstrongreferenceï¼‰"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;1.å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰&lt;/h2&gt;
&lt;p&gt;å¼ºå¼•ç”¨æ˜¯æœ€å¸¸ç”¨çš„å¼•ç”¨æ–¹å¼ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶å™¨ç»ä¸ä¼šå›æ”¶å®ƒã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/23.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;StrongReferenceDemo&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;ref&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;StrongReference&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//å¼ºå¼•ç”¨&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;gc&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;runFinalization&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ref&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//å¯¹è±¡å¹¶æ²¡æœ‰è¢«å›æ”¶&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“å†…å­˜ä¸è¶³æ—¶ï¼ŒJavaè™šæ‹Ÿå™¨å®æ„¿è·‘å‡º&lt;code&gt;OutOfMemoryError&lt;/code&gt;é”™è¯¯ï¼Œç»ˆæ­¢ç¨‹åºï¼Œä¹Ÿä¸ä¼šé éšæ„å›æ”¶å¼ºå¼•ç”¨å¯¹è±¡æ¥è§£å†³å†…å­˜ä¸è¶³çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;//å¼ºå¼•ç”¨&lt;/span&gt;
&lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;//æ˜¾å¼ç½®ä¸ºnull&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ˜¾å¼è®¾ç½®ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œæˆ–è€…è¶…å‡ºå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸèŒƒå›´ï¼Œè¯¥å¯¹è±¡ä¸å­˜åœ¨å¼ºå¼•ç”¨ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è¢«å›æ”¶äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a name="2è½¯å¼•ç”¨ï¼ˆsoftreferenceï¼‰"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;2.è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰&lt;/h2&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰è½¯å¼•ç”¨ï¼Œå†…å­˜è¶³å¤Ÿæ—¶ï¼Œgcä¸ä¼šå›æ”¶å®ƒï¼›å†…å­˜ä¸è¶³æ—¶ï¼Œgcå°±ä¼šå›æ”¶è¿™ä¸ªå¯¹è±¡çš„å†…å­˜ã€‚åªè¦åƒåœ¾å›æ”¶å™¨æ²¡æœ‰å›æ”¶å®ƒï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«ç¨‹åºä½¿ç”¨ã€‚&lt;strong&gt;è½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/23.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SoftReferenceDemo&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;ref&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;SoftReference&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//å¼ºå¼•ç”¨&lt;/span&gt;
        &lt;span class="n"&gt;SoftReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;softRef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;SoftReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;(&lt;/span&gt;&lt;span class="n"&gt;ref&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//è½¯å¼•ç”¨&lt;/span&gt;

        &lt;span class="n"&gt;ref&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;//å¼ºå¼•ç”¨ç½®ä¸ºnull,ç”±äºè½¯å¼•ç”¨å­˜åœ¨ï¼Œå¯¹è±¡å¹¶ä¸ä¼šè¢«å›æ”¶ï¼Œç›´åˆ°å†…å­˜ä¸è¶³&lt;/span&gt;

    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨Androidå¼€å‘ä¸­ï¼Œç»å¸¸ä¼šç”¨åˆ°å¤§é‡å›¾ç‰‡ï¼Œå¦‚æœæ¯æ¬¡éƒ½è¯»å–å›¾ç‰‡ï¼Œæ¶‰åŠIOæ“ä½œé€Ÿåº¦æ…¢ã€‚å°†å›¾ç‰‡ç¼“å­˜åˆ°å†…å­˜é‡Œï¼Œéœ€è¦çš„æ—¶å€™ç›´æ¥æ‹¿æ¥ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºå›¾ç‰‡å ç”¨å†…å­˜è¾ƒå¤§ï¼Œç¼“å­˜å›¾ç‰‡å¾ˆå¤šçš„è¯å®¹æ˜“å‘ç”ŸOOMï¼Œå¯ä»¥ç”¨è½¯å¼•ç”¨æ¥é¿å…è¿™ä¸€é—®é¢˜ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/23.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ImageCacheDemo&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="c1"&gt;//ç”¨HashMapæ¥ä¿å­˜è½¯å¼•ç”¨å¯¹è±¡&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SoftReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Bitmap&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;imageCache&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;addBitmapToCache&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Bitmap&lt;/span&gt; &lt;span class="n"&gt;bitmap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;BitmapFactory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decodeFile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//å¼ºå¼•ç”¨&lt;/span&gt;
        &lt;span class="n"&gt;SoftReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Bitmap&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;softBitmap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;SoftReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Bitmap&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;(&lt;/span&gt;&lt;span class="n"&gt;bitmap&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//è½¯å¼•ç”¨&lt;/span&gt;

        &lt;span class="n"&gt;imageCache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;softBitmap&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//æ·»åŠ åˆ°mapé‡Œç¼“å­˜&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Bitmap&lt;/span&gt; &lt;span class="nf"&gt;getBitmapByPath&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;//ä»mapç¼“å­˜ä¸­å–å‡ºè½¯å¼•ç”¨å¯¹è±¡&lt;/span&gt;
        &lt;span class="n"&gt;SoftReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Bitmap&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;softBitmap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;imageCache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="c1"&gt;//åˆ¤æ–­æ˜¯å¦å­˜åœ¨è½¯å¼•ç”¨&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;softBitmap&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="c1"&gt;//è‹¥å†…å­˜ä¸è¶³Bitmapè¢«å›æ”¶ï¼Œä¼šå–å¾—null&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;softBitmap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨äº†è½¯å¼•ç”¨ï¼Œåœ¨OOMå‘ç”Ÿä¹‹å‰ï¼Œè¿™äº›ç¼“å­˜çš„å›¾ç‰‡èµ„æºå ç”¨çš„å†…å­˜ä¼šè¢«é‡Šæ”¾æ‰ï¼Œé¿å…Crashã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„åœ°æ–¹:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨gcä¹‹å‰ï¼Œ&lt;code&gt;SoftReference&lt;/code&gt;ç±»çš„&lt;code&gt;get()&lt;/code&gt;æ–¹æ³•ä¼šè¿”å›å¯¹è±¡çš„å¼ºå¼•ç”¨ï¼Œä¸€æ—¦gcå›æ”¶è¯¥å¯¹è±¡ä¹‹åï¼Œ&lt;code&gt;get()&lt;/code&gt;æ–¹æ³•ä¼šè¿”å›&lt;code&gt;null&lt;/code&gt;ã€‚æ‰€ä»¥ï¼Œåœ¨è·å–è½¯å¼•ç”¨å¯¹è±¡çš„æ—¶å€™ï¼Œè¦åˆ¤æ–­æ˜¯å¦ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œé˜²æ­¢&lt;code&gt;NullPointerException&lt;/code&gt;å¼‚å¸¸å¯¼è‡´åº”ç”¨æŒ‚æ‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a name="3å¼±å¼•ç”¨ï¼ˆweakreferenceï¼‰"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;3.å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰&lt;/h2&gt;
&lt;p&gt;åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œ&lt;strong&gt;ä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç›¸æ¯”äºè½¯å¼•ç”¨ï¼Œåªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œå› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/23.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;WeakReferenceDemo&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;ref&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;WeakReference&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//å¼ºå¼•ç”¨&lt;/span&gt;
        &lt;span class="n"&gt;WeakReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;weakRef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;WeakReference&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;(&lt;/span&gt;&lt;span class="n"&gt;ref&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//å¼±å¼•ç”¨&lt;/span&gt;
        &lt;span class="n"&gt;ref&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weakRef&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;&lt;span class="c1"&gt;//WeakReference&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;gc&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="c1"&gt;//å¼ºåˆ¶gc&lt;/span&gt;
        &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weakRef&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;&lt;span class="c1"&gt;//null&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¾“å‡ºç»“æœï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;WeakReference
null
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;a name="4è™šå¼•ç”¨ï¼ˆphantomreferenceï¼‰"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;4.è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰&lt;/h2&gt;
&lt;p&gt;â€œè™šå¼•ç”¨â€é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å½¢åŒè™šè®¾ï¼Œä¸å…¶ä»–å‡ ç§å¼•ç”¨éƒ½ä¸åŒï¼Œè™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ´»åŠ¨ã€‚è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„ä¸€ä¸ªåŒºåˆ«åœ¨äºï¼šè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ— ï¼ˆ&lt;code&gt;ReferenceQueue&lt;/code&gt;ï¼‰è”åˆä½¿ç”¨ã€‚å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹ å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Mon, 23 Nov 2015 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2015-11-23:articles/2015/11/23/four-kind-of-reference-in-java/</guid><category>Java</category><category>Reference</category></item><item><title>å¸¸ç”¨æ’åºç®—æ³•æ•´ç†</title><link>http://brucezz.github.io/articles/2015/11/03/algorithms-of-sort/</link><description>&lt;p&gt;&lt;strong&gt;ç›®å½•&lt;/strong&gt;&lt;/p&gt;
&lt;!-- MarkdownTOC --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="#å†’æ³¡æ’åºç¨³å®š"&gt;å†’æ³¡æ’åº(ç¨³å®š)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#é€‰æ‹©æ’åº"&gt;é€‰æ‹©æ’åº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#æ’å…¥æ’åºç¨³å®š"&gt;æ’å…¥æ’åº(ç¨³å®š)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#å¿«é€Ÿæ’åº"&gt;å¿«é€Ÿæ’åº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#å½’å¹¶æ’åºç¨³å®š"&gt;å½’å¹¶æ’åº(ç¨³å®š)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#å †æ’åº"&gt;å †æ’åº&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /MarkdownTOC --&gt;

&lt;hr /&gt;
&lt;p&gt;æœ€è¿‘åˆå¤ä¹ äº†ä¸€ä¸‹ç®—æ³•çš„å†…å®¹ï¼Œå›é¡¾äº†æ’åºç®—æ³•ï¼Œäº‰å–å¾’æ‰‹èƒ½æ’¸å‡ºæ¥ï¼Œé¡ºå¸¦å†™åˆ°åšå®¢é‡Œï¼Œæ–¹ä¾¿æŸ¥é˜…ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸è§æ’åºç®—æ³•ï¼šå†’æ³¡æ’åºï¼Œé€‰æ‹©æ’åºï¼Œæ’å…¥æ’åºï¼Œå¿«é€Ÿæ’åºï¼Œå½’å¹¶æ’åºï¼Œå †æ’åºã€‚&lt;/p&gt;
&lt;p&gt;æ•°æ®å¯è§†åŒ–ï¼š&lt;a href="http://www.sorting-algorithms.com/"&gt;http://www.sorting-algorithms.com/&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a name="å†’æ³¡æ’åºç¨³å®š"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;å†’æ³¡æ’åº(ç¨³å®š)&lt;/h1&gt;
&lt;h3&gt;åŸºæœ¬æ€æƒ³&lt;/h3&gt;
&lt;p&gt;ä¾æ¬¡æ¯”è¾ƒç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œå°†å°æ•°æ”¾åœ¨å‰é¢ï¼Œå¤§æ•°æ”¾åœ¨åé¢ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºåœ¨æ’åºè¿‡ç¨‹ä¸­æ€»æ˜¯å°æ•°å¾€å‰æ”¾ï¼Œå¤§æ•°å¾€åæ”¾ï¼Œç›¸å½“äºæ°”æ³¡å¾€ä¸Šå‡ï¼Œæ‰€ä»¥ç§°ä½œå†’æ³¡æ’åºã€‚ä¸»è¦é€šè¿‡ä¸¤å±‚å¾ªç¯æ¥å®ç°ã€‚&lt;/p&gt;
&lt;h3&gt;åŠ¨æ€å›¾&lt;/h3&gt;
&lt;p&gt;&lt;img alt="é€‰æ‹©æ’åº" src="/images/bubble-sort.gif" /&gt;&lt;/p&gt;
&lt;h3&gt;å®ç°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/03.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Bubble&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="n"&gt;swaped&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;--)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
                    &lt;span class="n"&gt;swaped&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
                &lt;span class="o"&gt;}&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(!&lt;/span&gt;&lt;span class="n"&gt;swaped&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æ€§èƒ½&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç©ºé—´å¤æ‚åº¦O(1)&lt;/li&gt;
&lt;li&gt;æ—¶é—´å¤æ‚åº¦O(N^2)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a name="é€‰æ‹©æ’åº"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;é€‰æ‹©æ’åº&lt;/h1&gt;
&lt;h3&gt;åŸºæœ¬æ€æƒ³ï¼š&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æ‰¾åˆ°æ•°ç»„é‡Œæœ€å°çš„å…ƒç´ &lt;/li&gt;
&lt;li&gt;è®©å®ƒå’Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ äº¤æ¢&lt;/li&gt;
&lt;li&gt;åœ¨å‰©ä¸‹å…ƒç´ ä¸­æ‰¾åˆ°æœ€å°å€¼ï¼Œä¸æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ äº¤æ¢&lt;/li&gt;
&lt;li&gt;å¦‚æ­¤å¾€å¤ï¼Œç›´åˆ°å°†æ•´ä¸ªæ•°ç»„æ’åº&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡ä¸æ–­åœ°é€‰æ‹©å‰©ä½™å…ƒç´ ä¹‹ä¸­çš„æœ€å°å€¼æ¥æ’åºã€‚&lt;/p&gt;
&lt;h3&gt;åŠ¨æ€å›¾&lt;/h3&gt;
&lt;p&gt;&lt;img alt="é€‰æ‹©æ’åº" src="/images/selection-sort.gif" /&gt;&lt;/p&gt;
&lt;h3&gt;å®ç°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/03.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Selection&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;//äº¤æ¢ç¬¬iå’Œjä¸ªå…ƒç´ çš„å€¼&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æ€§èƒ½&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ—¶é—´å¤æ‚åº¦O(N^2)ï¼Œç©ºé—´å¤æ‚åº¦O(1)&lt;/li&gt;
&lt;li&gt;è¿è¡Œæ—¶é—´å’Œè¾“å…¥æ— å…³ï¼Œæ— è®ºè¾“å…¥å…ƒç´ æ’åºæ€æ ·ï¼Œæ¯”è¾ƒå’Œäº¤æ¢æ¬¡æ•°éƒ½ä¸å˜&lt;/li&gt;
&lt;li&gt;æ•°æ®ç§»åŠ¨æœ€å°‘ï¼Œäº¤æ¢æ¬¡æ•°ä»…ä¸æ•°æ®è§„æ¨¡Nå‘ˆçº¿æ€§å…³ç³»&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a name="æ’å…¥æ’åºç¨³å®š"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;æ’å…¥æ’åº(ç¨³å®š)&lt;/h1&gt;
&lt;h3&gt;åŸºæœ¬æ€æƒ³ï¼š&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å½“å‰ç´¢å¼•éå†æ•°ç»„&lt;/li&gt;
&lt;li&gt;å½“å‰ç´¢å¼•å·¦è¾¹ä¸ºæœ‰åºæ•°ç»„&lt;/li&gt;
&lt;li&gt;å°†ç´¢å¼•ä½ç½®æ‰€åœ¨çš„å…ƒç´ æ’å…¥åˆ°å·¦è¾¹æœ‰åºæ•°ç»„ä¸­&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;åŠ¨æ€å›¾&lt;/h3&gt;
&lt;p&gt;&lt;img alt="é€‰æ‹©æ’åº" src="/images/insertion-sort.gif" /&gt;&lt;/p&gt;
&lt;h3&gt;å®ç°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/03.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Insertion&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="c1"&gt;//å°†å¤§äºa[i]çš„å€¼éƒ½åç§»&lt;/span&gt;
                &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
                &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;--;&lt;/span&gt;
            &lt;span class="o"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;//æ’å…¥&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æ€§èƒ½&lt;/h3&gt;
&lt;p&gt;æ’å…¥æ’åºå¯¹äºéƒ¨åˆ†æœ‰åºçš„æ•°ç»„ååˆ†é«˜æ•ˆï¼Œä¹Ÿå¾ˆé€‚åˆå°è§„æ¨¡æ•°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;æ’åºæ•ˆç‡å—è¾“å…¥å…ƒç´ åˆå§‹é¡ºåºå½±å“å¾ˆå¤§ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a name="å¿«é€Ÿæ’åº"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;å¿«é€Ÿæ’åº&lt;/h1&gt;
&lt;h3&gt;åŸºæœ¬æ€æƒ³ï¼š&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆå¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œæ´—ç‰Œ&lt;/li&gt;
&lt;li&gt;ä»¥æ•°æ®a[j]ä¸ºä¸­å¿ƒè¿›è¡Œåˆ†åŒºï¼Œä½¿å¾—a[j]å·¦ä¾§çš„æ•°æ®éƒ½å°äºç­‰äºa[j]ï¼Œa[j]å³ä¾§çš„æ•°æ®éƒ½å¤§äºç­‰äºa[j]&lt;/li&gt;
&lt;li&gt;åˆ†åŒºå®Œåé€’å½’æ’åº&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;åŠ¨æ€å›¾&lt;/h3&gt;
&lt;p&gt;&lt;img alt="é€‰æ‹©æ’åº" src="/images/quick-sort.gif" /&gt;&lt;/p&gt;
&lt;h3&gt;å®ç°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/03.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Quick&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;//ä¸ºäº†ä¿éšœå¿«é€Ÿæ’åºçš„æ€§èƒ½, åœ¨æ’åºä¹‹å‰è¿›è¡Œæ‰“ä¹±æ“ä½œ&lt;/span&gt;
        &lt;span class="c1"&gt;//å¦å¤–ä¸€ç§æ–¹æ³•æ˜¯åœ¨partition()æ–¹æ³•ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªåˆ‡åˆ†å…ƒç´ &lt;/span&gt;
        &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hi&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="c1"&gt;//åˆ‡åˆ†&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;partition&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;

        &lt;span class="c1"&gt;//å·¦å­æ•°ç»„æ’åº&lt;/span&gt;
        &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="c1"&gt;//å³å­æ•°ç»„æ’åº&lt;/span&gt;
        &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;partition&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="c1"&gt;//é€‰å–ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºåˆ‡åˆ†å…ƒç´ ï¼Œa[lo]&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;//ä»å·¦æ‰«æå‡ºç¬¬ä¸€ä¸ªå¤§äºa[lo]çš„å…ƒç´ &lt;/span&gt;
            &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[++&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="c1"&gt;//ä»å³æ‰«æå‡ºç¬¬ä¸€ä¸ªå°äºa[lo]çš„å…ƒç´ &lt;/span&gt;
            &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[--&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

            &lt;span class="c1"&gt;//ä¸Šè¿°å…ƒç´ ä¸å­˜åœ¨&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="c1"&gt;//å°†è¾ƒå°å…ƒç´ ç§»è‡³a[lo]å·¦è¾¹,è¾ƒå¤§å…ƒç´ ç§»è‡³å³è¾¹&lt;/span&gt;
            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;

        &lt;span class="c1"&gt;//å°†a[lo]ç§»è‡³ä¸­é—´&lt;/span&gt;
        &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Random&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Random&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;nextInt&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æ€§èƒ½&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åˆ‡åˆ†æ–¹æ³•çš„å†…å¾ªç¯å¾ˆç®€æ´ï¼Œé€Ÿåº¦å¿«&lt;/li&gt;
&lt;li&gt;æ¯”è¾ƒæ¬¡æ•°å¾ˆå°‘&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a name="å½’å¹¶æ’åºç¨³å®š"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;å½’å¹¶æ’åº(ç¨³å®š)&lt;/h1&gt;
&lt;h3&gt;åŸºæœ¬æ€æƒ³ï¼š&lt;/h3&gt;
&lt;p&gt;è¦å°†ä¸€ä¸ªæ•°ç»„æ’åºï¼Œå¯ä»¥å…ˆï¼ˆé€’å½’åœ°ï¼‰å°†å®ƒåˆ†æˆä¸¤åŠè¿›è¡Œæ’åºï¼Œç„¶åå°†ç»“æœå½’å¹¶èµ·æ¥ã€‚&lt;/p&gt;
&lt;h3&gt;åŠ¨æ€å›¾&lt;/h3&gt;
&lt;p&gt;&lt;img alt="é€‰æ‹©æ’åº" src="/images/merge-sort.gif" /&gt;&lt;/p&gt;
&lt;h3&gt;å®ç°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/03.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Merge&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;//è¾…åŠ©æ•°&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;aux&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lo&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lo&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;//å·¦å­æ•°ç»„æ’åº&lt;/span&gt;
        &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//å³å­æ•°ç»„æ’åº&lt;/span&gt;
        &lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//åˆå¹¶èµ·æ¥&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;merge&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;mid&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;//è®¤ä¸ºæ•°ç»„æœ‰åºï¼Œè·³è¿‡merge()&lt;/span&gt;

        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;//å°†æ•°æ®å¤åˆ¶åˆ°è¾…åŠ©æ•°ç»„ä¸­&lt;/span&gt;
            &lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++];&lt;/span&gt;&lt;span class="c1"&gt;//å·¦å­æ•°ç»„å·²åˆå¹¶å®Œ&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++];&lt;/span&gt;&lt;span class="c1"&gt;//å³å­æ•°ç»„å·²åˆå¹¶å®Œ&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++];&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++];&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æ€§èƒ½&lt;/h3&gt;
&lt;p&gt;å½’å¹¶æ’åºæ—¶é—´å¤æ‚åº¦O(NlgN), ç©ºé—´å¤æ‚åº¦O(N)&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a name="å †æ’åº"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;å †æ’åº&lt;/h1&gt;
&lt;h3&gt;åŸºæœ¬æ€æƒ³ï¼š&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æ„é€ äºŒå‰å †&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨å †çš„ç‰¹æ€§(å †é¡¶ä¸ºå…ƒç´ æœ€å¤§å€¼)è·å–åˆ°æœ€å¤§å€¼ï¼Œæ’å…¥åˆ°å°¾éƒ¨&lt;/li&gt;
&lt;li&gt;å°†äº¤æ¢åˆ°å †é¡¶çš„å…ƒç´ ä¸‹æ²‰åˆ°åˆé€‚ä½ç½®ï¼Œåœ¨å‰©ä½™å…ƒç´ ä¸­äº§ç”Ÿæ–°çš„æœ€å¤§é¡¹&lt;/li&gt;
&lt;li&gt;æ’å…¥åˆ°å°¾éƒ¨ï¼Œä¾æ¬¡å¾ªç¯&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;åŠ¨æ€å›¾&lt;/h3&gt;
&lt;p&gt;&lt;img alt="é€‰æ‹©æ’åº" src="/images/heap-sort.gif" /&gt;&lt;/p&gt;
&lt;h3&gt;å®ç°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Created by zero on 2015/11/03.&lt;/span&gt;
&lt;span class="cm"&gt; * SimpleCodeDemo&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Heap&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="c1"&gt;//äºŒå‰å †ï¼šæ¯ä¸ªç»“ç‚¹éƒ½å°äºç­‰äºå®ƒçš„çˆ¶ç»“ç‚¹&lt;/span&gt;
    &lt;span class="c1"&gt;//ç¬¬kä¸ªç»“ç‚¹ï¼Œå·¦å­ç»“ç‚¹ä¸º2kï¼Œå³å­ç»“ç‚¹ä¸º2k+1&lt;/span&gt;

    &lt;span class="c1"&gt;//ç”±äºå †ä¸­ç´¢å¼•ä»1å¼€å§‹ï¼Œè®¿é—®æ•°ç»„æ—¶ç´¢å¼•å€¼ç›¸åº”å‡1&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;--)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;//æ„é€ å †&lt;/span&gt;
            &lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;//ä¿®å¤å †ï¼Œç›´åˆ°å †æœ‰åº&lt;/span&gt;
            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;--);&lt;/span&gt; &lt;span class="c1"&gt;//å°†æœ€å¤§é¡¹(å †é¡¶å…ƒç´ )äº¤æ¢è‡³æœ€åé¢&lt;/span&gt;
            &lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//ä¸‹æ²‰äº¤æ¢è¿‡æ¥çš„å…ƒç´ &lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// ä¸‹æ²‰æ“ä½œ&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;sink&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;//æŒ‡å‘å·¦å­ç»“ç‚¹&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++;&lt;/span&gt;&lt;span class="c1"&gt;//æŒ‡å‘è¾ƒå¤§çš„å­ç»“ç‚¹&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;//çˆ¶ç»“ç‚¹å¤§äºå­ç»“ç‚¹ï¼Œåˆ™è·³è¿‡&lt;/span&gt;

            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="c1"&gt;//çˆ¶ç»“ç‚¹å°äºå­ç»“ç‚¹ï¼Œä¸‹æ²‰ï¼Œäº¤æ¢ä½ç½®&lt;/span&gt;
            &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;swap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æ€§èƒ½&lt;/h3&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦O(NlgN), ç©ºé—´å¤æ‚åº¦O(1)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Tue, 03 Nov 2015 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2015-11-03:articles/2015/11/03/algorithms-of-sort/</guid></item><item><title>å¼€å§‹ç©åšå®¢</title><link>http://brucezz.github.io/articles/2015/10/28/play-with-blog/</link><description>&lt;p&gt;å¯¹äº github.io æ—©å°±æœ‰æ‰€äº†è§£ï¼Œå› ä¸ºæ‡’ï¼Œä¸€ç›´æ²¡æœ‰åŠ¨æ‰‹ã€‚ç»è¿‡å››äº”å¤©æŠ˜è…¾ï¼Œç»ˆäºæŠŠè¿™ä¸ªåšå®¢æ­å»ºçš„å·®ä¸å¤šäº†ã€‚ä»æ­¤å¼€å§‹äº†ä¸ªäººåšå®¢ä¹‹è·¯ã€‚
ä¹‹å‰ä¹Ÿæœ‰å°è¯•è¿‡ CSDN ä»€ä¹ˆçš„çš„ï¼Œç”¨èµ·æ¥æ€»å°‘äº†ä¸€ç§æ„Ÿè§‰ã€‚å°±æ˜¯æŠ˜è…¾çš„æ„Ÿè§‰ã€‚&lt;/p&gt;
&lt;h1&gt;æ­åšå®¢çš„ç›®çš„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;è®°å½•å­¦ä¹  &amp;amp; æ²‰æ·€çŸ¥è¯†&lt;/li&gt;
&lt;li&gt;å¢åŠ é€¼æ ¼&lt;/li&gt;
&lt;li&gt;ç»™è‡ªå·±å¼„ç‚¹å¥½ç©çš„ä¸œè¥¿&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;åšå®¢ç»“æ„&lt;/h1&gt;
&lt;p&gt;åŸºäº &lt;a href="https://pages.github.com/"&gt;Github Pages&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¡†æ¶é‡‡ç”¨çš„ Python å†™çš„ &lt;a href="http://blog.getpelican.com/"&gt;Pelican&lt;/a&gt;ï¼Œä¹Ÿæœ‰çœ‹è¿‡ Ruby å†™çš„ &lt;a href="http://jekyllrb.com/"&gt;Jekyll&lt;/a&gt;ï¼Œä½†æˆ‘æ›´å–œæ¬¢ç© Python ä¸€äº› =.=&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ä¸»é¢˜ç”¨çš„ &lt;a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3"&gt;Pelican-bootstrap3&lt;/a&gt;ï¼Œä¸æ»¡æ„çš„åœ°æ–¹è‡ªå·±æ”¹æ”¹&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨ä¸»é¢˜ç”¨çš„ &lt;a href="https://github.com/gilsondev/pelican-clean-blog"&gt;pelican-clean-blog&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;ä¸å°‘ç»†èŠ‚åœ°æ–¹è¿˜ä¸æ»¡æ„ã€‚æŠ˜è…¾èµ·æ¥ï¼&lt;/p&gt;
&lt;h1&gt;Timeline&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;2015.10 æ­å»ºåšå®¢ Github Pages + Pelican + pelican-bootstrap3&lt;/li&gt;
&lt;li&gt;2015.11 æœ¬åœ°ç”¨ Sublime Text3 + MarkDown Extended + MarkDownTOC æ’ä»¶ å†™mdæ–‡æœ¬&lt;/li&gt;
&lt;li&gt;2016.01 ä¿®æ”¹æœ¬åœ° Python è™šæ‹Ÿç¯å¢ƒï¼Œå¯¼è‡´ Pelican è·‘ä¸èµ·æ¥ â•®(â•¯â–½â•°)â•­ï¼Œé‡æ–°ç”Ÿæˆäº†ä¸€ä¸ª virtualenv&lt;/li&gt;
&lt;li&gt;2016.02 ä¸»é¢˜ä¿®æ”¹ä¸º pelican-clean-blog&lt;/li&gt;
&lt;li&gt;æŠ˜è…¾ä¸­...&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brucezz</dc:creator><pubDate>Wed, 28 Oct 2015 00:00:00 +0800</pubDate><guid>tag:brucezz.github.io,2015-10-28:articles/2015/10/28/play-with-blog/</guid></item></channel></rss>